/**
* @package     Nenkraft
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     0.6.4 (Beta)
* @copyright   (C) 2017-2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft/blob/master/LICENSE}
*/
!function(t){function e(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=31)}([function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,e){t.exports=function(){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var o=this[e];return this[e]=this[t],this[t]=o,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var o=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),o}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}}},function(t,e){t.exports=function(t){"use strict";t.Math.PII=2*Math.PI,t.Math.DEGREES_TO_RADIANS=Math.PI/180,t.Math.RADIANS_TO_DEGREES=180/Math.PI,t.Math.RADIAN=t.Math.DEGREES_TO_RADIANS,t.Math.DegreesToRadians=function(e){return e*t.Math.DEGREES_TO_RADIANS},t.Math.DTR=t.Math.DegreesToRadians,t.Math.RadiansToDegrees=function(e){return e*t.Math.RADIANS_TO_DEGREES},t.Math.RTD=t.Math.RadiansToDegrees,t.Math.PrecisionRound=function(t,e){var o=Math.pow(10,e);return Math.round(o*t)/o},t.Math.PR=t.Math.PrecisionRound,t.Math.Spread=function(t,e,o,r){return t-o*(e-1)*.5+r*o},t.Math.AttractRepel=function(t,e,o,r,n){var i=e.SubtractVC(t);if(i.GetMagnitudeSquared()<r*r){var s=i.GetAngle();o.Add(Math.cos(s)*n,Math.sin(s)*n)}},t.Math.LineLineIntersection=function(t,e,o,r){var n=e.SubtractVC(t),i=r.SubtractVC(o),s=-i.x*n.y+n.x*i.y,a=t.x-o.x,l=t.y-o.y,h=(-n.y*a+n.x*l)/s,p=(i.x*l-i.y*a)/s;return h>=0&&h<=1&&p>=0&&p<=1&&(n.Set(t.x+p*n.x,t.y+p*n.y),n)},t.Math.ClosestPointOnLine=function(t,e,o){var r=e.SubtractVC(t),n=((o.x-t.x)*r.x+(o.y-t.y)*r.y)/r.GetMagnitudeSquared();return n<0?t:n>1?e:(r.Set(t.x+n*r.x,t.y+n*r.y),r)},t.Math.LikeASquareGrid=function(t,e,o,r){for(var n=0,i=t.length,s=e/o|0;n<i;++n)t[n].Set(n%s*o,(n/s|0)*r)},t.Math.SquareGrid=function(t,e,o,r,n){for(var i=[],s=0,a=t/o|0,l=e/r|0,h=a*l;s<h;++s)i.push(new n(s%a*o,(s/a|0)*r));return i},t.Math.TriRectArray=function(t,e,o,r,n){return null!=n?(n[0]=t,n[1]=e,n[2]=t+o,n[3]=e,n[4]=t,n[5]=e+r,n[6]=t,n[7]=e+r,n[8]=t+o,n[9]=e,n[10]=t+o,n[11]=e+r,n):[t,e,t+o,e,t,e+r,t,e+r,t+o,e,t+o,e+r]},Object.defineProperty(t.Math,"PII",{writable:!1}),Object.defineProperty(t.Math,"DEGREES_TO_RADIANS",{writable:!1}),Object.defineProperty(t.Math,"RADIANS_TO_DEGREES",{writable:!1}),Object.defineProperty(t.Math,"RADIAN",{writable:!1})}},function(t,e,o){(function(e){t.exports=function(t){"use strict";function o(t,e,f,y){if(void 0==y||"function"!=typeof t.Assert)switch(e){case o.IS:return void r(t,f,e);case o.IS_NOT:return void n(t,f,e);case o.IS_SAME_TYPE:return void i(t,f,e);case o.IS_NOT_SAME_TYPE:return void s(t,f,e);case o.IS_INSTANCE_OF:return void a(t,f,e);case o.IS_NOT_INSTANCE_OF:return void l(t,f,e);case o.IS_LESS_THAN:return void h(t,f,e);case o.IS_GREATER_THAN:return void p(t,f,e);case o.IS_LESS_THAN_OR_EQUAL:return void u(t,f,e);case o.IS_GREATER_THAN_OR_EQUAL:return void c(t,f,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,f)}function r(t,e,o){var r=!1;t!==e&&(r=!0),f(r,t,e,o)}function n(t,e,o){var r=!1;t===e&&(r=!0),f(r,t,e,o)}function i(t,e,o){var r=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(r=!0):null===t||null===e?t!==e&&(r=!0):typeof t!=typeof e&&(r=!0),f(r,t,e,o)}function s(t,e,o){var r=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(r=!0):null===t||null===e?e===t&&(r=!0):typeof t==typeof e&&(r=!0),f(r,t,e,o)}function a(t,e,o){var r=!1;t instanceof e||(r=!0),f(r,t,e.name,o)}function l(t,e,o){var r=!1;t instanceof e&&(r=!0),f(r,t,e.name,o)}function h(t,e,o){var r=!1;t>=e&&(r=!0),f(r,t,e,o)}function p(t,e,o){var r=!1;t<=e&&(r=!0),f(r,t,e,o)}function u(t,e,o){var r=!1;t>e&&(r=!0),f(r,t,e,o)}function c(t,e,o){var r=!1;t<e&&(r=!0),f(r,t,e,o)}function f(t,e,r,n){if(t)throw y(e,r,n),new Error("Assertion failed: "+n);o.LOG&&window&&d(e,r,n)}function y(t,e,r){switch(r){case o.IS:r=o.IS_NOT;break;case o.IS_NOT:r=o.IS;break;case o.IS_SAME_TYPE:r=o.IS_NOT_SAME_TYPE;break;case o.IS_NOT_SAME_TYPE:r=o.IS_SAME_TYPE;break;case o.IS_INSTANCE_OF:r=o.IS_NOT_INSTANCE_OF;break;case o.IS_NOT_INSTANCE_OF:r=o.IS_INSTANCE_OF;break;case o.IS_LESS_THAN:r=o.IS_GREATER_THAN_OR_EQUAL;break;case o.IS_GREATER_THAN:r=o.IS_LESS_THAN_OR_EQUAL;break;case o.IS_LESS_THAN_OR_EQUAL:r=o.IS_GREATER_THAN;break;case o.IS_GREATER_THAN_OR_EQUAL:r=o.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,r,e)}function d(t,e,o){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(o),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}o.IS="IS",o.IS_NOT="IS NOT",o.IS_SAME_TYPE="IS SAME TYPE",o.IS_NOT_SAME_TYPE="IS NOT SAME TYPE",o.IS_INSTANCE_OF="IS INSTANCE OF",o.IS_NOT_INSTANCE_OF="IS NOT INSTANCE OF",o.IS_LESS_THAN="IS LESS THAN",o.IS_GREATER_THAN="IS GREATER THAN",o.IS_LESS_THAN_OR_EQUAL="IS LESS THAN OR EQUAL",o.IS_GREATER_THAN_OR_EQUAL="IS GREATER THAN OR EQUAL",o.Assign=function(t){if(window&&!t?t=window:e&&t&&(t=e),!t)throw new Error("No global namespace");t.IS=o.IS,t.IS_NOT=o.IS_NOT,t.IS_SAME_TYPE=o.IS_SAME_TYPE,t.IS_NOT_SAME_TYPE=o.IS_NOT_SAME_TYPE,t.IS_INSTANCE_OF=o.IS_INSTANCE_OF,t.IS_NOT_INSTANCE_OF=o.IS_NOT_INSTANCE_OF,t.IS_LESS_THAN=o.IS_LESS_THAN,t.IS_GREATER_THAN=o.IS_GREATER_THAN,t.IS_LESS_THAN_OR_EQUAL=o.IS_LESS_THAN_OR_EQUAL,t.IS_GREATER_THAN_OR_EQUAL=o.IS_GREATER_THAN_OR_EQUAL},o.LOG=!1,t.Utils.Assert=o,t.Assert=o}}).call(e,o(0))},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.class=t,this.objects=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.class=null,e.prototype.objects=null,e.prototype.floodFunction=null,e.prototype.floodAmount=100,e.prototype.context=null,e.prototype.Store=function(t){this.objects.push(t)},e.prototype.Retrieve=function(){return 0===this.objects.length&&this.Flood(),this.objects.pop()},e.prototype.Flood=function(t,e,o){t&&(this.floodFunction=t),e&&(this.floodAmount=e),o&&(this.context=o);for(var r=0;r<this.floodAmount;++r)if(null!=this.class){var n=new this.class;this.Store(n),this.floodFunction.call(this.context,n)}else this.Store(this.floodFunction.call(this.context))},e.prototype.Flush=function(){this.objects.length=0},e.prototype.Clean=function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)},t.Utils.Pool=e,t.Pool=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);null!=t&&(this.type=t),this.items=[]}var o=t.Utils.Assert,r=Object.create(null);e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.type=null,e.prototype.Store=function(t){var e=!1;return null==t?(console.warn("Item is null. Cannot store null item."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Item is not valid. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))},e.prototype.StoreSafe=function(t){return null!=this.type&&o(t,o.IS_INSTANCE_OF,this.type),o(t,o.IS_SAME_TYPE,r),t.id?(o(t.id,o.IS_SAME_TYPE,""),o(t.id,o.IS_NOT,"")):(o(t.data,o.IS_SAME_TYPE,r),o(t.data.id,o.IS_SAME_TYPE,""),o(t.data.id,o.IS_NOT,"")),this.Store(t)},e.prototype.Get=function(t){for(var e=0,o=this.items,r=o.length;e<r;++e)if(o[e]===t)return t;return null},e.prototype.GetById=function(t){for(var e=0,o=this.items,r=o.length,n=o[e];e<r;n=o[++e])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null},e.prototype.PerformOnAll=function(t,e,o){for(var r=0,n=this.items,i=n.length,s=n[r];r<i;s=n[++r])null!=s&&s[t]&&s[t].apply(o||s,e);return null},e.prototype.Contains=function(t,e){for(var o=0,r=this.items,n=r.length,i=r[o];o<n;i=r[++o])if(null!=i){if(i===t)return!0;if(i.id===e)return!0;if(null!=i.data&&i.data.id===e)return!0}return!1},t.Utils.Cache=e}},function(t,e){t.exports=function(t){"use strict";var e=Math.random,o=null,r=null,n=null,i=t.Utils.RandomInteger=function(t,o){return e()*(o-t+1)+t|0};t.Utils.RandomFloat=function(t,o){return e()*(o-t)+t};var s=t.Utils.IsInteger=function(t){return Number(t)===t&&t%1==0};t.Utils.IsFloat=function(t){return Number(t)===t&&t%1!=0},t.Utils.Sign=function(t,e){return 0===t?!0===e?1:0:t>0?1:-1},t.Utils.Clamp=function(t,e,o){return t<e?e:t>o?o:t},t.Utils.InverseClamp=function(t,e,o){return t<e?o:t>o?e:t},t.Utils.ThisOrThat=function(t,e){return 1===i(1,2)?t:e},t.Utils.IntegerNotation=function(t,e,o){var r=t%e,n=t/e;return Math.ceil(0===r?n+1:n)+o+(1+r)},t.Utils.UUID=function(e,o,r,n){e=null==e?32:e,o=null==o?4:o,r=null==r?0:r,n=null==n?"-":n;for(var a,l,h="",p=0,u=e/o|0,c=t.Utils.CharacterSets[r];p<e;++p)a=p/u,0!==a&&s(a)?h+=n:(l=i(1,c.length-1),h+=c.charAt(l));return h},t.Utils.CharacterSets=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"],t.Utils.ApplyProperties=function(t,e){if(void 0!==e){var o;for(o in e)void 0!==t[o]&&(t[o]=e[o])}};var a=t.Utils.Nested=function(t,e,o,r,n,i){"string"==typeof e&&(i=null==i?".":i,e=e.split(i));var s;if(e.length>1){if(s=e.shift(),void 0!==t[s])return a(t[s],e,o,r,n,i)}else{if(s=e.shift(),void 0!==t[s])return!0===r?void(t[s]=n):!0===o?t:t[s];if(!0===r)return void(t[s]=n)}};t.Utils.ArrayGetRandom=function(t,o){for(var r=[],n={},i=t.length,s=0,a=o;s<a;++s){var l=e()*i|0;void 0===n[l]?(n[l]=null,r.push(t[l])):s--}return r},t.Utils.ArrayShuffle=function(t){for(var o,r,n=t.length-1;n>=0;--n)r=e()*n|0,o=t[n],t[n]=t[r],t[r]=o},t.Utils.Cipher={},t.Utils.Decipher={},t.Utils.Cipher.CCH1=function(t,e){var o=[];e=void 0===e?1:e;for(var r,n,s=0,a=t.split(""),l=a.length;s<l;++s)r=a[s],r=(r.charCodeAt(0)+e).toString(2),n=i(1,9),o.push(n+"x"+r.replace(/1/g,n));return o.join(" ")},t.Utils.Decipher.CCH1=function(t,e){var o=[];e=void 0===e?1:e;for(var r,n=0,i=t.split(" "),s=i.length;n<s;++n)r=i[n],r=r.slice(2-r.length),o.push(String.fromCharCode(parseInt(r.replace(/[2-9]/g,"1"),2)-e));return o.join("")},t.Utils.GenerateSimpleBase64Png=function(t){var e=t();return null==o&&(o=document.createElement("canvas"),r=o.getContext("2d")),r.clearRect(0,0,o.width,o.height),o.width=e.w,o.height=e.h,r.setTransform(1,0,0,1,0,0),e.Draw(r),o.toDataURL("image/png")},t.Utils.ImageFromDataURL=function(t,e,o){var r=new Image;return r.src=t,r.width=e,r.height=o,r},t.Utils.Base16ToBase10=function(t){return parseInt(t,16)},t.Utils.Base2ToBase10=function(t){return parseInt(t,2)},t.Utils.IsObjectEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})},t.Utils.ParsedXMLToJSON=function(e,o){var r,n,i,s,a,l,h,p={},u=e.childNodes;if(1===e.nodeType){if(i=e.attributes,(n=i.length)>0)for(p.attributes={},r=0,s=i.item(r);r<n;s=i.item(++r))p.attributes[s.nodeName]=s.nodeValue}else 3===e.nodeType&&(/^\s*$/g.exec(e.nodeValue)||(p=e.nodeValue,!0===o&&(p=p.replace(/^\s+|\s+&|\n/gim,""))));if(null!=u)for(n=u.length,r=0,a=u.item(r);r<n;a=u.item(++r))void 0===p[a.nodeName]?p[a.nodeName]=t.Utils.ParsedXMLToJSON(a,o):(void 0===p[a.nodeName].push&&(h=p[a.nodeName],p[a.nodeName]=[],t.Utils.IsObjectEmpty(h)||p[a.nodeName].push(h)),l=t.Utils.ParsedXMLToJSON(a,o),t.Utils.IsObjectEmpty(l)||p[a.nodeName].push(l));return p["#text"]&&0===p["#text"].length&&delete p["#text"],p},t.Utils.XMLToJSON=function(e,o){return null==n&&(n=new DOMParser),t.Utils.ParsedXMLToJSON(n.parseFromString(e,"text/xml"),o)};var l=t.Utils.DeepClone=function(t){var e=null,o=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(Array.isArray(t))e=[],o=!0;else{if("object"!=typeof obj)return t;e={}}if(o)for(var r=0;r<t.length;++r)e[r]=l(t[r]);else for(var n in t)t.hasOwnProperty(n)&&(e[n]=l(t[n]));return e}}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.value=0,e.prototype.Add=function(t){this.value|=t},e.prototype.Remove=function(t){this.value=this.value&~t},e.prototype.Compare=function(t){return 0!=(this.value&t)},e.prototype.Holds=function(t){return(this.value&t)===t},e.prototype.Toggle=function(t){this.value^=t},t.Utils.FlagList=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.NONE=0,e.prototype.next=1,e.prototype.Add=function(t){t=t.toUpperCase(),void 0===this[t]&&(this[t]=this.next,this.next=this.next<<1)},t.Utils.FlagEnum=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n){if(!(this instanceof e))return new e(t,o,r,n);this.context=o,this.holderContext=t,this.handle=r,this.removeOnNextCall=n}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.Execute=function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()},e.prototype.Remove=function(){this.holderContext.Remove(this.handle,this.context)},t.Event.LocalListener=e,t.LocalListener=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.listeners=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.stopPropagation=!1,e.prototype.target=null,e.prototype.data=null,e.prototype.GetListenerIndex=function(t,e){var o=this.listeners;if(0===o.length)return-1;for(var r,n=0,i=o.length;n<i;++n)if(r=o[n],r.context===e&&r.handle===t)return n;return-1},e.prototype.Add=function(e,o,r){var n=new t.LocalListener(this,o,e,r);this.listeners.push(n)},e.prototype.Remove=function(t,e){var o=this.GetListenerIndex(t,e);-1!==o&&this.listeners.fickleSplice(o)},e.prototype.Dump=function(t){var e=this.listeners;if(0!==e.length)if(void 0!==t)for(var o,r=0,n=e.length;r<n;++r)o=e[r],o.context===t&&this.listeners.fickleSplice(r);else this.listeners.length=0},e.prototype.Dispatch=function(t,e){var o=this.listeners;if(0!==o.length){o=o.slice(),this.stopPropagation=!1,this.target=t,this.data=e;for(var r,n=0,i=o.length;n<i&&(r=o[n],r.Execute(this),!0!==this.stopPropagation);++n);delete this.target,delete this.data}},t.Event.LocalEvent=e,t.LocalEvent=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);null!=o&&(this.stopTime=o),this.onStop=new t.LocalEvent,this.onFinish=new t.LocalEvent,this.onStart=new t.LocalEvent,this.onReset=new t.LocalEvent,this.onPause=new t.LocalEvent,this.onResume=new t.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.time=0,e.prototype.stopTime=0,e.prototype.isRunning=!1,e.prototype.canResume=!1,e.prototype.count=0,e.prototype.Reset=function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1,this.stopTime=null},e.prototype.Start=function(t){this.stopTime=Math.round(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))},e.prototype.Stop=function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))},e.prototype.Pause=function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))},e.prototype.Resume=function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))},e.prototype.Process=function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))},t.Time.Timer=e,t.Timer=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);void 0!=t&&void 0!=t.x&&void 0!=t.y?(this.x=t.x,this.y=t.y):void 0!=t&&(void 0==o?(this.x=t,this.y=t):(this.x=t,this.y=o))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TranslateMultiple=function(t,e){for(var o=0,r=t.length;o<r;++o)t[o].AddV(e)},e.GetMinMaxDot=function(t,e){for(var o=1/0,r=-o,n=0,i=e.Copy(),s=0,a=t.length;s<a;++s)n=t[s].GetDotV(e),n>r&&(r=n),n<o&&(o=n);return i.Set(o,r),i},e.Pool=new t.Utils.Pool(e),e.Pool.Retrieve=function(t,e){0===this.objects.length&&this.Flood();var o=this.objects.pop();return o.Set(t,e),o},e.USE_POOL=!0,e.prototype.x=0,e.prototype.y=0,e.prototype.Copy=function(){return!0===e.USE_POOL?e.Pool.Retrieve(this.x,this.y):new e(this)},e.prototype.FromStore=function(t,o){return!0===e.USE_POOL?e.Pool.Retrieve(t,o):new e(t,o)},e.prototype.AbsoluteCopy=function(){var t=this.Copy();return t.Positive(),t},e.prototype.SetV=function(t){this.x=t.x,this.y=t.y},e.prototype.Set=function(t,e){void 0!=t&&void 0==e?(this.x=t,this.y=t):(this.x=t,this.y=e)},e.prototype.Is0=function(){return 0===this.x&&0===this.y},e.prototype.AddV=function(t){this.x+=t.x,this.y+=t.y},e.prototype.AddVC=function(t){var e=this.Copy();return e.AddV(t),e},e.prototype.Add=function(t,e){this.x+=t,this.y+=e},e.prototype.SubtractV=function(t){this.x-=t.x,this.y-=t.y},e.prototype.SubtractVC=function(t){var e=this.Copy();return e.SubtractV(t),e},e.prototype.Subtract=function(t,e){this.x-=t,this.y-=e},e.prototype.MultiplyV=function(t){this.x*=t.x,this.y*=t.y},e.prototype.MultiplyVC=function(t){var e=this.Copy();return e.MultiplyV(t),e},e.prototype.Multiply=function(t,e){this.x*=t,this.y*=e},e.prototype.DivideV=function(t){this.x/=t.x,this.y/=t.y},e.prototype.DivideVC=function(t){var e=this.Copy();return e.DivideV(t),e},e.prototype.Divide=function(t,e){this.x/=t,this.y/=e},e.prototype.Normalize=function(){var t=this.GetMagnitude();this.Divide(t,t)},e.prototype.Positive=function(){this.x=Math.abs(this.x),this.y=Math.abs(this.y)},e.prototype.Negative=function(){this.x=-Math.abs(this.x),this.y=-Math.abs(this.y)},e.prototype.Invert=function(){this.x=-1*this.x,this.y=-1*this.y},e.prototype.Rotate=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.x,n=this.y;this.x=r*o-n*e,this.y=r*e+n*o},e.prototype.RotateAbsolute=function(t){this.Rotate(t-this.GetAngle())},e.prototype.RotateAroundV=function(t,e){this.SubtractV(t),this.Rotate(e),this.AddV(t)},e.prototype.RotateAround=function(t,e,o){this.Subtract(t,e),this.Rotate(o),this.Add(t,e)},e.prototype.RotateAbsoluteAroundV=function(t,e){this.SubtractV(t),this.RotateAbsolute(e),this.AddV(t)},e.prototype.RotateAbsoluteAround=function(t,e,o){this.Subtract(t,e),this.RotateAbsolute(o),this.Add(t,e)},e.prototype.PushFromV=function(t,e){var o=this.Copy();o.SubtractV(t),o.Normalize(),o.Multiply(e,e),this.AddV(o)},e.prototype.PushFrom=function(t,e,o){var r=this.Copy();r.Subtract(t,e),r.Normalize(),r.Multiply(o,o),this.AddV(r)},e.prototype.GetAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.GetAngleBetweenV=function(t){return Math.atan2(this.y-t.y,this.x-t.x)},e.prototype.GetAngleBetween=function(t,e){return Math.atan2(this.y-e,this.x-t)},e.prototype.GetDotV=function(t){return this.x*t.x+this.y*t.y},e.prototype.GetDot=function(t,e){return this.x*t+this.y*e},e.prototype.GetCrossV=function(t){return this.x*t.y+this.y*t.x},e.prototype.GetCross=function(t,e){return this.x*e+this.y*t},e.prototype.GetMagnitudeSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.GetMagnitude=function(){return Math.sqrt(this.GetMagnitudeSquared())},e.prototype.GetDistanceV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitude()},e.prototype.GetDistance=function(t,e){var o=this.Copy();return o.Subtract(t,e),o.GetMagnitude()},e.prototype.GetDistanceSquaredV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitudeSquared()},e.prototype.GetDistanceSquared=function(t,e){var o=this.Copy();return o.Subtract(t,e),o.GetMagnitudeSquared()},e.prototype.GetPerpendicularCCWV=function(t){return this.FromStore(-(t.y-this.y),t.x-this.x)},e.prototype.GetPerpendicularCCW=function(t,e){return this.FromStore(-(e-this.y),t-this.x)},e.prototype.GetPerpendicularCWV=function(t){return this.FromStore(t.y-this.y,-(t.x-this.x))},e.prototype.GetPerpendicularCW=function(t,e){return this.FromStore(e-this.y,-(t-this.x))},e.prototype.GetNormalAV=function(t){var e=this.GetPerpendicularCCWV(t);return e.Normalize(),e},e.prototype.GetNormalA=function(t,e){var o=this.GetPerpendicularCCW(t,e);return o.Normalize(),o},e.prototype.GetNormalBV=function(t){var e=this.GetPerpendicularCWV(t);return e.Normalize(),e},e.prototype.GetNormalB=function(t,e){var o=this.GetPerpendicularCW(t,e);return o.Normalize(),o},e.prototype.GetMidPointV=function(t){var e=this.Copy();return e.AddV(t),e.Divide(2,2),e},e.prototype.GetMidPoint=function(t,e){var o=this.Copy();return o.Add(t,e),o.Multiply(.5,.5),o},e.prototype.IsEqualTo=function(t,e){return this.x===t&&this.y===e},e.prototype.IsEqualToV=function(t){return this.x===t.x&&this.y===t.y},e.prototype.GetProjectionOntoV=function(t){var e=this.GetDotV(t);if(0===e)return this.FromStore(0);var o=t.GetMagnitude(),r=e/(o*o),n=t.Copy();return n.Multiply(r,r),n},e.prototype.GetProjectionOnto=function(t,e){var o=this.Copy();o.Set(t,e);var r=this.GetDotV(o);if(0===r)return this.FromStore(0);var n=o.GetMagnitude(),i=r/(n*n);return o.Multiply(i,i),o},e.prototype.GetReflectionV=function(t){var e=t.Copy(),o=this.GetDotV(e);return e.Multiply(2,2),e.Multiply(o,o),this.SubtractVC(e)},e.prototype.GetReflection=function(t,e){var o=this.Copy();o.Set(t,e);var r=this.GetDotV(o);return o.Multiply(2,2),o.Multiply(r,r),this.SubtractVC(o)},e.prototype.Assert=function(){var e=t.Utils.Assert;e(this.x,e.IS_SAME_TYPE,0),e(this.y,e.IS_SAME_TYPE,0)},e.prototype.Store=function(){e.Pool.Store(this)},e.prototype.GetLength=e.prototype.GetMagnitude,e.prototype.GetLengthSquared=e.prototype.GetMagnitudeSquared,t.Math.Vector2D=e,t.Vector2D=e,e.Pool.Flood(function(){},1e5)}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.array=new Float32Array(9)}e.prototype=Object.create(null),e.prototype.constructor=e,e.EPSILON=1e-5,e.prototype.array=null,e.prototype.a=1,e.prototype.b=0,e.prototype.c=0,e.prototype.d=1,e.prototype.e=0,e.prototype.f=0,e.prototype.Identity=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},e.prototype.Copy=function(){var t=new e;return t.Set(this.a,this.b,this.c,this.d,this.e,this.f),t},e.prototype.Set=function(t,e,o,r,n,i){return this.a=t,this.b=e,this.c=o,this.d=r,this.e=n,this.f=i,this},e.prototype.SetTransform=function(t,e,o,r,n,i,s,a,l){t=null==t?0:t,e=null==e?0:e,o=null==o?1:o,r=null==r?1:r,n=null==n?0:n,i=null==i?0:i,s=null==s?0:s,a=null==a?0:a,l=null==l?0:l;var h=Math.sin(n),p=Math.cos(n),u=-Math.sin(i),c=Math.cos(i),f=Math.sin(s),y=Math.cos(s),d=p*o,v=h*o,m=-h*r,A=p*r;return this.a=y*d+f*m,this.b=y*v+f*A,this.c=u*d+c*m,this.d=u*v+c*A,this.e=t+a*d+l*m,this.f=e+a*v+l*A,this},e.prototype.Translate=function(t,e){this.e+=t,this.f+=e},e.prototype.TranslateTo=function(t,e){this.e=t,this.f=e},e.prototype.ApplyTranslation=function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f},e.prototype.ApplyScale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e},e.prototype.Scale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},e.prototype.Rotate=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.a,n=this.c,i=this.e;this.a=r*o-this.b*e,this.b=r*e+this.b*o,this.c=n*o-this.d*e,this.d=n*e+this.d*o,this.e=i*o-this.f*e,this.f=i*e+this.f*o},e.prototype.Decompose=function(t){var o=this.a,r=this.b,n=this.c,i=this.d,s=-Math.atan2(-n,i),a=Math.atan2(r,o);Math.abs(s+a)<e.EPSILON?(t.rotation=a,o<0&&i>=0&&(t.rotation+=Math.PI),t.skew.Set(0)):t.skew.Set(s,a),t.scale.Set(Math.sqrt(o*o+r*r),Math.sqrt(n*n+i*i)),t.position.Set(this.e,this.f)},e.prototype.ApplyToContext=function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)},e.prototype.AsArray=function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e},t.Math.Matrix2D=e,t.Matrix2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e;this.position=new t.Vector2D(o,r),this.scale=new t.Vector2D(1,1),this.localTransform=new t.Vector2D(0,0),this.worldTransform=new t.Vector2D(0,0)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.UpdateLocal=function(){this.localTransform.SetV(this.position)},e.prototype.UpdateWorld=function(t){var e=this.localTransform;e.SetV(this.position),this.worldTransform.Set(t.e+e.x,t.f+e.y)},e.prototype.ApplyWorld=function(t){t.setTransform(this.scale.x,0,0,this.scale.y,this.worldTransform.x,this.worldTransform.y)},t.Math.Basetransform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.position=t.Vector2D(o,r),this.scale=new t.Vector2D(1,1),this.skew=new t.Vector2D(0,0),this.pivot=new t.Vector2D(0,0),this.localTransform=new t.Matrix2D,this.worldTransform=new t.Matrix2D}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.rotation=0,e.prototype.skewCX=1,e.prototype.skewSX=0,e.prototype.skewCY=0,e.prototype.skewSY=1,e.prototype.Set=function(t){t.Decompose(this),this.UpdateSkew()},e.prototype.UpdateLocal=function(){var t=this.localTransform,e=this.position,o=this.scale,r=this.pivot;t.a=this.skewCX*o.x,t.b=this.skewSX*o.x,t.c=this.skewCY*o.y,t.d=this.skewSY*o.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d},e.prototype.UpdateWorld=function(t){var e=this.localTransform,o=this.worldTransform,r=this.position,n=this.scale,i=this.pivot;e.a=this.skewCX*n.x,e.b=this.skewSX*n.x,e.c=this.skewCY*n.y,e.d=this.skewSY*n.y,e.e=r.x-i.x*e.a+i.y*e.c,e.f=r.y-i.y*e.b+i.y*e.d,o.a=e.a*t.a+e.b*t.c,o.b=e.a*t.b+e.b*t.d,o.c=e.c*t.a+e.d*t.c,o.d=e.c*t.b+e.d*t.d,o.e=e.e*t.a+e.f*t.c+t.e,o.f=e.e*t.b+e.f*t.d+t.f},e.prototype.UpdateSkew=function(){var t=this.skew,e=this.rotation;this.skewCX=Math.cos(e+t.y),this.skewSX=Math.sin(e+t.y),this.skewCY=-Math.sin(e-t.x),this.skewSY=Math.cos(e-t.x)},e.prototype.ApplyWorld=function(t){this.worldTransform.ApplyToContext(t)},t.Math.Transform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n,i){if(!(this instanceof e))return new e(o,r,n,i);void 0!==o&&null!=o.x&&null!=o.y&&void 0!==r&&null!=r.x&&null!=r.y?(this.s=o,this.e=r):void 0!==o&&void 0!==r&&void 0!==n&&void 0!==i?(this.s=new t.Vector2D(o,r),this.e=new t.Vector2D(n,i)):(this.s=new t.Vector2D,this.e=new t.Vector2D)}var o=t.Math.LineLineIntersection,r=t.Math.ClosestPointOnLine;e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=0,e.prototype.TYPE=e.TYPE,e.prototype.epsilon=1e3,e.prototype.belongsTo=null,e.prototype.Stretch=function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)},e.prototype.Rotate=function(t,e,o){e=void 0==e?.5:e;var r=this.s.Copy();r.AddV(this.e),r.Multiply(e,void 0==o?e:o),this.s.RotateAroundV(r,t),this.e.RotateAroundV(r,t)},e.prototype.GetLength=function(){return this.s.GetDistanceV(this.e)},e.prototype.GetLengthSquared=function(){return this.s.GetDistanceSquaredV(this.e)},e.prototype.IntersectsPoint=function(t){var e=this.s,o=this.e,r=(t.y-e.y)*(o.x-e.x)-(t.x-e.x)*(o.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var n=(t.x-e.x)*(o.x-e.x)+(t.y-e.y)*(o.y-e.y);return!(n<0)&&!(n>this.GetLengthSquared())},e.prototype.IntersectsLine=function(t){return o(this.s,this.e,t.s,t.e)},e.prototype.GetClosestPointTo=function(t){return r(this.s,this.e,t)},e.prototype.GetNormalA=function(){return this.s.GetNormalAV(this.e)},e.prototype.GetNormalB=function(){return this.s.GetNormalBV(this.e)},t.Geom.Line2D=e,t.Geom.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n,i){if(!(this instanceof e))return new e(o,r,n,i);o instanceof t.Vector2D&&r instanceof t.Vector2D?(this.tl=o,this.br=r):void 0!==o&&void 0!==r&&void 0!==o.x&&void 0!==o.y&&void 0!==r.x&&void 0!==r.y?(this.tl=new t.Vector2D(o.x,o.y),this.br=new t.Vector2D(r.x,r.y)):void 0!==o&&void 0!==r&&void 0!==n&&void 0!==i?(this.tl=new t.Vector2D(o,r),this.br=new t.Vector2D(n,i)):(this.tl=new t.Vector2D,this.br=new t.Vector2D),this.ComputeWH()}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=1,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.prototype.TYPE=e.TYPE,e.prototype.w=0,e.prototype.h=0,e.prototype.hw=0,e.prototype.hh=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,o,r){this.tl.x=t,this.tl.y=e,this.br.x=o,this.br.y=r,this.ComputeWH()},e.prototype.SetC=function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)},e.prototype.Scale=function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()},e.prototype.ComputeWH=function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h},e.prototype.GetQuadrant=function(t){var o=this.tl,r=this.br;switch(t){case e.TOP_LEFT:return new e(o.x,o.y,o.x+this.hw,o.y+this.hh);case e.TOP_RIGHT:return new e(o.x+this.hw,o.y,r.x,o.y+this.hh);case e.BOTTOM_LEFT:return new e(o.x,o.y+this.hh,o.x+this.hw,r.y);case e.BOTTOM_RIGHT:return new e(o.x+this.hw,o.y+this.hh,r.x,r.y);default:return null}},e.prototype.IntersectsPoint=function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)},e.prototype.ContainsPoint=function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y},e.prototype.IntersectsAABB2D=function(t){var e=this.tl,o=this.br,r=t.tl,n=t.br;return!(r.x>=o.x||r.y>=o.y||n.x<=e.x||n.y<=e.y)},e.prototype.ContainsAABB2D=function(t){if(t.area>this.area)return!1;var e=this.tl,o=this.br,r=t.tl,n=t.br;return r.x>=e.x&&r.y>=e.y&&n.x<=o.x&&n.y<=o.y},t.Geom.AABB2D=e,t.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new t.Vector2D,null!=o&&(o[0]instanceof t.Vector2D?this.AddPoints(o):this.PushPoints(o))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=3,e.CreateCopy=function(t){for(var o=new e,r=0,n=t.vertices,i=n.length;r<i;++r)o.AddPoint(n[r].Copy());return o},e.Construct=Object.create(null),e.Construct.Rectangular=function(e,o,r,n,i){var s=new t.Vector2D(o,r),a=new t.Vector2D(o+n,r),l=new t.Vector2D(o+n,r+i),h=new t.Vector2D(o,r+i);return e.Recreate([s,a,l,h]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Isosceles=function(e,o,r,n,i){var s=new t.Vector2D(o,r),a=new t.Vector2D(o+.5*n,r+i),l=new t.Vector2D(o-.5*n,r+i);return e.Recreate([s,a,l]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Cyclic=function(e,o,r,n,i){var s,a,l,h=0,p=i,u=2*Math.PI/p;for(e.Recreate([]),h;h<p;++h)l=u*h,s=Math.cos(l)*n,a=Math.sin(l)*n,e.AddPoint(new t.Vector2D(o+s,r+a));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Equilateral=function(e,o,r,n){var i,s,a=2.0943951023931953;return e.Recreate([]),i=Math.cos(0)*n,s=Math.sin(0)*n,e.AddPoint(new t.Vector2D(o+i,r+s)),i=Math.cos(a)*n,s=Math.sin(a)*n,e.AddPoint(new t.Vector2D(o+i,r+s)),i=Math.cos(2*a)*n,s=Math.sin(2*a)*n,e.AddPoint(new t.Vector2D(o+i,r+s)),e.Rotate(-90*t.Math.RADIAN),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Star=function(e,o,r,n,i,s){var a,l,h,p,u=0,c=2*s,f=2*Math.PI/c;for(e.Recreate([]),u;u<c;++u)p=0==(1&u)?n:i,h=f*u,a=Math.cos(h)*p,l=Math.sin(h)*p,e.AddPoint(new t.Vector2D(o+a,r+l));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Butterfly=function(o,r,n,i,s){var a,l,h,p=0,u=e.Construct.Butterfly.C;for(o.Recreate([]),p;p<i;++p)h=p*u._1*Math.PI/i,a=Math.cos(h)*(Math.exp(Math.cos(h))-u._2*Math.cos(u._3*h)-Math.pow(Math.sin(h/u._4),u._5))*s,l=Math.sin(h)*(Math.exp(Math.cos(h))-u._2*Math.cos(u._3*h)-Math.pow(Math.sin(h/u._4),u._5))*s,o.AddPoint(new t.Vector2D(r+a,n+l));return o.ComputeBounds(),o.GetNormalsA(),o},e.Construct.Butterfly.C={_1:24,_2:2,_3:4,_4:12,_5:5,Reset:function(){this._1=24,this._2=2,this._3=4,this._4=12,this._5=5}},e.Construct.Supershape=function(o,r,n,i,s,a,l,h,p){l=void 0===l?1:l,h=void 0===h?1:h,p=void 0===p?1:p;var u,c,f,y,d,v,m=0,A=s,T=e.Construct.Supershape.C;for(o.Recreate([]),m;m<A;++m)f=m*Math.PI*2/s,d=Math.cos(a*f/4)/T._A,d=Math.abs(d),d=Math.pow(d,h),v=Math.sin(a*f/4)/T._B,v=Math.abs(v),v=Math.pow(v,p),y=Math.pow(d+v,1/l),0===Math.abs(y)?(u=0,c=0):(y=1/y,u=Math.cos(f)*y*i,c=Math.sin(f)*y*i),o.AddPoint(new t.Vector2D(r+u,n+c));return o.ComputeBounds(),o.GetNormalsA(),o},e.Construct.Supershape.C={_A:1,_B:1},e.prototype.TYPE=e.TYPE,e.prototype.aabb=null,e.prototype.dirtyBounds=!0,e.prototype.belongsTo=null,e.prototype.AddPoint=function(t){this.vertices.push(t)},e.prototype.AddPoints=function(t){this.vertices.push.apply(this.vertices,t)},e.prototype.PushPoint=function(e,o){this.vertices.push(new t.Vector2D(e,o))},e.prototype.PushPoints=function(t){for(var e=0,o=t.length;e<o;e+=2)this.PushPoint(t[e],t[e+1])},e.prototype.Recreate=function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)},e.prototype.ComputeBounds=function(){null===this.aabb&&(this.aabb=new t.Geom.AABB2D);for(var e,o=1/0,r=-o,n=o,i=-o,s=0,a=this.vertices,l=a.length;s<l;++s)e=a[s],e.x<o&&(o=e.x),e.x>r&&(r=e.x),e.y<n&&(n=e.y),e.y>i&&(i=e.y);this.aabb.Set(o,n,r,i),this.dirtyBounds=!1},e.prototype.Rotate=function(t,e,o,r){!0===this.dirtyBounds&&!0===r?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e;var n=this.aabb,i=n.tl.Copy();i.AddV(n.br),i.Multiply(e,void 0===o?e:o);var s,a=0,l=this.vertices,h=l.length;for(a;a<h;++a)s=l[a],s.RotateAroundV(i,t);this.dirtyBounds=!0},e.prototype.GetCentroid=function(){var t=this.centroid;t.Set(0,0);for(var e,o=0,r=this.vertices,n=r.length;o<n;++o)e=r[o],t.AddV(e);return t.Divide(n,n),t},e.prototype.GetNormalsA=function(){var t=this.normals;t.length=0;for(var e=0,o=this.vertices,r=o[e],n=this.vertices.length-1;e<n;r=o[++e])t.push(r.GetNormalAV(o[e+1]));return t.push(o[n].GetNormalAV(o[0])),t},e.prototype.GetNormalsB=function(){var t=this.normals;t.length=0;for(var e=0,o=this.vertices,r=o[e],n=this.vertices.length-1;e<n;r=o[++e])t.push(r.GetNormalBV(o[e+1]));return t.push(o[n].GetNormalBV(o[0])),t},e.prototype.GetPerimeterMidPoints=function(){var t=this.perimeterMidPoints;t.length=0;for(var e=0,o=this.vertices,r=o[e],n=this.vertices.length-1;e<n;r=o[++e])t.push(r.GetMidPointV(o[e+1]));return t.push(o[n].GetMidPointV(o[0])),t},e.prototype.IntersectsPoint=function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;var e,o,r,n,i=t.x,s=t.y,a=!1,l=this.vertices,h=l.length;for(e=0,o=h-1;e<h;o=e++)r=l[e],n=l[o],r.y>s!=n.y>s&&i<(n.x-r.x)*(s-r.y)/(n.y-r.y)+r.x&&(a=!a);return a},t.Geom.Polygon2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n){if(!(this instanceof e))return new e(o,r,n);this.center=new t.Vector2D(o,r),this.radius=void 0===n?32:n}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=2,e.prototype.TYPE=e.TYPE,e.prototype.diameter=0,e.prototype.w=0,e.prototype.h=0,e.prototype.radiusSquared=0,e.prototype.radiusUnsquared=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,o){this.center.Set(t,e),this.radius=o},e.prototype.SetC=function(t){this.center.SetV(t),this.radius=t.radius},e.prototype.Scale=function(t){this.radius*=t},e.prototype.IntersectsCircle=function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)},e.prototype.IntersectsPoint=function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)},Object.defineProperty(e.prototype,"x",{set:function(t){this.center.x=t},get:function(){return this.center.x}}),Object.defineProperty(e.prototype,"y",{set:function(t){this.center.y=t},get:function(){return this.center.y}}),Object.defineProperty(e.prototype,"radius",{set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=Math.PI*t*t},get:function(){return this.radiusUnsquared}}),t.Geom.Circle=e}},function(t,e){t.exports=function(t){"use strict";var e=Object.create(null);e.AABB2DvsAABB2D=Object.create(null),e.AABB2DvsAABB2D.Relative=Object.create(null),e.CirclevsCircle=Object.create(null),e.CirclevsCircle.Relative=Object.create(null),e.PolygonvsPolygon=Object.create(null),e.PolygonvsPolygon.Relative=Object.create(null),e.CirclevsLine=Object.create(null),e.CirclevsLine.Relative=Object.create(null),e.VectorSortMinMag=function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()};var o=t.Vector2D.GetMinMaxDot,r=t.Math.ClosestPointOnLine;e.AABB2DvsAABB2D.Result=function(){this.mtv=new t.Vector2D},e.AABB2DvsAABB2D.Result.prototype.occured=!1,e.AABB2DvsAABB2D.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.occured=!1},e.AABB2DvsAABB2D.Relative.Collide=function(o,r,n){var i=o.shape,s=i.w,a=i.h,l=o.anchor,h=r.shape,p=h.w,u=h.h,c=r.anchor,f=i.tl.SubtractVC(o.relative),y=h.tl.SubtractVC(r.relative);void 0!=l&&(f.x+=l.x*s,f.y+=l.y*a),void 0!=c&&(y.x+=c.x*p,y.y+=c.y*u);var d=y.x+s,v=f.x+p,m=y.y+a,A=f.y+u;if(f.x<d&&y.x<v&&f.y<m&&y.y<A){if(void 0!=n){var T=[new t.Vector2D(f.x-d,0),new t.Vector2D(v-y.x,0),new t.Vector2D(0,f.y-m),new t.Vector2D(0,A-y.y)];T.sort(e.VectorSortMinMag),n.mtv.SetV(T[0]),n.occured=!0}return!0}return!1},e.CirclevsCircle.Result=function(){this.mtv=new t.Vector2D(0,0),this.poc={a:null,b:null,c:null}},e.CirclevsCircle.Result.prototype.mtd=0,e.CirclevsCircle.Result.prototype.delta=null,e.CirclevsCircle.Result.prototype.occured=!1,e.CirclevsCircle.Result.prototype.Reset=function(){this.poc.a=null,this.poc.b=null,this.poc.c=null,this.mtv.Set(0,0),this.mtd=0,this.delta=null,this.occured=!1},e.CirclevsCircle.Relative.Collide=function(e,o,r){var n=e.shape,i=o.shape,s=n.radius,a=i.radius,l=s+a,h=e.anchor,p=o.anchor,u=e.relative.Copy(),c=o.relative.Copy();void 0!=h&&(u.x+=h.x*n.diameter,u.y+=h.y*n.diameter),void 0!=p&&(c.x+=p.x*i.diameter,c.y+=p.y*i.diameter);var f=c.SubtractVC(u),y=f.GetMagnitudeSquared();if(l*l>y){if(void 0!=r){var d=Math.sqrt(y),v=(n.radiusSquared-i.radiusSquared+y)/(d+d),m=new t.Vector2D(u.x+f.x*v/d,u.y+f.y*v/d),A=Math.sqrt(n.radiusSquared-v*v)/d,T=-f.y*A,g=f.x*A,S=new t.Vector2D(m.x+T,m.y+g),x=new t.Vector2D(m.x-T,m.y-g),C=u.SubtractVC(c);C.Divide(l,l);var b=d-s-a;r.poc.a=m,r.poc.b=S,r.poc.c=x,r.mtv.SetV(C),r.mtd=b,r.delta=f,r.occured=!0}return!0}return!1},e.CirclevsCircle.Relative.ElasticResponse=function(t,e,o){var r=o.delta.Copy(),n=o.mtv.Copy();r.Normalize();var i=t.mass,s=e.mass,a=t.velocity,l=e.velocity,h=a.GetDotV(r),p=l.GetDotV(r),u=2*(h-p)/(i+s);a.Set(a.x-u*s*r.x,a.y-u*s*r.y),l.Set(l.x+u*i*r.x,l.y+u*i*r.y),n.Multiply(o.mtd,o.mtd),n.Divide(2,2),t.relative.SubtractV(n),e.relative.AddV(n)},e.PolygonvsPolygon.Result=function(){this.mtv=new t.Vector2D(0,0),this.olAxis=new t.Vector2D(0,0)},e.PolygonvsPolygon.Result.prototype.occured=!1,e.PolygonvsPolygon.Result.prototype.mtd=1/0,e.PolygonvsPolygon.Result.prototype.Reset=function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)};var n=e.PolygonvsPolygon.Relative.AxisSeparates=function(t,e,r,n){var i=o(t.shape.vertices,r),s=o(e.shape.vertices,r),a=e.relative.SubtractVC(t.relative).GetDotV(r);if(s.Add(a,a),i.x>s.y||s.x>i.y)return!0;if(void 0!=n){var l=0,h=i.x,p=i.y,u=s.x,c=s.y,f=0,y=0;h<u?p<c?l=p-u:(f=p-u,y=c-h,l=f<y?f:-y):p>c?l=h-c:(f=p-u,y=c-h,l=f<y?f:-y);var d=Math.abs(l);d<n.mtd&&(n.mtd=d,n.olAxis.SetV(r),l<0&&n.olAxis.Invert())}return!1};e.PolygonvsPolygon.Relative.Collide=function(t,e,o){var r=t.shape,i=e.shape,s=r.normals,a=i.normals,l=0,h=s.length,p=a.length;for(l;l<h;++l)if(!0===n(t,e,s[l],o))return!1;for(l=0;l<p;++l)if(!0===n(t,e,a[l],o))return!1;return void 0!=o&&(o.mtv.SetV(o.olAxis),o.mtv.Multiply(o.mtd,o.mtd),o.occured=!0),!0},e.CirclevsLine.Result=function(){this.mtv=new t.Vector2D(0,0),this.cp=new t.Vector2D(0,0)},e.CirclevsLine.Result.prototype.occured=!1,e.CirclevsLine.Result.prototype.sore=0,e.CirclevsLine.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.cp.Set(0,0),this.occured=!1,this.sore=0},e.CirclevsLine.Relative.Collide=function(t,e,o){var n=e.shape,i=t.shape,s=e.relative,a=t.relative,l=n.s.AddVC(s),h=n.e.AddVC(s),p=r(l,h,a),u=a.SubtractVC(p),c=u.GetMagnitudeSquared();if(c<i.radiusSquared){if(o){var f=u,y=i.radius-Math.sqrt(c);f.Normalize(),f.Multiply(y,y),o.mtv.SetV(f),o.cp.SetV(p),o.occured=!0,p===l?o.sore=1:p===h&&(o.sore=2)}return!0}return!1},e.CirclevsLine.Relative.ReflectingResponse=function(t,e,o){var r,n,i=e.shape,s=t.velocity,a=t.relative,l=o.cp;0!==o.sore?(r=l.SubtractVC(a),r.Normalize()):r=i.GetNormalA(),n=s.GetReflectionV(r),s.SetV(n),a.AddV(o.mtv)},t.Math.Collision2D=e}},function(t,e){t.exports=function(t){"use strict";t.Math.Ease=Object.create(null),t.Math.Ease.Linear=function(t,e,o,r){return o*t/r+e},t.Math.Ease.QuadIn=function(t,e,o,r){return t/=r,o*t*t+e},t.Math.Ease.QuadOut=function(t,e,o,r){return t/=r,-o*t*(t-2)+e},t.Math.Ease.QuadInOut=function(t,e,o,r){return(t/=.5*r)<1?.5*o*t*t+e:(t--,.5*-o*(t*(t-2)-1)+e)},t.Math.Ease.SineIn=function(t,e,o,r){return-o*Math.cos(t/r*(.5*Math.PI))+o+e},t.Math.Ease.SineOut=function(t,e,o,r){return o*Math.sin(t/r*(.5*Math.PI))+e},t.Math.Ease.SineInOut=function(t,e,o,r){return.5*-o*(Math.cos(Math.PI*t/r)-1)+e}}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n,i,s,a){if(!(this instanceof e))return new e(o,r,n,i,s,a);this.id=o,this.target=r,this.propertyString=n,void 0!==i&&(this.value=i),void 0!==s&&(this.duration=s),this.easing=t.Math.Ease[void 0===a?e.DEFAULT_EASING:a],this.onStart=new t.Event.LocalEvent,this.onEnd=new t.Event.LocalEvent,this.onStop=new t.Event.LocalEvent,this.onReconfigure=new t.Event.LocalEvent,this.onReset=new t.Event.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.DEFAULT_EASING="Linear",e.prototype.id=null,e.prototype.target=null,e.prototype.easing=null,e.prototype.duration=1e3,e.prototype.time=0,e.prototype.value=1,e.prototype.startValue=0,e.prototype.propertyString=null,e.prototype.change=0,e.prototype.property=null,e.prototype.propertyObject=null,e.prototype.running=!1,e.prototype.Start=function(){var e=this.propertyString.split(".");this.property=e[e.length-1],this.propertyObject=t.Utils.Nested(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)},e.prototype.Stop=function(){delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onStop.Dispatch(this,null)},e.prototype.Process=function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))},e.prototype.Reconfigure=function(o,r,n,i){void 0!==o&&(this.propertyString=o),this.value=r,this.duration=n,this.easing=t.Math.Ease[void 0===i?e.DEFAULT_EASING:i],this.onReconfigure.Dispatch(this,null)},e.prototype.Reset=function(){if(null===this.propertyObject||null===this.property)return!1;this.propertyObject[this.property]=this.startValue,delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onReset.Dispatch(this,null)},t.Motion=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.motions=[],this.target=t}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.target=null,e.prototype.motions=null,e.prototype.Create=function(e,o,r,n,i){if(null===this.GetMotion(e)){var s=new t.Motion(e,this.target,o,r,n,i);return this.motions.push(s),s}return null},e.prototype.Add=function(t){null===this.GetMotion(t.id)&&this.motions.push(t)},e.prototype.Start=function(t){var e=this.GetMotion(t);return null!==e&&e.Start(),e},e.prototype.StartMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Start(t[e])},e.prototype.Stop=function(t){var e=this.GetMotion(t);return null!==e&&e.Stop(),e},e.prototype.StopMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Stop(t[e])},e.prototype.Reset=function(t){var e=this.GetMotion(t);return null!==e&&e.Reset(),e},e.prototype.ResetMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Reset(t[e])},e.prototype.Process=function(){for(var t,e=0,o=this.motions,r=o.length;e<r;++e)t=o[e],t.Process()},e.prototype.GetMotion=function(t){for(var e,o=0,r=this.motions,n=r.length;o<n;++o)if(e=r[o],e.id===t)return e;return null},t.MotionManager=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n){if(!(this instanceof e))return new e(t,o,r,n);this.Set(t,o,r,n),this.nodes={},this.objects=[],this.convergence=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.Pool=new t.Utils.Pool(e),e.Pool.Retrieve=function(t,e,o,r){0===this.objects.length&&this.Flood();var n=this.objects.pop();return n.Set(t,e,o,r),n},e.USE_POOL=!0,e.prototype.objectCap=0,e.prototype.levelCap=0,e.prototype.level=0,e.prototype.nodes=null,e.prototype.objects=null,e.prototype.convergence=null,e.prototype.aabb=null,e.prototype.hasSplit=!1,e.prototype.Set=function(t,e,o,r){this.aabb=t,this.level=e,this.objectCap=o,this.levelCap=r},e.prototype.FromStore=function(t,o,r,n){return!0===e.USE_POOL?e.Pool.Retrieve(t,o,r,n):new e(t,o,r,n)},e.prototype.Add=function(t){var e="",o=this.objects,r=this.nodes,n=0;if(!0===this.hasSplit&&null!==(e=this.Marking(t)))return void r[e].Add(t);if(o.push(t),this.level<this.levelCap&&o.length>this.objectCap)for(!1===this.hasSplit&&this.Split();n<o.length;)e=this.Marking(o[n]),null!==e?r[e].Add(o.fickleSplice(n)):++n},e.prototype.Converge=function(t){var o=this.convergence;o.length=0,o.push.apply(o,this.objects);var r=null,n=this.nodes;return!0===this.hasSplit&&(r=this.Marking(t),null!==r?o.push.apply(o,n[r].Converge(t)):(o.push.apply(o,n[e.TOP_LEFT].Converge(t)),o.push.apply(o,n[e.TOP_RIGHT].Converge(t)),o.push.apply(o,n[e.BOTTOM_LEFT].Converge(t)),o.push.apply(o,n[e.BOTTOM_RIGHT].Converge(t)))),o},e.prototype.Split=function(){var t=this.level+1,o=this.objectCap,r=this.levelCap,n=this.nodes,i=this.aabb;n[e.TOP_LEFT]=this.FromStore(i.GetQuadrant(e.TOP_LEFT),t,o,r),n[e.TOP_RIGHT]=this.FromStore(i.GetQuadrant(e.TOP_RIGHT),t,o,r),n[e.BOTTOM_LEFT]=this.FromStore(i.GetQuadrant(e.BOTTOM_LEFT),t,o,r),n[e.BOTTOM_RIGHT]=this.FromStore(i.GetQuadrant(e.BOTTOM_RIGHT),t,o,r),this.hasSplit=!0},e.prototype.Dump=function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[e.TOP_LEFT].Dump(),t[e.TOP_RIGHT].Dump(),t[e.BOTTOM_LEFT].Dump(),t[e.BOTTOM_RIGHT].Dump(),!0===e.USE_POOL&&(t[e.TOP_LEFT].Store(),t[e.TOP_RIGHT].Store(),t[e.BOTTOM_LEFT].Store(),t[e.BOTTOM_RIGHT].Store())),this.nodes={},this.hasSplit=!1},e.prototype.Marking=function(t){var o=this.nodes;return!0===o[e.TOP_LEFT].aabb.ContainsAABB2D(t)?e.TOP_LEFT:!0===o[e.TOP_RIGHT].aabb.ContainsAABB2D(t)?e.TOP_RIGHT:!0===o[e.BOTTOM_LEFT].aabb.ContainsAABB2D(t)?e.BOTTOM_LEFT:!0===o[e.BOTTOM_RIGHT].aabb.ContainsAABB2D(t)?e.BOTTOM_RIGHT:null},e.prototype.ConcatNodes=function(t){void 0===t&&(t=[]),t.push(this);var o=this.nodes;return!1===this.hasSplit?t:(o[e.TOP_LEFT].ConcatNodes(t),o[e.TOP_RIGHT].ConcatNodes(t),o[e.BOTTOM_LEFT].ConcatNodes(t),o[e.BOTTOM_RIGHT].ConcatNodes(t),t)},e.prototype.Store=function(){e.Pool.Store(this)},t.Utils.QuadtreeNode=e,t.QuadtreeNode=e,e.Pool.Flood(function(){},1e3)}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.transform=new t.Math.Transform2D(o,r),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=new t.Math.Transform2D,e.prototype.parent=null,e.prototype.transform=null,e.prototype.data=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){var e=this.transform.worldTransform;return new t.Vector2D(e.e,e.f)},e.prototype.ComputeBounds=function(e){var o=e&&e.x?e.x:0,r=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=new t.Geom.AABB2D(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w*this.scale.x},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}),t.Entity.CoreEntity2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);o.call(this,t,r),this.children=[]}var o=t.Entity.CoreEntity2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.children=null,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.isBatchParent=!1,e.prototype.childDataBuffer=null,e.prototype.bufferData=null,e.prototype.programController=null,e.prototype.bufferStartIndex=0,e.prototype.bufferEndIndex=0,e.prototype.PreDraw=function(){},e.prototype.GLPreDraw=function(){},e.prototype.Draw=function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t))},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t)))},e.prototype.RequestTransformUpdate=function(){this.transformShouldUpdate=!0},e.prototype.DrawChildren=function(t){for(var e,o=0,r=this.children,n=r.length;o<n;++o)e=r[o],e.Draw&&e.Draw(t)},e.prototype.GLDrawChildren=function(t){for(var e,o=0,r=this.children,n=r.length;o<n;++o)e=r[o],e.GLDraw&&e.GLDraw(t)},e.prototype.GLBatchDrawChildren=function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)},e.prototype.ComputeBatchBuffer=function(t){for(var e,o,r=[],n=0,i=this.children,s=i.length;n<s;++n)e=i[n],o=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=r.length,e.bufferEndIndex=r.length+o.length,r.push.apply(r,o);this.childDataBuffer=new Float32Array(r)},e.prototype.UpdateInBuffer=function(){throw new Error("Cannot update buffer data directly on Container2D object!")},e.prototype.GetBufferData=function(){throw new Error("Cannot access buffer data directly on Container2D object!")},e.prototype.AddChild=function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t},e.prototype.AddChildren=function(){var t=arguments;Array.isArray(t[0])&&(t=t[0]);for(var e=0,o=t.length;e<o;++e)this.AddChild(t[e])},e.prototype.Mount=function(){this.AddChildren.apply(this,arguments)},e.prototype.AddSibling=function(t){var e=this.parent;return null!==e&&e.AddChild(t),t},e.prototype.RemoveChild=function(t){var e=this.children,o=e.indexOf(t);if(-1!==o)return t.parent=null,e.fickleSplice(o)},e.prototype.RemoveChildren=function(){for(var t,e,o=this.children,r=arguments[0].length?arguments[0]:arguments,n=[],i=0,s=r.length;i<s;++i)t=r[i],-1!==(e=o.indexOf(t))&&(n.push(o.fickleSplice(e)),t.parent=null);return n},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.fickleSplice(e))}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.unshift(t.fickleSplice(e))}},e.prototype.Dump=function(){this.children.length=0},e.prototype.Destroy=function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.GetChildClosestTo=function(t,e){var o=this.children,r=null;if(0!==o.length){for(var n,i,s=0,a=o.length,l=1/0;s<a;++s)n=o[s],void 0!==e&&!1===e(n)||(i=Math.abs(n.position.GetDistanceSquared(t.x,t.y)))<l&&(l=i,r=n);return r}return null},e.prototype.GetChildFurthestFrom=function(t,e){var o=this.children,r=null;if(0!==o.length){for(var n,i,s=0,a=o.length,l=0;s<a;++s)n=o[s],void 0!==e&&!1===e(n)||(i=Math.abs(n.position.GetDistanceSquared(t.x,t.y)))>l&&(l=i,r=n);return r}return null},e.prototype.UseAsBatchParent=function(t){this.isBatchParent=!0,this.programController=t},t.Entity.Container2D=e,t.Container2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);o.call(this,t,r)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Render=function(){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&this.RenderChildren())},e.prototype.RenderChildren=function(){for(var t,e=0,o=this.children,r=o.length;e<r;++e)t=o[e],t.Render&&t.Render()},t.Entity.Case2D=e,t.Case2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n,i){if(!(this instanceof e))return new e(t,o,r,n,i);this.id=t.split(" "),this.handle=o,this.info=r,void 0!==n&&(this.priority=n),void 0!==i&&(this.breakIfExecuted=i),this.data={}}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.command=null,e.prototype.priority=0,e.prototype.breakIfExecuted=!1,e.prototype.Execute=function(t,e,o){return this.handle(t,e,o),this.breakIfExecuted},t.CP.Option=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n,i){if(!(this instanceof e))return new e(t,o,r,n,i);this.id=t.split(" "),this.handle=o,this.info=r,this.data={},this.optionPrefix=void 0===i?e.OPTION_PREFIX:i,this.dsCopy=[],void 0!==n&&(this.continueToPrime=n)}e.prototype=Object.create(null),e.prototype.constructor=e,e.OPTION_PREFIX="",e.prototype.dataSeparator="=",e.prototype.options=null,e.prototype.allOptionIds=null,e.prototype.fullInfo=null,e.prototype.optionPrefix=null,e.prototype.continueToPrime=!0,e.prototype.dsCopy=null,e.prototype.register=null,e.prototype.Execute=function(t,e,o){this.HandleData(t,e),!0===this.HandleOptions(t,e,o)&&this.handle(t,e,o)},e.prototype.AddOption=function(e,o,r,n,i,s){s=void 0===s?this.optionPrefix:s,null!==s&&(e=e.replace(/\S+/g,s+"$&")),null===this.options&&(this.options=[]),n=void 0===n?0:n;var a=new t.CP.Option(e,o,r,n,i);a.command=this;for(var l,h=0,p=this.options,u=p.length;h<u;++h)if(l=p[h],l.priority<=n)return p.splice(h,0,a),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(a),this.allOptionIds=this.GetAllOptionIds(),this},e.prototype.HandleData=function(t,e){var o=this.dsCopy;o.push.apply(o,t);for(var r,n,i=0,s=o.length,a=this.dataSeparator;i<s;++i)r=o[i],n=r.split(a),2===n.length&&(t.fickleSplice(i),e[n[0]]=n[1]);o.length=0},e.prototype.HandleOptions=function(t,e,o){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null===r)return this.continueToPrime;for(var n,i=0,s=r.length;i<s;++i)if(n=this.GetOptionById(r[i]),!0===n.Execute(t,e,o))return!1;return this.continueToPrime},e.prototype.GetOptionById=function(t){for(var e,o=0,r=this.options,n=r.length;o<n;++o)if(e=r[o],-1!==e.id.indexOf(t))return e;return null},e.prototype.GetAllOptionIds=function(){for(var t=[],e=0,o=this.options,r=o.length;e<r;++e)t.push.apply(t,o[e].id);return t},e.prototype.GetAndRemoveMatchingOptionIds=function(t){var e=this.allOptionIds;if(null===e)return null;for(var o=[],r=0,n=e.length;r<n;++r){var i=t.indexOf(e[r]);-1!==i&&o.push(t.fickleSplice(i))}return o},e.prototype.GenerateInfoString=function(){for(var t,e="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",o=0,r=this.options,n=r.length;o<n;++o)t=r[o],e+="OPTION: "+t.id.join(", ")+" -> "+t.info+"\n";return e},t.CP.Command=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.commands=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.splitter=" ",e.prototype.AddCommand=function(t){if(null===t.register)return this.commands.push(t),t.register=this,t},e.prototype.RemoveCommand=function(t){var e=this.commands,o=e.indexOf(t);if(-1!==o)return t.register=null,e.fickleSplice(o)},e.prototype.GetCommand=function(t){for(var e,o=0,r=this.commands,n=r.length;o<n;++o)if(e=this.commands[o])for(var i=0,s=e.id.length;i<s;++i)if(e.id[i]===t)return e;return null},e.prototype.Parse=function(t,e){var o=String(t).split(this.splitter),r=o.shift(),n=this.GetCommand(r);return n?(n.Execute(o,{},e),null):r},t.CP.Register=e}},function(t,e,o){t.exports=o(32)},function(t,e,o){(function(e){var r=Object.create(null);o(1)(),o(33)(r),o(34)(r),o(2)(r),o(3)(r),o(4)(r),o(5)(r),o(6)(r),o(41)(r),o(7)(r),o(8)(r),o(42)(r),o(43)(r),o(44)(r),o(45)(r),o(46)(r),o(47)(r),o(48)(r),o(49)(r),o(9)(r),o(10)(r),o(50)(r),o(11)(r),o(12)(r),o(13)(r),o(14)(r),o(15)(r),o(16)(r),o(17)(r),o(18)(r),o(19)(r),o(20)(r),o(21)(r),o(22)(r),o(23)(r),o(24)(r),o(51)(r),o(52)(r),o(53)(r),o(54)(r),o(55)(r),o(56)(r),o(57)(r),o(58)(r),o(25)(r),o(26)(r),o(27)(r),o(59)(r),o(60)(r),o(61)(r),o(62)(r),o(63)(r),o(64)(r),o(65)(r),o(66)(r),o(67)(r),o(68)(r),o(69)(r),o(70)(r),o(28)(r),o(29)(r),o(30)(r),o(71)(r),o(72)(r),o(73)(r),o(74)(r),o(75)(r),o(76)(r),o(77)(r),o(78)(r),o(79)(r),o(80)(r),e.Nenkraft=e.nk=r,t.exports=r}).call(e,o(0))},function(t,e){t.exports=function(t){t.Geom=Object.create(null),t.Style=Object.create(null),t.Math=Object.create(null),t.Utils=Object.create(null),t.Texture=Object.create(null),t.Controller=Object.create(null),t.Entity=Object.create(null),t.Path=Object.create(null),t.Event=Object.create(null),t.Time=Object.create(null),t.Input=Object.create(null),t.CP=Object.create(null),t.Load=Object.create(null),t.Animator=Object.create(null),t.VERSION="0.6.4 (Beta)",t.PRINT_VERSION=function(){console.log("%cnenkraft %cversion %c"+t.VERSION,"color:cyan;background-color:black;font-family:Arial;font-size:16px;font-weight:900;","color:magenta;background-color:black;font-family:Arial;font-size:16px;","color:yellow;background-color:black;font-family:Arial;font-size:18px;")}}},function(t,e,o){t.exports=function(t){"use strict";function e(t){var e,o,r="@vertex@",n="@fragment@";e=t.indexOf(r)+r.length,o=t.indexOf("@vertex-end@");var i=t.substring(e,o);return e=t.indexOf(n)+n.length,o=t.indexOf("@fragment-end@"),{v:i,f:t.substring(e,o)}}t.SHADER_CODE={TEXTURE_2D:e(o(35)),TEXTURE_2D_BATCH:e(o(36)),LINE2D:e(o(37)),RECTANGLE:e(o(38)),CIRCLE:e(o(39)),PIXEL_BATCH:e(o(40))}}},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition0;\r\nattribute vec2 aTexCoord0;\r\n\r\nattribute vec2 aPosition1;\r\nattribute vec2 aTexCoord1;\r\n\r\nattribute vec2 aPosition2;\r\nattribute vec2 aTexCoord2;\r\n\r\nattribute vec2 aPosition3;\r\nattribute vec2 aTexCoord3;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nuniform float uUnitId;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  if ( uUnitId == 0.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 1.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition1, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord1, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 2.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition2, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord2, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 3.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition3, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord3, 1.0 ) ).xy;\r\n  }\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord );\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vColor = uColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = vFillColor;\r\n  } else {\r\n    gl_FragColor = vOutlineColor;\r\n  }\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vRadius = uRadius;\r\n  vOutline = uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = vRadius * vRadius;\r\n  float ors = vRadius - vOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = vOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = vFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n){if(!(this instanceof e))return new e(t,o,r,n);this.channel=new Float32Array([null==t?0:t,null==o?0:o,null==r?0:r,null==n?1:n]),this.ComputeValueRGBA()}var o=t.Utils.Base16ToBase10,r=t.Utils.Clamp;e.prototype=Object.create(null),e.prototype.constructor=e;var n=e.NORM=1/255;e.prototype.value="",e.prototype.currentConversion="",e.prototype.Copy=function(){var t=new e(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return t.value=this.value,t.currentConversion=this.currentConversion,t},e.prototype.ComputeValueRGBA=function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value},e.prototype.ComputeValueHSLA=function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value},e.prototype.ComputeValueHex=function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value},e.prototype.ConvertToHSLA=function(t){var e=this.channel[0]/255,o=this.channel[1]/255,r=this.channel[2]/255,n=Math.max(e,o,r),i=Math.min(e,o,r),s=n-i,a=n+i,l=0,h=0,p=.5*a;n!==i&&(h=p>.5?s/(2-n-i):s/(n+i),l=n===e?(o-r)/s+(o<r?6:0):n===o?(r-e)/s+2:(e-o)/s+4,l/=6),this.channel[0]=360*l,this.channel[1]=100*h,this.channel[2]=100*p,!0===t&&(this.channel[0]=Math.round(this.channel[0]),this.channel[1]=Math.round(this.channel[1]),this.channel[2]=Math.round(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()},e.prototype.SetRGB=function(t,e,o,n){this.channel[0]=r(t,0,255),this.channel[1]=r(e,0,255),this.channel[2]=r(o,0,255),this.currentConversion="rgb",n||this.ComputeValueRGBA()},e.prototype.SetRGBA=function(t,e,o,n){this.SetRGB(t,e,o,!0),this.channel[3]=r(n,0,1),this.ComputeValueRGBA()},e.prototype.SetHex=function(t){t=t.replace(/#/g,"");var e=t.match(/.{2}/g);e=e.map(o),null==e[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])},e.prototype.IncreaseChannel=function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()},e.prototype.SetChannel=function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()},e.prototype.Normalize=function(){this.channel[0]=n*this.channel[0],this.channel[1]=n*this.channel[1],this.channel[2]=n*this.channel[2]},Object.defineProperty(e.prototype,"r",{set:function(t){this.channel[0]=t},get:function(){return this.channel[0]}}),Object.defineProperty(e.prototype,"g",{set:function(t){this.channel[1]=t},get:function(){return this.channel[1]}}),Object.defineProperty(e.prototype,"b",{set:function(t){this.channel[2]=t},get:function(){return this.channel[2]}}),Object.defineProperty(e.prototype,"a",{set:function(t){this.channel[3]=t},get:function(){return this.channel[3]}}),t.Color=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#444499",e.prototype.applied=!0,e.prototype.Apply=function(t){t.fillStyle=this.color},t.Style.Fill=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#000000",e.prototype.blur=5,e.prototype.offsetX=0,e.prototype.offsetY=0,e.prototype.applied=!1,e.prototype.Apply=function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY},t.Style.Shadow=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,t.Style.LINE_CAP={ROUND:"round",BUTT:"butt",SQUARE:"square"},t.Style.LINE_JOIN={BEVEL:"bevel",ROUND:"round",MITER:"miter"},e.prototype.color="#00FFFF",e.prototype.lineCap=t.Style.LINE_CAP.ROUND,e.prototype.lineJoin=t.Style.LINE_JOIN.ROUND,e.prototype.lineWidth=1,e.prototype.miterLimit=10,e.prototype.applied=!0,e.prototype.Apply=function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit},t.Style.Stroke=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o),this.ConcatFont()}e.prototype=Object.create(null),e.prototype.constructor=e,t.Style.TEXT_ALIGN={START:"start",END:"end",CENTER:"center",LEFT:"left",RIGHT:"right"},t.Style.TEXT_BASELINE={ALPHABETIC:"alphabetic",TOP:"top",HANGING:"hanging",MIDDLE:"middle",IDEOGRAPHIC:"ideographic",BOTTOM:"bottom"},e.prototype.fillColor="#444499",e.prototype.strokeColor="#00FFFF",e.prototype.fontSize=22,e.prototype.font=null,e.prototype.fontFamily="Arial",e.prototype.align=t.Style.TEXT_ALIGN.LEFT,e.prototype.baseline=t.Style.TEXT_BASELINE.TOP,e.prototype.applied=!0,e.prototype.lineWidth=.5,e.prototype.Apply=function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth},e.prototype.ConcatFont=function(){this.font=this.fontSize+"px "+this.fontFamily},t.Style.Text=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#000000",e.prototype.size=1,t.Style.Pixel=e}},function(t,e){t.exports=function(t){"use strict";t.Style.CreateAll=function(e){return{fill:new t.Style.Fill(e?e.fill:null),stroke:new t.Style.Stroke(e?e.stroke:null),shadow:new t.Style.Shadow(e?e.shadow:null),text:new t.Style.Text(e?e.text:null),pixel:new t.Style.Pixel(e?e.pixel:null)}},t.Style.CreateFSSa=function(e){return{fill:new t.Style.Fill(e?e.fill:null),stroke:new t.Style.Stroke(e?e.stroke:null),shadow:new t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateSSa=function(e){return{stroke:new t.Style.Stroke(e?e.stroke:null),shadow:new t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateFSa=function(e){return{fill:new t.Style.Fill(e?e.fill:null),shadow:new t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateSaT=function(e){return{shadow:new t.Style.Shadow(e?e.shadow:null),text:new t.Style.Text(e?e.text:null)}},t.Style.CreateP=function(e){return{pixel:new t.Style.Pixel(e?e.pixel:null)}},t.Style.GCO=Object.create(null),t.Style.GCO.SOURCE_OVER=t.Style.GCO.DEFAULT="source-over",t.Style.GCO.SOURCE_IN="source-in",t.Style.GCO.SOURCE_OUT="source-out",t.Style.GCO.SOURCE_ATOP="source-atop",t.Style.GCO.DESTINATION_OVER="destination-over",t.Style.GCO.DESTINATION_IN="destination-in",t.Style.GCO.DESTINATION_OUT="destination-out",t.Style.GCO.DESTINATION_ATOP="destination-atop",t.Style.GCO.LIGHTER="lighter",t.Style.GCO.COPY="copy",t.Style.GCO.XOR="xor",t.Style.GCO.MULTIPLY="multiply",t.Style.GCO.OVERLAY="overlay",t.Style.GCO.DARKEN="darken",t.Style.GCO.LIGHTEN="lighten",t.Style.GCO.COLOR_DODGE="color-dodge",t.Style.GCO.COLOR_BURN="color-burn",t.Style.GCO.HARD_LIGHT="hard-light",t.Style.GCO.SOFT_LIGHT="soft-light",t.Style.GCO.DIFFERENCE="difference",t.Style.GCO.EXCLUSION="exclusion",t.Style.GCO.HUE="hue",t.Style.GCO.SATURATION="saturation",t.Style.GCO.COLOR="color",t.Style.GCO.LUMINOSITY="luminosity"}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n,i,s){if(!(this instanceof e))return new e(t,r,n,i,s);this.image=t,this.id=null!=o?o:t.id,this.w=null!=r?r:t.naturalWidth,this.h=null!=n?n:t.naturalHeight,this.fw=null!=i?i:t.naturalWidth,this.fh=null!=s?s:t.naturalHeight}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.image=null,e.prototype.id=null,e.prototype.w=0,e.prototype.h=0,e.prototype.fw=0,e.prototype.fh=0,e.prototype.uniformId=0,t.Texture.BasicTexture=e,t.BasicTexture=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.id=o.id,this.basicTexture=o,this.data=r,this.frameCache=new t.Utils.Cache(t.Animator.Frame)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.id=null,e.prototype.basicTexture=null,e.prototype.data=null,e.prototype.frameCache=null,e.prototype.GenerateFrames=function(){for(var e,o,r,n=this.data,i=n.frames,s=n.meta.frameTags,a=0,l=i.length;a<l;++a)e=i[a],o=e.frame,r=s[a],this.frameCache.Store(new t.Animator.Frame(o.x,o.y,o.w,o.h,e.duration,r?r.name:null))},e.prototype.GetFrameById=function(t){return this.frameCache.GetById(t)},t.Texture.Spritesheet=e,t.Spritesheet=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r){if(!(this instanceof e))return new e(t,o,r);if("function"!=typeof t)throw new Error("Ticker: An onProcess function is required!");this.SetDesiredRate(o),this.onProcess=t,void 0!=r&&!1!==r||this.StartAF()}e.prototype=Object.create(null),e.prototype.constructor=e,e.LOG=!0,e.GLOBAL_CSS="background-color:black;font-family:Arial;font-size:16px;",e.Log=function(){!1!==e.LOG&&console.log.apply(null,arguments)},e.prototype.intervalId=null,e.prototype.afId=null,e.prototype.delta=0,e.prototype.then=0,e.prototype.now=0,e.prototype.desiredRate=0,e.prototype.supplyDelta=!0,e.prototype.Process=function(){this.onProcess(this.ComputeDelta())},e.prototype.ProcessAF=function(){this.ComputeDelta(),this.onProcess(this.delta),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))},e.prototype.ComputeDelta=function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta},e.prototype.GetTPS=function(){return t.Math.PR(1/this.delta*1e3,2)},e.prototype.SetDesiredRate=function(t){this.desiredRate=void 0===t?16.66:1e3/t},e.prototype.Start=function(t){if(null!==this.afId)return e.Log("%cTicker: RAF is running!","color:red;".concat(e.GLOBAL_CSS)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),e.Log("%cTicker: Starting interval!","color:#0F0;".concat(e.GLOBAL_CSS))):e.Log("%cTicker: Interval already running!","color:#F00;".concat(e.GLOBAL_CSS)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),e.Log("%cTicker: Starting interval!","color:#0F0;".concat(e.GLOBAL_CSS)))},e.prototype.StartAF=function(t){if(null!==this.intervalId)return e.Log("%cTicker: Interval is running!","color:#F00;".concat(e.GLOBAL_CSS)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),e.Log("%cTicker: Starting RAF!","color:#0F0;".concat(e.GLOBAL_CSS))):e.Log("%cTicker: RAF already running!","color:#F00;".concat(e.GLOBAL_CSS)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),e.Log("%cTicker: Starting RAF!","color:#0F0;".concat(e.GLOBAL_CSS)))},e.prototype.Stop=function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,e.Log("%cTicker: Stopping interval!","color:cyan;".concat(e.GLOBAL_CSS))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,e.Log("%cTicker: Stopping RAF!","color:cyan;".concat(e.GLOBAL_CSS)))},t.Time.Ticker=e,t.Ticker=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n){if(!(this instanceof e))return new e(o,r,n);this.element=o,this.position=new t.Vector2D,this.scale=new t.Vector2D(1,1),this.offset=new t.Vector2D(r,n),this.eventData={position:this.position,native:null},this.element.addEventListener("mousemove",this.OnMove.bind(this)),this.element.addEventListener("mousedown",this.OnDown.bind(this)),this.element.addEventListener("mouseup",this.OnUp.bind(this)),this.element.addEventListener("mouseleave",this.OnLeave.bind(this)),this.element.addEventListener("wheel",this.OnWheel.bind(this),{passive:!0}),this.onMove=new t.Event.LocalEvent,this.onDown=new t.Event.LocalEvent,this.onUp=new t.Event.LocalEvent,this.onLeave=new t.Event.LocalEvent,this.onWheel=new t.Event.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.eventData=null,e.prototype.OnMove=function(t){t.preventDefault(),t.stopPropagation();var e=this.element,o=this.position;o.Set(t.pageX,t.pageY),o.Subtract(e.offsetLeft,e.offsetTop),o.SubtractV(this.offset),o.DivideV(this.scale),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData)},e.prototype.OnDown=function(t){t.stopPropagation(),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)},e.prototype.OnUp=function(t){t.stopPropagation(),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)},e.prototype.OnLeave=function(t){t.preventDefault(),t.stopPropagation(),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)},e.prototype.OnWheel=function(t){this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y}}),t.Input.Mouse=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);this.element=o,this.element.setAttribute("tabindex","1"),this.element.focus(),this.element.addEventListener("keydown",this.OnKeyDown.bind(this)),this.element.addEventListener("keyup",this.OnKeyUp.bind(this)),this.onDown=new t.Event.LocalEvent,this.onUp=new t.Event.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.OnKeyDown=function(t){t.preventDefault(),t.stopPropagation(),this.onDown.Dispatch(this.element,t)},e.prototype.OnKeyUp=function(t){t.preventDefault(),t.stopPropagation(),this.onUp.Dispatch(this.element,t)},t.Input.Keyboard=e}},function(t,e){t.exports=function(t){"use strict";function e(){throw new Error("Cannot be instantiated")}e.Draw={},e.Draw.AABB2D=function(t,e,o){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.1,t.strokeStyle="rgba(100, 0, 100, 1)",t.fillStyle="rgba(0, 100, 0, 1)",o&&o.strokeStyle&&(t.strokeStyle=o.strokeStyle),o&&o.fillStyle&&(t.fillStyle=o.fillStyle),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),o&&o.noStroke||t.stroke(),o&&o.noFill||t.fill()},t.Debug=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i){if(!(this instanceof e))return new e(r,n,i);o.call(this,r,n),this.style=new t.Style.CreateP(i),this.colorObj=new t.Color}var o=t.Math.Vector2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.colorObj=null,e.prototype.style=null,e.prototype.programController=null,e.prototype.bufferData=null,e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())},e.prototype.GetBufferData=function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData;return t[0]=this.x,t[1]=this.y,t[2]=this.colorObj.r,t[3]=this.colorObj.g,t[4]=this.colorObj.b,t[5]=this.colorObj.a,t[6]=this.style.pixel.size,t},e.prototype.UpdateInBuffer=function(t,e){t[e]=this.x,t[e+1]=this.y,t[e+2]=this.colorObj.r,t[e+3]=this.colorObj.g,t[e+4]=this.colorObj.b,t[e+5]=this.colorObj.a,t[e+6]=this.style.pixel.size},t.Path.Pixel=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i,s,a){if(!(this instanceof e))return new e(r,n,i,s,a);o.call(this,r,n,i,s),this.style=t.Style.CreateSSa(a)}var o=t.Geom.Line2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.style=null,e.prototype.programController=null,e.prototype.Draw=function(t){var e=this.s,o=this.e,r=this.style,n=r.stroke,i=r.shadow;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,o.y),t.closePath(),!0===i.applied&&i.Apply(t),!0===n.applied&&(n.Apply(t),t.stroke())},e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.s,this.e)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize())},t.Path.Line2D=e,t.Path.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i,s,a){if(!(this instanceof e))return new e(r,n,i,s,a);o.call(this,r,n,i,s),this.style=t.Style.CreateFSSa(a)}var o=t.Geom.AABB2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Draw=function(t){var e=this.tl,o=this.br,r=this.style,n=r.fill,i=r.stroke,s=r.shadow;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,e.y),t.lineTo(o.x,o.y),t.lineTo(e.x,o.y),t.closePath(),!0===s.applied&&s.Apply(t),!0===n.applied&&(n.Apply(t),t.fill()),!0===i.applied&&(i.Apply(t),t.stroke())},e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2)},t.Path.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n){if(!(this instanceof e))return new e(r,n);o.call(this,r),this.style=t.Style.CreateFSSa(n)}var o=t.Geom.Polygon2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Draw=function(t){var e=this.style,o=e.fill,r=e.stroke,n=e.shadow,i=this.vertices,s=i[0];t.beginPath(),t.moveTo(s.x,s.y);for(var a=1,l=i.length;a<l;++a)s=i[a],t.lineTo(s.x,s.y);t.closePath(),!0===n.applied&&n.Apply(t),!0===o.applied&&(o.Apply(t),t.fill()),!0===r.applied&&(r.Apply(t),t.stroke())},t.Path.Polygon2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i,s){if(!(this instanceof e))return new e(r,n,i,s);o.call(this,r,n,i),this.style=t.Style.CreateFSSa(s)}var o=t.Geom.Circle;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Draw=function(e){var o=this.center,r=this.style,n=r.fill,i=r.stroke,s=r.shadow;e.beginPath(),e.arc(o.x,o.y,this.radius,0,t.Math.PII,!1),e.closePath(),!0===s.applied&&s.Apply(e),!0===n.applied&&(n.Apply(e),e.fill()),!0===i.applied&&(i.Apply(e),e.stroke())},e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.center.x,this.center.y,this.radius)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2)},t.Path.Circle=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i,s,a){if(!(this instanceof e))return new e(r,n,i,s,a);if(o.call(this,n,i),"string"==typeof r&&(r=document.getElementById(r)),this.canvas=r,this.w=r.width,this.h=r.height,!0===a){if(this.gl=r.getContext("webgl"),null==this.gl&&(this.gl=r.getContext("experimental-webgl")),null==this.gl)throw new Error("WebGL is not supported!");this.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),this.usingWebGL=!0,this.scale.Set(2/this.w,-2/this.h),this.position.Add(-1,1),this.position.Add(n*this.scale.x,i*this.scale.y),this.UpdateTransform(),this.ticker=new t.Time.Ticker(this.GLProcess.bind(this),60,s),this.GLConfig(this.gl)}else this.rc=r.getContext("2d"),this.ticker=new t.Time.Ticker(this.Process.bind(this),60,s);this.onProcess=new t.Event.LocalEvent,this.mouse=new t.Input.Mouse(r,n,i),this.keyboard=new t.Input.Keyboard(r)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.backgroundColor="rgba(10,20,30,1)",e.prototype.clear=!0,e.prototype.fill=!0,e.prototype.usingWebGL=!1,e.prototype.PreDraw=function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation="source-over",!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)},e.prototype.GLConfig=function(t){t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},e.prototype.GLPreDraw=function(t){t.clear(t.COLOR_BUFFER_BIT)},e.prototype.GLPostDraw=function(t){t.flush()},e.prototype.Process=function(t){this.Draw(this.rc),this.onProcess.Dispatch(this,t)},e.prototype.GLProcess=function(t){this.GLDraw(this.gl),this.GLPostDraw(this.gl),this.onProcess.Dispatch(this,t)},t.Entity.Stage2D=e,t.Stage2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i){if(!(this instanceof e))return new e(r,n,i);o.call(this,r,n),this.anchor=new t.Vector2D,this.SetPath(i)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.path=null,e.prototype.anchor=null,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(this.PreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t);var e=this.path;e&&e.Draw&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Draw(t)),this.children.length>0&&this.DrawChildren(t)}},e.prototype.GLDraw=function(t){if(this.GLPreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.path;e&&e.GLDraw&&!0===this.display&&e.GLDraw(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t))}},e.prototype.GetBufferData=function(){this.UpdateTransform();var t=this.transform.worldTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e},e.prototype.UpdateInBuffer=function(){this.UpdateTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.parent.childDataBuffer,o=this.bufferStartIndex;e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3],e[o+4]=t[4],e[o+5]=t[5],e[o+6]=t[6],e[o+7]=t[7],e[o+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,o+9)},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return this.path.IntersectsPoint(e)},e.prototype.SetPath=function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)},t.Entity.Graphic2D=e,t.Graphic2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.transform=new t.Math.Basetransform2D(o,r),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=new t.Math.Basetransform2D,e.prototype.parent=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){return this.transform.worldTransform.Copy()},e.prototype.ComputeBounds=function(e){var o=e&&e.x?e.x:0,r=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=new t.Geom.AABB2D(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},e.prototype.Destroy=function(){null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.fickleSplice(e))}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.unshift(t.fickleSplice(e))}},Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h},set:function(t){this.h=t}}),t.Entity.Plain2D=e,t.Plain2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,n){if(!(this instanceof e))return new e(t,r,n);o.call(this,t,r),void 0!==n&&(void 0!==n.w&&void 0!==n.h?(this.w=n.w,this.h=n.h):void 0!==n.GetLength?this.w=this.h=n.GetLength():void 0!==n.diameter?this.w=this.h=n.diameter:void 0!==n.aabb&&(this.w=n.aabb.w,this.h=n.aabb.h),this.path=n)}var o=t.Entity.Plain2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.path=null,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t);var e=this.path;e&&e.Draw&&!0===this.display&&e.Draw(t)}},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.DivideV(this.scale),this.path.IntersectsPoint(e)},t.Entity.Plaingraphic2D=e,t.Plaingraphic2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i){if(!(this instanceof e))return new e(r,n,i);o.call(this,r,n),this.anchor=new t.Vector2D(0,0),this.clip=new t.Geom.AABB2D,this.shape=new t.Geom.AABB2D,null==i&&(i=e.DEFAULT_TEXTURE),this.SetTexture(i)}var o=t.Entity.Plain2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=null,e.BUILD_DEFAULT_TEXTURE=function(){e.DEFAULT_TEXTURE=new t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=new t.Path.Polygon2D;return e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(0,64)),e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#3399FF",e.style.stroke.lineWidth=3,new t.Graphic2D(0,0,e)})),"DEFAULT_PLAINSPRITE_TEXTURE",64,64,64,64),delete e.BUILD_DEFAULT_TEXTURE},e.prototype.shape=null,e.prototype.clip=null,e.prototype.texture=null,e.prototype.anchor=null,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display)){var e=this.clip,o=e.tl,r=e.br,n=this.w,i=this.h,s=this.anchor;t.drawImage(this.texture.image,o.x,o.y,r.x,r.y,-n*s.x,-i*s.y,n,i)}},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.w*this.anchor.x,this.h*this.anchor.y),this.shape.IntersectsPoint(e)},e.prototype.SetTexture=function(t){this.texture=t,this.w=t.w,this.h=t.h,this.clip.Set(0,0,this.w,this.h),this.shape.SetC(this.clip)},t.Entity.Plainsprite=e,t.Plainsprite=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i){if(!(this instanceof e))return new e(r,n);o.call(this,r,n),void 0!==i&&(this.text=i),this.style=t.Style.CreateSaT()}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.text="",e.prototype.maxWidth=void 0,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.Draw=function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.DrawChildren(t)}},e.prototype.IntersectsPoint=function(){return!1},t.Entity.Text=e,t.Text=e}},function(t,e){t.exports=function(t){"use strict";function e(r,n,i,s){if(!(this instanceof e))return new e(r,n,i);o.call(this,r,n),this.anchor=new t.Vector2D(0,0),this.clip=new t.Geom.AABB2D,this.shape=new t.Geom.AABB2D,this.textureTransformation=new t.Math.Matrix2D,this.textureTranslation=new t.Math.Matrix2D,this.originalShape=new t.Geom.AABB2D,this.tint=new t.Color(1,1,1,1),i instanceof t.GLTextureProgramController?(this.programController=i,null!=s?this.SetTexture(i["originalTexture"+s]):this.SetTexture(i.originalTexture0)):null==i?this.SetTexture(e.DEFAULT_TEXTURE):this.SetTexture(i)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=null,e.BUILD_DEFAULT_TEXTURE=function(){e.DEFAULT_TEXTURE=new t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=new t.Path.Polygon2D;return e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(0,64)),e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#00FFFF",e.style.stroke.lineWidth=3,new t.Graphic2D(0,0,e)})),"DEFAULT_SPRITE_TEXTURE",64,64,64,64),delete e.BUILD_DEFAULT_TEXTURE},e.prototype.shape=null,e.prototype.originalShape=null,e.prototype.clip=null,e.prototype.texture=null,e.prototype.anchor=null,e.prototype.tint=null,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.interactive=!0,e.prototype.programController=null,e.prototype.textureTransformation=null,e.prototype.textureTranslation=null,e.prototype.animationController=null,e.prototype.Draw=function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display){var e=this.clip,o=e.tl,r=e.br,n=this.w,i=this.h,s=this.anchor;t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,o.x,o.y,r.x,r.y,-n*s.x,-i*s.y,n,i)}this.children.length>0&&this.DrawChildren(t)}},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.programController.Execute(this.transform.worldTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))},e.prototype.GetBufferData=function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),o=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var r=this.bufferData;return r.length=0,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=e[0],r[10]=e[1],r[11]=e[2],r[12]=e[3],r[13]=e[4],r[14]=e[5],r[15]=e[6],r[16]=e[7],r[17]=e[8],r[18]=o[0],r[19]=o[1],r[20]=o[2],r[21]=o[3],r[22]=o[4],r[23]=o[5],r[24]=o[6],r[25]=o[7],r[26]=o[8],r},e.prototype.UpdateInBuffer=function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),o=this.textureTransformation.AsArray(!0),r=this.parent.childDataBuffer,n=this.bufferStartIndex;r[n]=t[0],r[n+1]=t[1],r[n+2]=t[2],r[n+3]=t[3],r[n+4]=t[4],r[n+5]=t[5],r[n+6]=t[6],r[n+7]=t[7],r[n+8]=t[8],r[n+9]=e[0],r[n+10]=e[1],r[n+11]=e[2],r[n+12]=e[3],r[n+13]=e[4],r[n+14]=e[5],r[n+15]=e[6],r[n+16]=e[7],r[n+17]=e[8],r[n+18]=o[0],r[n+19]=o[1],r[n+20]=o[2],r[n+21]=o[3],r[n+22]=o[4],r[n+23]=o[5],r[n+24]=o[6],r[n+25]=o[7],r[n+26]=o[8]},e.prototype.UpdateTextureTransform=function(){var t=this.w/this.texture.fw,e=this.h/this.texture.fh;this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(t*this.clip.tl.x/this.w,e*this.clip.tl.y/this.h)},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint(e)},e.prototype.UpdateShape=function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)},e.prototype.SetTexture=function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.clip)},e.prototype.ClipReconfigure=function(t,e,o,r){var n=o/this.texture.fw,i=r/this.texture.fh,s=this.width,a=this.height;this.clip.Set(t,e,o,r),this.w=o,this.h=r,0!==s&&0!==a&&(this.width=s,this.height=a),this.textureTranslation.SetTransform(-o*this.anchor.x,-r*this.anchor.y,n,i),this.textureTransformation.SetTransform(n*this.clip.tl.x/o,i*this.clip.tl.y/r,n,i)},e.prototype.CreateAnimation=function(e){null===this.animationController&&(this.animationController=new t.Animator.Controller(this));var o=this.animationController.CreateAnimation(e.id,e.rate);if(null!=e.spritesheet)for(var r=0;r<e.frames.length;++r)o.AddFrame(e.spritesheet.GetFrameById(e.frames[r]));return o},Object.defineProperty(e.prototype,"width",{get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}),t.Entity.Sprite=e,t.Sprite=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this),r&&(this.id=parseInt(r.id),this.cx=parseInt(r.x),this.cy=parseInt(r.y),this.w=parseInt(r.width),this.h=parseInt(r.height),this.xoffset=parseInt(r.xoffset),this.yoffset=parseInt(r.yoffset),this.xadvance=parseInt(r.xadvance),this.kernings=[],this.translation=new t.Matrix2D,this.transformation=new t.Matrix2D)}var o=t.Entity.CoreEntity2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.id=0,e.prototype.xoffset=0,e.prototype.yoffset=0,e.prototype.xadvance=0,e.prototype.yadvance=0,e.prototype.kernings=null,e.prototype.translation=null,e.prototype.transformation=null,e.prototype.ApplyKernings=function(t){for(var e,o=0,r=t.length;o<r;++o)e=t[o].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))},e.prototype.Crunch=function(t){if(this.position.Set(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings.length>0&&this.kernings.length>0))for(var e=0,o=this.kernings,r=o.length;e<r;e+=3)if(o[e+1]===t.id){this.x+=o[e+2];break}this.position.Add(this.xoffset,this.yoffset)},e.prototype.UpdateMatrices=function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,o=this.height/t.fh;this.UpdateTransform(),this.translation.SetTransform(0,0,e,o),this.transformation.SetTransform(e*this.cx/this.width,o*this.cy/this.height,e,o)}},t.Entity.Char=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,n,i,s){if(!(this instanceof e))return new e(t,r,n,i,s);o.call(this,t,r,n),this.fontData=i,this.lineHeight=i.font.common.attributes.lineHeight,null!=s&&(this.text=s),this.chars=[],this.ComputeText()}var o=t.Entity.Sprite,r=t.Entity.Char;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.maxWidth=1024,e.prototype.fontData=null,e.prototype.text="",e.prototype.chars=null,e.prototype.lineHeight=0,e.prototype.Draw=function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.DrawText(t)),this.children.length>0&&this.DrawChildren(t))},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.GLDrawText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))},e.prototype.DrawText=function(t){for(var e,o=0,r=this.chars,n=r.length;o<n;++o)e=r[o],t.drawImage(this.texture.image,e.cx,e.cy,e.width,e.height,e.position.x,e.position.y,e.width,e.height)},e.prototype.GLDrawText=function(){for(var t,e=0,o=this.chars,r=o.length;e<r;++e)t=o[e],this.programController.Execute(t.transform.worldTransform.AsArray(!0),t.translation.AsArray(!0),t.transformation.AsArray(!0),this.tint.channel,0)},e.prototype.GetBufferData=function(){},e.prototype.UpdateInBuffer=function(){},e.prototype.ComputeText=function(){this.UpdateTransform(),this.chars.length=0;for(var t,e,o=this.fontData.font.kernings.kerning,n=0,i=0,s=this.chars,a=this.text,l=a.length;i<l;++i)e=s[i-1],t=new r(this.GetCharData(a.charCodeAt(i))),t.ApplyKernings(o),t.Crunch(e),t.position.x+t.width>this.maxWidth&&(t.position.Set(0),t.yadvance=this.lineHeight*++n,t.position.Add(t.xoffset,t.yoffset+t.yadvance)),t.parent=this,t.UpdateMatrices(),s.push(t)},e.prototype.GetCharData=function(t){for(var e=0,o=this.fontData.font.chars.char,r=o.length;e<r;++e)if(parseInt(o[e].attributes.id)===t)return o[e].attributes},t.Entity.BitmapText=e,t.BitmapText=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,n,i,s){if(!(this instanceof e))return new e(t,o,r,n,i,s);this.rate=i,this.timer=i,this.x=t,this.y=o,this.w=r,this.h=n,null!=s&&(this.id=s)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.id=null,e.prototype.x=0,e.prototype.y=0,e.prototype.w=0,e.prototype.h=0,e.prototype.rate=0,e.prototype.timer=0,e.prototype.nextFrameIndex=null,e.prototype.Process=function(){return this.timer--<=0&&(this.Reset(),!0)},e.prototype.Apply=function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)},e.prototype.Reset=function(){this.timer=this.rate},t.Animator.Frame=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n){if(!(this instanceof e))return new e(o,r,n);this.frames=[],this.controller=o,this.sprite=o.sprite,this.id=r,this.onEnd=new t.Event.LocalEvent,this.onStop=new t.Event.LocalEvent,this.onStart=new t.Event.LocalEvent,null!=n&&(this.rate=n)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.currentFrame=0,e.prototype.currentFrameIndex=0,e.prototype.playing=!1,e.prototype.id=null,e.prototype.rate=60,e.prototype.timer=0,e.prototype.reverse=!1,e.prototype.sprite=null,e.prototype.overrideFrameRate=!1,e.prototype.CreateFrame=function(e,o,r,n,i){i=null==i?this.rate:i,this.frames.push(new t.Animator.Frame(e,o,r,n,i))},e.prototype.AddFrame=function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)},e.prototype.GenerateFrames=function(t,e,o,r,n,i){i=null==i?{}:i;for(var s,a=0,l=o/r;a<n;++a)s=i[a],this.CreateFrame(a%l*t,(a/l|0)*e,t,e,s)},e.prototype.SetFrame=function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))},e.prototype.SetFrameById=function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)},e.prototype.GetFrameById=function(t,e){for(var o=0,r=this.frames;o<r.length;++o)if(r[o].id===t)return!0===e?o:r[o]},e.prototype.Start=function(){this.playing=!0,this.onStart.Dispatch()},e.prototype.Stop=function(){this.playing=!1,this.onStop.Dispatch()},e.prototype.Process=function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())},e.prototype.NextFrame=function(){var t=this.frames,e=t.length,o=!1;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=e?(this.currentFrameIndex=0,o=!0):this.currentFrameIndex<0&&(this.currentFrameIndex=e-1,o=!0),this.currentFrame=t[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===o&&this.onEnd.Dispatch()},e.prototype.Clear=function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate},e.prototype.Restart=function(t){this.SetFrame(t),this.ResetAllFrames(),this.Start(),this.timer=this.rate},e.prototype.Reset=function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1},e.prototype.ResetAllFrames=function(){for(var t,e=0,o=this.frames,r=o.length;e<r;++e)t=o[e],t.Reset()},t.Animator.Animation=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.animations=[],null!=t&&(this.sprite=t)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.currentAnimation=null,e.prototype.sprite=null,e.prototype.CreateAnimation=function(e,o){var r=new t.Animator.Animation(this,e,o);return this.animations.push(r),r},e.prototype.AddAnimation=function(t){t.controller=this,this.animations.push(t)},e.prototype.GetAnimationById=function(t){for(var e,o=0,r=this.animations,n=r.length;o<n;++o)if((e=r[o])&&e.id===t)return e;return null},e.prototype.PlayAnimation=function(t,e){var o=this.GetAnimationById(t);null!==o&&(this.currentAnimation=o,o.Restart(e))},e.prototype.StopCurrentAnimation=function(){null!==this.currentAnimation&&this.currentAnimation.Stop()},e.prototype.Process=function(){var t=this.currentAnimation;null!==t&&t.Process()},t.Animator.Controller=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,n){if(!(this instanceof e))return new e(o,r,n);this.imageCache=new t.Utils.Cache(Image),this.basicTextureCache=new t.Utils.Cache(t.Texture.BasicTexture),this.onImageLoaded=new t.Event.LocalEvent,this.onComplete=new t.Event.LocalEvent,null!=n&&this.onComplete.Add(n,this),null!=o&&this.Load(o,r)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.imageCache=null,e.prototype.basicTextureCache=null,e.prototype.onImageLoaded=null,e.prototype.onComplete=null,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.createTextures=!1,e.prototype.Load=function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];if(null!=e){var o=new Image;o.onload=this.OnLoad.bind(this),o.onerror=this.OnError.bind(this),o.src=e.src,o.id=e.id,o.data=Object.create(null),o.data.w=e.w,o.data.h=e.h,o.data.fw=e.fw,o.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})},e.prototype.OnLoad=function(e){var o=e.currentTarget;delete o.onload,delete o.onerror,this.imageCache.StoreSafe(o),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new t.Texture.BasicTexture(o,null,o.data.w,o.data.h,o.data.fw,o.data.fh)),this.onImageLoaded.Dispatch(o,{count:this.count}),this.Haul(++this.count)},e.prototype.OnError=function(){throw new Error("Request failed")},e.prototype.GetImage=function(t){return this.imageCache.GetById(t)},e.prototype.GetBasicTexture=function(t){return this.basicTextureCache.GetById(t)},t.Load.ImageLoader=e,t.ImageLoader=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.XHRcache=new t.Utils.Cache(XMLHttpRequest),this.dataCache=new t.Utils.Cache,this.onXHRLoaded=new t.Event.LocalEvent,this.onComplete=new t.Event.LocalEvent,null!=r&&this.onComplete.Add(r,this),null!=o&&this.Load(o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.XHRcache=null,e.prototype.dataCache=null,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.onXHRLoaded=null,e.prototype.onComplete=null,e.prototype.Load=function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];if(null!=e){var o=new XMLHttpRequest;switch(e.type){case"json":o.onload=this.OnLoadJSON.bind(this);break;default:o.onload=this.OnLoadXML.bind(this)}o.onerror=this.OnError.bind(this),null!=o.data?o.data.id=e.id:o.data={id:e.id},o.open("GET",e.src),o.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})},e.prototype.OnLoadXML=function(e){var o=e.currentTarget;200===o.status&&4===o.readyState&&(o.onload=null,o.onerror=null,this.XHRcache.StoreSafe(o),this.dataCache.Store({id:o.data.id,data:t.Utils.XMLToJSON(o.responseText,!0)}),this.onXHRLoaded.Dispatch(o,{count:this.count}),this.Haul(++this.count))},e.prototype.OnLoadJSON=function(t){var e=t.currentTarget;200===e.status&&4===e.readyState&&(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count))},e.prototype.OnError=function(){throw new Error("Request failed")},e.prototype.GetXHR=function(t){return this.XHRcache.GetById(t)},e.prototype.GetData=function(t){return this.dataCache.GetById(t).data},t.Load.XHRLoader=e,t.XHRLoader=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o);this.spritesheetCache=new t.Utils.Cache(t.Texture.Spritesheet),this.xhrLoader=new t.Load.XHRLoader,this.imageLoader=new t.Load.ImageLoader,this.onComplete=new t.Event.LocalEvent,this.onSpritesheetLoaded=new t.Event.LocalEvent,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=r&&this.onComplete.Add(r,this),null!=o&&this.Load(o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.xhrLoader=null,e.prototype.imageLoader=null,e.prototype.spritesheetCache=null,e.prototype.onSpritesheetLoaded=null,e.prototype.onComplete=null,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.pairCount=0,e.prototype.tempBasicTexture=null,e.prototype.tempData=null,e.prototype.Load=function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))},e.prototype.OnPartLoaded=function(){if(2==++this.pairCount){var e=this.tempData.meta.size;this.tempBasicTexture.fw=e.w,this.tempBasicTexture.fh=e.h;var o=new t.Texture.Spritesheet(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(o),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(o,{count:this.count}),this.Haul(++this.count)}},e.prototype.OnPartXHRLoaded=function(t){this.tempData=this.xhrLoader.GetData(t.target.data.id),this.OnPartLoaded()},e.prototype.OnPartImageLoaded=function(t){this.tempBasicTexture=this.imageLoader.GetBasicTexture(t.target.id),this.OnPartLoaded()},e.prototype.GetSpritesheet=function(t){return this.spritesheetCache.GetById(t)},t.Load.SpritesheetLoader=e,t.SpritesheetLoader=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);this.gl=t,this.data=Object.create(null),null!=t&&null!=o&&this.Init(o.v,o.f)}e.prototype=Object.create(null),e.prototype.constructor=e,e.LAST_USED_CONTROLLER=null,e.prototype.program=null,e.prototype.gl=null,e.prototype.attributes=null,e.prototype.uniforms=null,e.prototype.data=null,e.prototype.Init=function(t,e){var o=this.gl,r=this.CreateShader(t,o.VERTEX_SHADER),n=this.CreateShader(e,o.FRAGMENT_SHADER),i=this.program=o.createProgram();if(o.attachShader(i,r),o.attachShader(i,n),o.linkProgram(i),!o.getProgramParameter(i,o.LINK_STATUS)){var s=o.getProgramInfoLog(i);throw new Error("Program link failed:"+s)}o.detachShader(i,r),o.detachShader(i,n),o.deleteShader(r),o.deleteShader(n),this.attributes={},this.uniforms={}},e.prototype.CreateShader=function(t,e){var o=this.gl,r=o.createShader(e);if(o.shaderSource(r,t),o.compileShader(r),!o.getShaderParameter(r,o.COMPILE_STATUS)){var n=o.getShaderInfoLog(r);throw new Error("Shader compilation failed:"+n)}return r},e.prototype.AssignAttribute=function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)},e.prototype.AssignUniform=function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)},e.prototype.Execute=function(){},t.Controller.GLProgramController=e,t.GLProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.LINE2D),this.Initialise()}var o=t.Controller.GLProgramController;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.essenceBuffer=null,e.prototype.vertices=null,e.prototype.color=null,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new t.Color,e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")},e.prototype.Execute=function(t,e,r){var n=this.gl,i=this.attributes,s=this.uniforms,a=this.vertices,l=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=r.x,a[3]=r.y,this!==o.LAST_USED_CONTROLLER&&(n.useProgram(this.program),o.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,a),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),n.uniformMatrix3fv(s.uProjection,!1,t),n.uniform4f(s.uColor,l[0],l[1],l[2],l[3]),n.drawArrays(n.LINES,0,2)},t.Controller.GLLine2DProgramController=e,t.GLLine2DProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.RECTANGLE),this.Initialise()}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.geometricBuffer=null,e.prototype.vertices=null,e.prototype.fillColor=null,e.prototype.outlineColor=null,e.prototype.outline=5,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array(t.Math.TriRectArray(0,0,1,1)),this.fillColor=new t.Color,this.outlineColor=new t.Color,e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")},e.prototype.Execute=function(t,e,n,i,s){var a=this.gl,l=this.attributes,h=this.uniforms,p=this.vertices,u=this.fillColor.channel,c=this.outlineColor.channel;r(e,n,i,s,p),this!==o.LAST_USED_CONTROLLER&&(a.useProgram(this.program),o.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,p),a.enableVertexAttribArray(l.aPosition),a.vertexAttribPointer(l.aPosition,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(h.uProjection,!1,t),a.uniform4f(h.uFillColor,u[0],u[1],u[2],u[3]),a.uniform4f(h.uOutlineColor,c[0],c[1],c[2],c[3]),a.uniform1f(h.uOutline,this.outline),a.uniform2f(h.uSize,i,s),a.drawArrays(a.TRIANGLE_STRIP,0,6)},t.Controller.GLRectangleProgramController=e,t.GLRectangleProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.CIRCLE),this.Initialise()}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.essenceBuffer=null,e.prototype.vertices=null,e.prototype.fillColor=null,e.prototype.outlineColor=null,e.prototype.outline=5,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array(t.Math.TriRectArray(0,0,1,1)),this.fillColor=new t.Color,this.outlineColor=new t.Color,e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")},e.prototype.Execute=function(t,e,n,i){var s=this.gl,a=this.attributes,l=this.uniforms,h=this.vertices,p=this.fillColor.channel,u=this.outlineColor.channel;r(e-i,n-i,2*i,2*i,h),this!==o.LAST_USED_CONTROLLER&&(s.useProgram(this.program),o.LAST_USED_CONTROLLER=this),s.bindBuffer(s.ARRAY_BUFFER,this.essenceBuffer),s.bufferSubData(s.ARRAY_BUFFER,0,h),s.enableVertexAttribArray(a.aPosition),s.vertexAttribPointer(a.aPosition,2,s.FLOAT,!1,0,0),s.uniformMatrix3fv(l.uProjection,!1,t),s.uniform4f(l.uFillColor,p[0],p[1],p[2],p[3]),s.uniform4f(l.uOutlineColor,u[0],u[1],u[2],u[3]),s.uniform1f(l.uOutline,this.outline),s.uniform1f(l.uRadius,i),s.drawArrays(s.TRIANGLE_STRIP,0,6)},t.Controller.GLCircleProgramController=e,t.GLCircleProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.TEXTURE_2D),this.Initialise()}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.originalTexture0=null,e.prototype.boundTexture0=null,e.prototype.essenceBuffer0=null,e.prototype.originalTexture1=null,e.prototype.boundTexture1=null,e.prototype.essenceBuffer1=null,e.prototype.originalTexture2=null,e.prototype.boundTexture2=null,e.prototype.essenceBuffer2=null,e.prototype.originalTexture3=null,e.prototype.boundTexture3=null,e.prototype.essenceBuffer3=null,e.prototype.lastUsedUnit=0,e.prototype.Initialise=function(){this.AssignAttribute("aPosition0"),this.AssignAttribute("aTexCoord0"),this.AssignAttribute("aPosition1"),this.AssignAttribute("aTexCoord1"),this.AssignAttribute("aPosition2"),this.AssignAttribute("aTexCoord2"),this.AssignAttribute("aPosition3"),this.AssignAttribute("aTexCoord3"),this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")},e.prototype.BindBasicTexture=function(t,e){(null==e||e<0||e>3)&&(e=0);var o=this.gl;t.uniformId=e,this["originalTexture"+e]=t,this["boundTexture"+e]=o.createTexture(),this["essenceBuffer"+e]=o.createBuffer();var n=r(0,0,t.w,t.h);n.push.apply(n,r(0,0,1,1)),o.bindTexture(o.TEXTURE_2D,this["boundTexture"+e]),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.MIRRORED_REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.MIRRORED_REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t.image),o.bindBuffer(o.ARRAY_BUFFER,this["essenceBuffer"+e]),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,null),o.bindTexture(o.TEXTURE_2D,null)},e.prototype.BindUnit=function(t,e,o,r){null!=this["boundTexture"+r]&&(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this["boundTexture"+r]),t.bindBuffer(t.ARRAY_BUFFER,this["essenceBuffer"+r]),t.enableVertexAttribArray(o["aPosition"+r]),t.vertexAttribPointer(o["aPosition"+r],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o["aTexCoord"+r]),t.vertexAttribPointer(o["aTexCoord"+r],2,t.FLOAT,!1,0,48))},e.prototype.Execute=function(t,e,r,n,i){var s=this.gl,a=this.attributes,l=this.uniforms;this!==o.LAST_USED_CONTROLLER?(s.useProgram(this.program),this.BindUnit(s,l,a,0),this.BindUnit(s,l,a,1),this.BindUnit(s,l,a,2),this.BindUnit(s,l,a,3),s.uniform1f(l.uUnitId,i),s.uniform1i(l.uImage,i),o.LAST_USED_CONTROLLER=this,this.lastUsedUnit=i):i!==this.lastUsedUnit&&(s.uniform1f(l.uUnitId,i),s.uniform1i(l.uImage,i),this.lastUsedUnit=i),s.uniform4fv(l.uTint,n),s.uniformMatrix3fv(l.uProjection,!1,t),s.uniformMatrix3fv(l.uTranslation,!1,e),s.uniformMatrix3fv(l.uTransformation,!1,r),s.drawArrays(s.TRIANGLE_STRIP,0,6)},t.Controller.GLTextureProgramController=e,t.GLTextureProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.TEXTURE_2D_BATCH)}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.originalTexture=null,e.prototype.boundTexture=null,e.prototype.essenceBuffer=null,e.prototype.dataBuffer=null,e.prototype.indexBuffer=null,e.prototype.previousNumberOfElements=null,e.prototype.BindBasicTexture=function(t){var e=this.gl;this.aia=e.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,this.boundTexture=e.createTexture(),this.essenceBuffer=e.createBuffer(),this.dataBuffer=e.createBuffer();var o=r(0,0,t.w,t.h);o.push.apply(o,r(0,0,1,1)),e.bindTexture(e.TEXTURE_2D,this.boundTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")},e.prototype.Execute=function(t,e){var r=this.gl,n=this.aia,i=this.attributes,s=this.uniforms;this!==o.LAST_USED_CONTROLLER&&(r.useProgram(this.program),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.boundTexture),r.uniform1i(s.uImage,0),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,0,0),n.vertexAttribDivisorANGLE(i.aPosition,0),r.enableVertexAttribArray(i.aTexCoord),r.vertexAttribPointer(i.aTexCoord,2,r.FLOAT,!1,0,48),n.vertexAttribDivisorANGLE(i.aTexCoord,0),o.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?r.bufferData(r.ARRAY_BUFFER,t,r.DYNAMIC_DRAW):r.bufferSubData(r.ARRAY_BUFFER,0,t),r.enableVertexAttribArray(i.aProjection1),r.vertexAttribPointer(i.aProjection1,3,r.FLOAT,!1,108,0),n.vertexAttribDivisorANGLE(i.aProjection1,1),r.enableVertexAttribArray(i.aProjection2),r.vertexAttribPointer(i.aProjection2,3,r.FLOAT,!1,108,12),n.vertexAttribDivisorANGLE(i.aProjection2,1),r.enableVertexAttribArray(i.aProjection3),r.vertexAttribPointer(i.aProjection3,3,r.FLOAT,!1,108,24),n.vertexAttribDivisorANGLE(i.aProjection3,1),r.enableVertexAttribArray(i.aTranslation1),r.vertexAttribPointer(i.aTranslation1,3,r.FLOAT,!1,108,36),n.vertexAttribDivisorANGLE(i.aTranslation1,1),r.enableVertexAttribArray(i.aTranslation2),r.vertexAttribPointer(i.aTranslation2,3,r.FLOAT,!1,108,48),n.vertexAttribDivisorANGLE(i.aTranslation2,1),r.enableVertexAttribArray(i.aTranslation3),r.vertexAttribPointer(i.aTranslation3,3,r.FLOAT,!1,108,60),n.vertexAttribDivisorANGLE(i.aTranslation3,1),r.enableVertexAttribArray(i.aTransformation1),r.vertexAttribPointer(i.aTransformation1,3,r.FLOAT,!1,108,72),n.vertexAttribDivisorANGLE(i.aTransformation1,1),r.enableVertexAttribArray(i.aTransformation2),r.vertexAttribPointer(i.aTransformation2,3,r.FLOAT,!1,108,84),n.vertexAttribDivisorANGLE(i.aTransformation2,1),r.enableVertexAttribArray(i.aTransformation3),r.vertexAttribPointer(i.aTransformation3,3,r.FLOAT,!1,108,96),n.vertexAttribDivisorANGLE(i.aTransformation3,1),n.drawArraysInstancedANGLE(r.TRIANGLE_STRIP,0,6,e)},t.Controller.GLTextureBatchProgramController=e,t.GLTextureBatchProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.PIXEL_BATCH),this.Initialise()}var o=t.Controller.GLProgramController;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.dataBuffer=null,e.prototype.prevNumElements=0,e.prototype.Initialise=function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")},e.prototype.Execute=function(t,e){var r=this.gl,n=this.attributes;o.LAST_USED_CONTROLLER!==this&&r.useProgram(this.program),r.bindBuffer(r.ARRAY_BUFFER,this.dataBuffer),e!==this.prevNumElements?r.bufferData(r.ARRAY_BUFFER,t,r.DYNAMIC_DRAW):r.bufferSubData(r.ARRAY_BUFFER,0,t),r.enableVertexAttribArray(n.aProjection1),r.vertexAttribPointer(n.aProjection1,3,r.FLOAT,!1,64,0),r.enableVertexAttribArray(n.aProjection2),r.vertexAttribPointer(n.aProjection2,3,r.FLOAT,!1,64,12),r.enableVertexAttribArray(n.aProjection3),r.vertexAttribPointer(n.aProjection3,3,r.FLOAT,!1,64,24),r.enableVertexAttribArray(n.aPosition),r.vertexAttribPointer(n.aPosition,2,r.FLOAT,!1,64,36),r.enableVertexAttribArray(n.aColor),r.vertexAttribPointer(n.aColor,4,r.FLOAT,!1,64,44),r.enableVertexAttribArray(n.aPointSize),r.vertexAttribPointer(n.aPointSize,1,r.FLOAT,!1,64,60),r.drawArrays(r.POINTS,0,e),this.prevNumElements=e,o.LAST_USED_CONTROLLER=this},t.Controller.GLPixelBatchProgramController=e,t.GLPixelBatchProgramController=e}}]);
//# sourceMappingURL=nk.min.js.map