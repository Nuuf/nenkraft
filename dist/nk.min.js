/**
* @package     Nenkraft
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     1.0.2
* @copyright   (C) 2017-2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft/blob/master/LICENSE}
*/
!function(t){function e(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=31)}([function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,e){t.exports=function(){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var o=this[e];return this[e]=this[t],this[t]=o,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var o=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),o}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}}},function(t,e){t.exports=function(t){"use strict";var e=Math.PI,o=Math.sin,r=Math.cos,i=Math.pow,n=Math.round;t.Math.PII=2*e,t.Math.PI5=.5*e,t.Math.DEGREES_TO_RADIANS=e/180,t.Math.RADIANS_TO_DEGREES=180/e,t.Math.RADIAN=t.Math.DEGREES_TO_RADIANS;var s=t.Math.DegreesToRadians=t.Math.DTR=function(e){return e*t.Math.DEGREES_TO_RADIANS};t.Math.RadiansToDegrees=t.Math.RTD=function(e){return e*t.Math.RADIANS_TO_DEGREES},t.Math.PrecisionRound=function(t,e){if(null==e)return t;var o=i(10,e);return n(o*t)/o},t.Math.PR=t.Math.PrecisionRound,t.Math.Spread=function(t,e,o,r){return t-o*(e-1)*.5+r*o},t.Math.AttractRepel=function(t,e,i,n,s){var a=e.SubtractVC(t);if(a.GetMagnitudeSquared()<n*n){var l=a.GetAngle();i.Add(r(l)*s,o(l)*s)}},t.Math.Oscillate=function(t,e,r,i){var n=.5*(r-e);return e+n+o(s(t*i))*n},t.Math.LineLineIntersection=function(t,e,o,r){var i=e.SubtractVC(t),n=r.SubtractVC(o),s=-n.x*i.y+i.x*n.y,a=t.x-o.x,l=t.y-o.y,h=(-i.y*a+i.x*l)/s,p=(n.x*l-n.y*a)/s;return h>=0&&h<=1&&p>=0&&p<=1&&(i.Set(t.x+p*i.x,t.y+p*i.y),i)},t.Math.ClosestPointOnLine=function(t,e,o){var r=e.SubtractVC(t),i=((o.x-t.x)*r.x+(o.y-t.y)*r.y)/r.GetMagnitudeSquared();return i<0?t:i>1?e:(r.Set(t.x+i*r.x,t.y+i*r.y),r)},t.Math.LikeASquareGrid=function(t,e,o,r){for(var i=0,n=t.length,s=e/o|0;i<n;++i)t[i].Set(i%s*o,(i/s|0)*r)},t.Math.SquareGrid=function(t,e,o,r,i){for(var n=[],s=0,a=t/o|0,l=e/r|0,h=a*l;s<h;++s)n.push(new i(s%a*o,(s/a|0)*r));return n},t.Math.TriRectArray=function(t,e,o,r,i){return null!=i?(i[0]=t,i[1]=e,i[2]=t+o,i[3]=e,i[4]=t,i[5]=e+r,i[6]=t,i[7]=e+r,i[8]=t+o,i[9]=e,i[10]=t+o,i[11]=e+r,i):[t,e,t+o,e,t,e+r,t,e+r,t+o,e,t+o,e+r]};var a=t.Math.GreatestCommonDivisor=t.Math.GCD=function(t,e){return 0===e?t:a(e,t%e)};t.Math.SimplifyAspectRatio=t.Math.SAR=function(t,e,o){var r=a(t,e),i=null==o?[]:o;return i[0]=t/r,i[1]=e/r,i},Object.defineProperty(t.Math,"PII",{writable:!1}),Object.defineProperty(t.Math,"PI5",{writable:!1}),Object.defineProperty(t.Math,"DEGREES_TO_RADIANS",{writable:!1}),Object.defineProperty(t.Math,"RADIANS_TO_DEGREES",{writable:!1}),Object.defineProperty(t.Math,"RADIAN",{writable:!1})}},function(t,e,o){(function(e){t.exports=function(t){"use strict";function o(t,e,f,y){if(void 0==y||"function"!=typeof t.Assert)switch(e){case o.IS:return void r(t,f,e);case o.IS_NOT:return void i(t,f,e);case o.IS_SAME_TYPE:return void n(t,f,e);case o.IS_NOT_SAME_TYPE:return void s(t,f,e);case o.IS_INSTANCE_OF:return void a(t,f,e);case o.IS_NOT_INSTANCE_OF:return void l(t,f,e);case o.IS_LESS_THAN:return void h(t,f,e);case o.IS_GREATER_THAN:return void p(t,f,e);case o.IS_LESS_THAN_OR_EQUAL:return void u(t,f,e);case o.IS_GREATER_THAN_OR_EQUAL:return void c(t,f,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,f)}function r(t,e,o){var r=!1;t!==e&&(r=!0),f(r,t,e,o)}function i(t,e,o){var r=!1;t===e&&(r=!0),f(r,t,e,o)}function n(t,e,o){var r=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(r=!0):null===t||null===e?t!==e&&(r=!0):typeof t!=typeof e?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(r=!0),f(r,t,e,o)}function s(t,e,o){var r=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(r=!0):null===t||null===e?e===t&&(r=!0):typeof t==typeof e?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(r=!0),f(r,t,e,o)}function a(t,e,o){var r=!1;t instanceof e||(r=!0),f(r,t,e.name,o)}function l(t,e,o){var r=!1;t instanceof e&&(r=!0),f(r,t,e.name,o)}function h(t,e,o){var r=!1;t>=e&&(r=!0),f(r,t,e,o)}function p(t,e,o){var r=!1;t<=e&&(r=!0),f(r,t,e,o)}function u(t,e,o){var r=!1;t>e&&(r=!0),f(r,t,e,o)}function c(t,e,o){var r=!1;t<e&&(r=!0),f(r,t,e,o)}function f(t,e,r,i){if(t)throw y(e,r,i),new Error("Assertion failed: "+i);o.LOG&&window&&d(e,r,i)}function y(t,e,r){switch(r){case o.IS:r=o.IS_NOT;break;case o.IS_NOT:r=o.IS;break;case o.IS_SAME_TYPE:r=o.IS_NOT_SAME_TYPE;break;case o.IS_NOT_SAME_TYPE:r=o.IS_SAME_TYPE;break;case o.IS_INSTANCE_OF:r=o.IS_NOT_INSTANCE_OF;break;case o.IS_NOT_INSTANCE_OF:r=o.IS_INSTANCE_OF;break;case o.IS_LESS_THAN:r=o.IS_GREATER_THAN_OR_EQUAL;break;case o.IS_GREATER_THAN:r=o.IS_LESS_THAN_OR_EQUAL;break;case o.IS_LESS_THAN_OR_EQUAL:r=o.IS_GREATER_THAN;break;case o.IS_GREATER_THAN_OR_EQUAL:r=o.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,r,e)}function d(t,e,o){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(o),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}o.IS="IS",o.IS_NOT="IS NOT",o.IS_SAME_TYPE="IS SAME TYPE",o.IS_NOT_SAME_TYPE="IS NOT SAME TYPE",o.IS_INSTANCE_OF="IS INSTANCE OF",o.IS_NOT_INSTANCE_OF="IS NOT INSTANCE OF",o.IS_LESS_THAN="IS LESS THAN",o.IS_GREATER_THAN="IS GREATER THAN",o.IS_LESS_THAN_OR_EQUAL="IS LESS THAN OR EQUAL",o.IS_GREATER_THAN_OR_EQUAL="IS GREATER THAN OR EQUAL",o.Assign=function(t){if(window&&!t?t=window:e&&t&&(t=e),!t)throw new Error("No global namespace");t.IS=o.IS,t.IS_NOT=o.IS_NOT,t.IS_SAME_TYPE=o.IS_SAME_TYPE,t.IS_NOT_SAME_TYPE=o.IS_NOT_SAME_TYPE,t.IS_INSTANCE_OF=o.IS_INSTANCE_OF,t.IS_NOT_INSTANCE_OF=o.IS_NOT_INSTANCE_OF,t.IS_LESS_THAN=o.IS_LESS_THAN,t.IS_GREATER_THAN=o.IS_GREATER_THAN,t.IS_LESS_THAN_OR_EQUAL=o.IS_LESS_THAN_OR_EQUAL,t.IS_GREATER_THAN_OR_EQUAL=o.IS_GREATER_THAN_OR_EQUAL},o.LOG=!1,t.Utils.Assert=o,t.Assert=o}}).call(e,o(0))},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.class=t,this.objects=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.class=null,e.prototype.objects=null,e.prototype.floodFunction=null,e.prototype.floodAmount=100,e.prototype.context=null,e.prototype.Store=function(t){this.objects.push(t)},e.prototype.Retrieve=function(){return 0===this.objects.length&&this.Flood(),this.objects.pop()},e.prototype.Flood=function(t,e,o){t&&(this.floodFunction=t),e&&(this.floodAmount=e),o&&(this.context=o);for(var r=0;r<this.floodAmount;++r)if(null!=this.class){var i=new this.class;this.Store(i),this.floodFunction.call(this.context,i)}else this.Store(this.floodFunction.call(this.context))},e.prototype.Flush=function(){this.objects.length=0},e.prototype.Clean=function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)},t.Utils.Pool=e,t.Pool=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);null!=t&&(this.type=t),this.items=[]}var o=t.Utils.Assert,r=Object.create(null);e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.type=null,e.prototype.items=null,e.prototype.Store=function(t){var e=!1;return null==t?(console.warn("Item is null. Cannot store null item."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Item is not valid. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))},e.prototype.StoreSafe=function(t){return null!=this.type&&o(t,o.IS_INSTANCE_OF,this.type),o(t,o.IS_SAME_TYPE,r),t.id?(o(t.id,o.IS_SAME_TYPE,""),o(t.id,o.IS_NOT,"")):(o(t.data,o.IS_SAME_TYPE,r),o(t.data.id,o.IS_SAME_TYPE,""),o(t.data.id,o.IS_NOT,"")),this.Store(t)},e.prototype.Get=function(t){for(var e=0,o=this.items,r=o.length;e<r;++e)if(o[e]===t)return t;return null},e.prototype.GetById=function(t){for(var e=0,o=this.items,r=o.length,i=o[e];e<r;i=o[++e])if(null!=i&&(i.id===t||null!=i.data&&i.data.id===t))return i;return null},e.prototype.PerformOnAll=function(t,e,o){for(var r=0,i=this.items,n=i.length,s=i[r];r<n;s=i[++r])null!=s&&s[t]&&s[t].apply(o||s,e);return null},e.prototype.Contains=function(t,e){for(var o=0,r=this.items,i=r.length,n=r[o];o<i;n=r[++o])if(null!=n){if(n===t)return!0;if(n.id===e)return!0;if(null!=n.data&&n.data.id===e)return!0}return!1},t.Utils.Cache=e}},function(t,e){t.exports=function(t){"use strict";var e=Math.random,o=t.Math.PR,r=t.Utils.RandomInteger=function(t,o){return e()*(o-t+1)+t|0},i=t.Utils.RandomFloat=function(t,o){return e()*(o-t)+t},n=t.Utils.IsInteger=function(t){return Number(t)===t&&t%1==0};t.Utils.IsFloat=function(t){return Number(t)===t&&t%1!=0},t.Utils.Sign=function(t,e){return 0===t?!0===e?1:0:t>0?1:-1},t.Utils.Clamp=function(t,e,o){return t<e?e:t>o?o:t},t.Utils.InverseClamp=function(t,e,o){return t<e?o:t>o?e:t},t.Utils.ThisOrThat=function(t,e){return 1===r(1,2)?t:e},t.Utils.IntegerNotation=function(t,e,o){var r=t%e,i=t/e;return Math.ceil(0===r?i+1:i)+o+(1+r)},t.Utils.GenerateSequence=function(t,e,r,i){for(var n=[],s=t;s<e;s+=r)n.push(o(s,i));return n};var s=t.Utils.RandomInArray=function(t){return t[r(0,t.length-1)]};t.Utils.MinMaxOrValue=function(t,e){return null!=t.min&&null!=t.max?i(t.min,t.max):null!=t.values&&t.values.length>0?s(t.values):null!=e&&t[e].length>0?s(t[e]):t},t.Utils.UUID=function(e,o,i,s){e=null==e?32:e,o=null==o?4:o,i=null==i?0:i,s=null==s?"-":s;for(var a,l,h="",p=0,u=e/o|0,c=t.Utils.CharacterSets[i];p<e;++p)a=p/u,0!==a&&n(a)?h+=s:(l=r(1,c.length-1),h+=c.charAt(l));return h},t.Utils.CharacterSets=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"],t.Utils.ApplyProperties=function(t,e){if(void 0!==e){var o;for(o in e)void 0!==t[o]&&(t[o]=e[o])}};var a=t.Utils.Nested=function(t,e,o,r,i,n){"string"==typeof e&&(n=null==n?".":n,e=e.split(n));var s;if(e.length>1){if(s=e.shift(),void 0!==t[s])return a(t[s],e,o,r,i,n)}else{if(s=e.shift(),void 0!==t[s])return!0===r?void(t[s]=i):!0===o?t:t[s];if(!0===r)return void(t[s]=i)}};t.Utils.ArrayGetRandom=function(t,o){for(var r=[],i={},n=t.length,s=0,a=o;s<a;++s){var l=e()*n|0;void 0===i[l]?(i[l]=null,r.push(t[l])):s--}return r},t.Utils.ArrayShuffle=function(t){for(var o,r,i=t.length-1;i>=0;--i)r=e()*i|0,o=t[i],t[i]=t[r],t[r]=o},t.Utils.Cipher={},t.Utils.Decipher={},t.Utils.Cipher.CCH1=function(t,e){var o=[];e=void 0===e?1:e;for(var i,n,s=0,a=t.split(""),l=a.length;s<l;++s)i=a[s],i=(i.charCodeAt(0)+e).toString(2),n=r(1,9),o.push(n+"x"+i.replace(/1/g,n));return o.join(" ")},t.Utils.Decipher.CCH1=function(t,e){var o=[];e=void 0===e?1:e;for(var r,i=0,n=t.split(" "),s=n.length;i<s;++i)r=n[i],r=r.slice(2-r.length),o.push(String.fromCharCode(parseInt(r.replace(/[2-9]/g,"1"),2)-e));return o.join("")},t.Utils.Base16ToBase10=function(t){return parseInt(t,16)},t.Utils.Base2ToBase10=function(t){return parseInt(t,2)},t.Utils.IsObjectEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})};var l=t.Utils.DeepClone=function(t){var e=null,o=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(Array.isArray(t))e=[],o=!0;else{if("object"!=typeof t)return t;e={}}if(o)for(var r=0;r<t.length;++r)e[r]=l(t[r]);else for(var i in t)t.hasOwnProperty(i)&&(e[i]=l(t[i]));return e}}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.value=0,e.prototype.Add=function(t){this.value|=t},e.prototype.Remove=function(t){this.value=this.value&~t},e.prototype.Compare=function(t){return 0!=(this.value&t)},e.prototype.Holds=function(t){return(this.value&t)===t},e.prototype.Toggle=function(t){this.value^=t},t.Utils.FlagList=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.NONE=0,e.prototype.next=1,e.prototype.Add=function(t){t=t.toUpperCase(),void 0===this[t]&&(this[t]=this.next,this.next=this.next<<1)},t.Utils.FlagEnum=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i){if(!(this instanceof e))return new e(t,o,r,i);this.context=o,this.holderContext=t,this.handle=r,this.removeOnNextCall=i}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.Execute=function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()},e.prototype.Remove=function(){this.holderContext.Remove(this.handle,this.context)},t.Event.LocalListener=e,t.LocalListener=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.listeners=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.stopPropagation=!1,e.prototype.target=null,e.prototype.data=null,e.prototype.GetListenerIndex=function(t,e){var o=this.listeners;if(0===o.length)return-1;for(var r,i=0,n=o.length;i<n;++i)if(r=o[i],r.context===e&&r.handle===t)return i;return-1},e.prototype.Add=function(e,o,r){var i=t.LocalListener(this,o,e,r);this.listeners.push(i)},e.prototype.Remove=function(t,e){var o=this.GetListenerIndex(t,e);-1!==o&&this.listeners.fickleSplice(o)},e.prototype.Dump=function(t){var e=this.listeners;if(0!==e.length)if(void 0!==t)for(var o,r=0,i=e.length;r<i;++r)o=e[r],o.context===t&&this.listeners.fickleSplice(r);else this.listeners.length=0},e.prototype.Dispatch=function(t,e){var o=this.listeners;if(0!==o.length){o=o.slice(),this.stopPropagation=!1,this.target=t,this.data=e;for(var r,i=0,n=o.length;i<n&&(r=o[i],r.Execute(this),!0!==this.stopPropagation);++i);delete this.target,delete this.data}},t.Event.LocalEvent=e,t.LocalEvent=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);null!=o&&(this.stopTime=o),this.onStop=t.LocalEvent(),this.onFinish=t.LocalEvent(),this.onStart=t.LocalEvent(),this.onReset=t.LocalEvent(),this.onPause=t.LocalEvent(),this.onResume=t.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.time=0,e.prototype.stopTime=0,e.prototype.isRunning=!1,e.prototype.canResume=!1,e.prototype.count=0,e.prototype.Reset=function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1,this.stopTime=null},e.prototype.Start=function(t){this.stopTime=Math.round(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))},e.prototype.Stop=function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))},e.prototype.Pause=function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))},e.prototype.Resume=function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))},e.prototype.Process=function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))},t.Time.Timer=e,t.Timer=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);void 0!=t&&void 0!=t.x&&void 0!=t.y?(this.x=t.x,this.y=t.y):void 0!=t&&(void 0==o?(this.x=t,this.y=t):(this.x=t,this.y=o))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TranslateMultiple=function(t,e){for(var o=0,r=t.length;o<r;++o)t[o].AddV(e)},e.GetMinMaxDot=function(t,e){for(var o=1/0,r=-o,i=0,n=e.Copy(),s=0,a=t.length;s<a;++s)i=t[s].GetDotV(e),i>r&&(r=i),i<o&&(o=i);return n.Set(o,r),n},e.Pool=t.Utils.Pool(e),e.Pool.Retrieve=function(t,e){0===this.objects.length&&this.Flood();var o=this.objects.pop();return o.Set(t,e),o},e.USE_POOL=!0,e.prototype.x=0,e.prototype.y=0,e.prototype.Copy=function(){return!0===e.USE_POOL?e.Pool.Retrieve(this.x,this.y):e(this)},e.prototype.FromStore=function(t,o){return!0===e.USE_POOL?e.Pool.Retrieve(t,o):e(t,o)},e.prototype.AbsoluteCopy=function(){var t=this.Copy();return t.Positive(),t},e.prototype.SetV=function(t){this.x=t.x,this.y=t.y},e.prototype.Set=function(t,e){void 0!=t&&void 0==e?(this.x=t,this.y=t):(this.x=t,this.y=e)},e.prototype.Is0=function(){return 0===this.x&&0===this.y},e.prototype.AddV=function(t){this.x+=t.x,this.y+=t.y},e.prototype.AddVC=function(t){var e=this.Copy();return e.AddV(t),e},e.prototype.Add=function(t,e){this.x+=t,this.y+=e},e.prototype.SubtractV=function(t){this.x-=t.x,this.y-=t.y},e.prototype.SubtractVC=function(t){var e=this.Copy();return e.SubtractV(t),e},e.prototype.Subtract=function(t,e){this.x-=t,this.y-=e},e.prototype.MultiplyV=function(t){this.x*=t.x,this.y*=t.y},e.prototype.MultiplyVC=function(t){var e=this.Copy();return e.MultiplyV(t),e},e.prototype.Multiply=function(t,e){this.x*=t,this.y*=e},e.prototype.DivideV=function(t){this.x/=t.x,this.y/=t.y},e.prototype.DivideVC=function(t){var e=this.Copy();return e.DivideV(t),e},e.prototype.Divide=function(t,e){this.x/=t,this.y/=e},e.prototype.Normalize=function(){var t=this.GetMagnitude();this.Divide(t,t)},e.prototype.Positive=function(){this.x=Math.abs(this.x),this.y=Math.abs(this.y)},e.prototype.Negative=function(){this.x=-Math.abs(this.x),this.y=-Math.abs(this.y)},e.prototype.Invert=function(){this.x=-this.x,this.y=-this.y},e.prototype.Rotate=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.x,i=this.y;this.x=r*o-i*e,this.y=r*e+i*o},e.prototype.RotateAbsolute=function(t){this.Rotate(t-this.GetAngle())},e.prototype.RotateAroundV=function(t,e){this.SubtractV(t),this.Rotate(e),this.AddV(t)},e.prototype.RotateAround=function(t,e,o){this.Subtract(t,e),this.Rotate(o),this.Add(t,e)},e.prototype.RotateAbsoluteAroundV=function(t,e){this.SubtractV(t),this.RotateAbsolute(e),this.AddV(t)},e.prototype.RotateAbsoluteAround=function(t,e,o){this.Subtract(t,e),this.RotateAbsolute(o),this.Add(t,e)},e.prototype.PushFromV=function(t,e){var o=this.Copy();o.SubtractV(t),o.Normalize(),o.Multiply(e,e),this.AddV(o)},e.prototype.PushFrom=function(t,e,o){var r=this.Copy();r.Subtract(t,e),r.Normalize(),r.Multiply(o,o),this.AddV(r)},e.prototype.GetWeightedAverage=function(t,e,o){return this.FromStore(this.x*(1-o)+t*o,this.y*(1-o)+e*o)},e.prototype.GetWeightedAverageV=function(t,e){return this.FromStore(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)},e.prototype.GetAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.GetAngleBetweenV=function(t){return Math.atan2(this.y-t.y,this.x-t.x)},e.prototype.GetAngleBetween=function(t,e){return Math.atan2(this.y-e,this.x-t)},e.prototype.GetDotV=function(t){return this.x*t.x+this.y*t.y},e.prototype.GetDot=function(t,e){return this.x*t+this.y*e},e.prototype.GetCrossV=function(t){return this.x*t.y+this.y*t.x},e.prototype.GetCross=function(t,e){return this.x*e+this.y*t},e.prototype.GetMagnitudeSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.GetMagnitude=function(){return Math.sqrt(this.GetMagnitudeSquared())},e.prototype.GetDistanceV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitude()},e.prototype.GetDistance=function(t,e){var o=this.Copy();return o.Subtract(t,e),o.GetMagnitude()},e.prototype.GetDistanceSquaredV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitudeSquared()},e.prototype.GetDistanceSquared=function(t,e){var o=this.Copy();return o.Subtract(t,e),o.GetMagnitudeSquared()},e.prototype.GetPerpendicularCCWV=function(t){return this.FromStore(-(t.y-this.y),t.x-this.x)},e.prototype.GetPerpendicularCCW=function(t,e){return this.FromStore(-(e-this.y),t-this.x)},e.prototype.GetPerpendicularCWV=function(t){return this.FromStore(t.y-this.y,-(t.x-this.x))},e.prototype.GetPerpendicularCW=function(t,e){return this.FromStore(e-this.y,-(t-this.x))},e.prototype.GetNormalAV=function(t){var e=this.GetPerpendicularCCWV(t);return e.Normalize(),e},e.prototype.GetNormalA=function(t,e){var o=this.GetPerpendicularCCW(t,e);return o.Normalize(),o},e.prototype.GetNormalBV=function(t){var e=this.GetPerpendicularCWV(t);return e.Normalize(),e},e.prototype.GetNormalB=function(t,e){var o=this.GetPerpendicularCW(t,e);return o.Normalize(),o},e.prototype.GetMidPointV=function(t){var e=this.Copy();return e.AddV(t),e.Divide(2,2),e},e.prototype.GetMidPoint=function(t,e){var o=this.Copy();return o.Add(t,e),o.Multiply(.5,.5),o},e.prototype.IsEqualTo=function(t,e){return this.x===t&&this.y===e},e.prototype.IsEqualToV=function(t){return this.x===t.x&&this.y===t.y},e.prototype.GetProjectionOntoV=function(t){var e=this.GetDotV(t);if(0===e)return this.FromStore(0);var o=t.GetMagnitude(),r=e/(o*o),i=t.Copy();return i.Multiply(r,r),i},e.prototype.GetProjectionOnto=function(t,e){var o=this.Copy();o.Set(t,e);var r=this.GetDotV(o);if(0===r)return this.FromStore(0);var i=o.GetMagnitude(),n=r/(i*i);return o.Multiply(n,n),o},e.prototype.GetReflectionV=function(t){var e=t.Copy(),o=this.GetDotV(e);return e.Multiply(2,2),e.Multiply(o,o),this.SubtractVC(e)},e.prototype.GetReflection=function(t,e){var o=this.Copy();o.Set(t,e);var r=this.GetDotV(o);return o.Multiply(2,2),o.Multiply(r,r),this.SubtractVC(o)},e.prototype.Assert=function(){var e=t.Utils.Assert;e(this.x,e.IS_SAME_TYPE,0),e(this.y,e.IS_SAME_TYPE,0)},e.prototype.Store=function(){e.Pool.Store(this)},e.prototype.GetLength=e.prototype.GetMagnitude,e.prototype.GetLengthSquared=e.prototype.GetMagnitudeSquared,t.Math.Vector2D=e,t.Vector2D=e,e.Pool.Flood(function(){},1e5)}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.array=new Float32Array(9)}e.prototype=Object.create(null),e.prototype.constructor=e,e.EPSILON=1e-5,e.prototype.array=null,e.prototype.a=1,e.prototype.b=0,e.prototype.c=0,e.prototype.d=1,e.prototype.e=0,e.prototype.f=0,e.prototype.Identity=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},e.prototype.Copy=function(){var t=new e;return t.Set(this.a,this.b,this.c,this.d,this.e,this.f),t},e.prototype.Set=function(t,e,o,r,i,n){return this.a=t,this.b=e,this.c=o,this.d=r,this.e=i,this.f=n,this},e.prototype.SetTransform=function(t,e,o,r,i,n,s,a,l){t=null==t?0:t,e=null==e?0:e,o=null==o?1:o,r=null==r?1:r,i=null==i?0:i,n=null==n?0:n,s=null==s?0:s,a=null==a?0:a,l=null==l?0:l;var h=Math.sin(i),p=Math.cos(i),u=-Math.sin(n),c=Math.cos(n),f=Math.sin(s),y=Math.cos(s),d=p*o,v=h*o,m=-h*r,g=p*r;return this.a=y*d+f*m,this.b=y*v+f*g,this.c=u*d+c*m,this.d=u*v+c*g,this.e=t+a*d+l*m,this.f=e+a*v+l*g,this},e.prototype.Translate=function(t,e){this.e+=t,this.f+=e},e.prototype.TranslateTo=function(t,e){this.e=t,this.f=e},e.prototype.ApplyTranslation=function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f},e.prototype.ApplyScale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e},e.prototype.Scale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},e.prototype.Rotate=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.a,i=this.c,n=this.e;this.a=r*o-this.b*e,this.b=r*e+this.b*o,this.c=i*o-this.d*e,this.d=i*e+this.d*o,this.e=n*o-this.f*e,this.f=n*e+this.f*o},e.prototype.Decompose=function(t){var o=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),a=Math.atan2(r,o);Math.abs(s+a)<e.EPSILON?(t.rotation=a,o<0&&n>=0&&(t.rotation+=Math.PI),t.skew.Set(0)):t.skew.Set(s,a),t.scale.Set(Math.sqrt(o*o+r*r),Math.sqrt(i*i+n*n)),t.position.Set(this.e,this.f)},e.prototype.ApplyToContext=function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)},e.prototype.AsArray=function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e},t.Math.Matrix2D=e,t.Matrix2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.position=t.Vector2D(o,r),this.scale=t.Vector2D(1,1),this.localTransform=t.Vector2D(0,0),this.worldTransform=t.Vector2D(0,0)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.UpdateLocal=function(){this.localTransform.SetV(this.position)},e.prototype.UpdateWorld=function(t){var e=this.localTransform;e.SetV(this.position),this.worldTransform.Set(t.e+e.x,t.f+e.y)},e.prototype.ApplyWorld=function(t){t.setTransform(this.scale.x,0,0,this.scale.y,this.worldTransform.x,this.worldTransform.y)},t.Math.Basetransform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.position=t.Vector2D(o,r),this.scale=t.Vector2D(1,1),this.skew=t.Vector2D(0,0),this.pivot=t.Vector2D(0,0),this.localTransform=t.Matrix2D(),this.worldTransform=t.Matrix2D()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.rotation=0,e.prototype.skewCX=1,e.prototype.skewSX=0,e.prototype.skewCY=0,e.prototype.skewSY=1,e.prototype.Set=function(t){t.Decompose(this),this.UpdateSkew()},e.prototype.UpdateLocal=function(){var t=this.localTransform,e=this.position,o=this.scale,r=this.pivot;t.a=this.skewCX*o.x,t.b=this.skewSX*o.x,t.c=this.skewCY*o.y,t.d=this.skewSY*o.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d},e.prototype.UpdateWorld=function(t){var e=this.localTransform,o=this.worldTransform,r=this.position,i=this.scale,n=this.pivot;e.a=this.skewCX*i.x,e.b=this.skewSX*i.x,e.c=this.skewCY*i.y,e.d=this.skewSY*i.y,e.e=r.x-n.x*e.a+n.y*e.c,e.f=r.y-n.y*e.b+n.y*e.d,o.a=e.a*t.a+e.b*t.c,o.b=e.a*t.b+e.b*t.d,o.c=e.c*t.a+e.d*t.c,o.d=e.c*t.b+e.d*t.d,o.e=e.e*t.a+e.f*t.c+t.e,o.f=e.e*t.b+e.f*t.d+t.f},e.prototype.UpdateSkew=function(){var t=this.skew,e=this.rotation;this.skewCX=Math.cos(e+t.y),this.skewSX=Math.sin(e+t.y),this.skewCY=-Math.sin(e-t.x),this.skewSY=Math.cos(e-t.x)},e.prototype.ApplyWorld=function(t){this.worldTransform.ApplyToContext(t)},t.Math.Transform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n){if(!(this instanceof e))return new e(o,r,i,n);void 0!==o&&null!=o.x&&null!=o.y&&void 0!==r&&null!=r.x&&null!=r.y?(this.s=o,this.e=r):void 0!==o&&void 0!==r&&void 0!==i&&void 0!==n?(this.s=t.Vector2D(o,r),this.e=t.Vector2D(i,n)):(this.s=t.Vector2D(),this.e=t.Vector2D())}var o=t.Math.LineLineIntersection,r=t.Math.ClosestPointOnLine;e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=0,e.prototype.TYPE=e.TYPE,e.prototype.epsilon=1e3,e.prototype.belongsTo=null,e.prototype.Stretch=function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)},e.prototype.Rotate=function(t,e,o){e=void 0==e?.5:e;var r=this.s.Copy();r.AddV(this.e),r.Multiply(e,void 0==o?e:o),this.s.RotateAroundV(r,t),this.e.RotateAroundV(r,t)},e.prototype.Cut=function(t,e){null==e&&(e=[]);for(var o=0;o<t.length;++o)e.push(this.s.GetWeightedAverageV(this.e,t[o]));return e},e.prototype.GetLength=function(){return this.s.GetDistanceV(this.e)},e.prototype.GetLengthSquared=function(){return this.s.GetDistanceSquaredV(this.e)},e.prototype.IntersectsPoint=function(t){var e=this.s,o=this.e,r=(t.y-e.y)*(o.x-e.x)-(t.x-e.x)*(o.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var i=(t.x-e.x)*(o.x-e.x)+(t.y-e.y)*(o.y-e.y);return!(i<0)&&!(i>this.GetLengthSquared())},e.prototype.IntersectsLine=function(t){return o(this.s,this.e,t.s,t.e)},e.prototype.GetClosestPointTo=function(t){return r(this.s,this.e,t)},e.prototype.GetNormalA=function(){return this.s.GetNormalAV(this.e)},e.prototype.GetNormalB=function(){return this.s.GetNormalBV(this.e)},t.Geom.Line2D=e,t.Geom.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n){if(!(this instanceof e))return new e(o,r,i,n);o instanceof t.Vector2D&&r instanceof t.Vector2D?(this.tl=o,this.br=r):void 0!==o&&void 0!==r&&void 0!==o.x&&void 0!==o.y&&void 0!==r.x&&void 0!==r.y?(this.tl=t.Vector2D(o.x,o.y),this.br=t.Vector2D(r.x,r.y)):void 0!==o&&void 0!==r&&void 0!==i&&void 0!==n?(this.tl=t.Vector2D(o,r),this.br=t.Vector2D(i,n)):(this.tl=t.Vector2D(),this.br=t.Vector2D()),this.ComputeWH()}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=1,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.prototype.TYPE=e.TYPE,e.prototype.w=0,e.prototype.h=0,e.prototype.hw=0,e.prototype.hh=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,o,r){this.tl.x=t,this.tl.y=e,this.br.x=o,this.br.y=r,this.ComputeWH()},e.prototype.SetC=function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)},e.prototype.Scale=function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()},e.prototype.ComputeWH=function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h},e.prototype.GetQuadrant=function(t){var o=this.tl,r=this.br;switch(t){case e.TOP_LEFT:return e(o.x,o.y,o.x+this.hw,o.y+this.hh);case e.TOP_RIGHT:return e(o.x+this.hw,o.y,r.x,o.y+this.hh);case e.BOTTOM_LEFT:return e(o.x,o.y+this.hh,o.x+this.hw,r.y);case e.BOTTOM_RIGHT:return e(o.x+this.hw,o.y+this.hh,r.x,r.y);default:return null}},e.prototype.IntersectsPoint=function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)},e.prototype.ContainsPoint=function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y},e.prototype.IntersectsAABB2D=function(t){var e=this.tl,o=this.br,r=t.tl,i=t.br;return!(r.x>=o.x||r.y>=o.y||i.x<=e.x||i.y<=e.y)},e.prototype.ContainsAABB2D=function(t){if(t.area>this.area)return!1;var e=this.tl,o=this.br,r=t.tl,i=t.br;return r.x>=e.x&&r.y>=e.y&&i.x<=o.x&&i.y<=o.y},t.Geom.AABB2D=e,t.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=t.Vector2D(),null!=o&&(o[0]instanceof t.Vector2D?this.AddPoints(o):this.PushPoints(o))}var o=t.Utils.RandomFloat,r=t.Utils.RandomInteger;e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=3,e.CreateCopy=function(t){for(var o=new e,r=0,i=t.vertices,n=i.length;r<n;++r)o.AddPoint(i[r].Copy());return o},e.ExtractSegments=function(e,o){null==o&&(o=[]);for(var r=0,i=e.vertices,n=i[r],s=i.length-1;r<s;n=i[++r])o.push(t.Geom.Line2D(n,i[r+1]));return o.push(t.Geom.Line2D(i[s],i[0])),o},e.GenerateRandomPoints=function(e,i,n,s){e.ComputeBounds(),null==s&&(s=!1);var a=o,l=e.aabb.tl,h=e.aabb.br,p=[];!0===n&&(a=r);for(var u=0;u<i;++u){for(var c=t.Vector2D(a(l.x,h.x),a(l.y,h.y));e.IntersectsPoint(c)===s;)c.Set(a(l.x,h.x),a(l.y,h.y));p.push(c)}return p},e.Construct=Object.create(null),e.Construct.Rectangular=function(e,o,r,i,n){var s=t.Vector2D(o,r),a=t.Vector2D(o+i,r),l=t.Vector2D(o+i,r+n),h=t.Vector2D(o,r+n);return e.Recreate([s,a,l,h]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Isosceles=function(e,o,r,i,n){var s=t.Vector2D(o,r),a=t.Vector2D(o+.5*i,r+n),l=t.Vector2D(o-.5*i,r+n);return e.Recreate([s,a,l]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Cyclic=function(e,o,r,i,n){var s,a,l,h=0,p=n,u=2*Math.PI/p;for(e.Recreate([]),h;h<p;++h)l=u*h,s=Math.cos(l)*i,a=Math.sin(l)*i,e.AddPoint(t.Vector2D(o+s,r+a));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Equilateral=function(e,o,r,i){var n,s,a=2.0943951023931953;return e.Recreate([]),n=Math.cos(0)*i,s=Math.sin(0)*i,e.AddPoint(t.Vector2D(o+n,r+s)),n=Math.cos(a)*i,s=Math.sin(a)*i,e.AddPoint(t.Vector2D(o+n,r+s)),n=Math.cos(2*a)*i,s=Math.sin(2*a)*i,e.AddPoint(t.Vector2D(o+n,r+s)),e.Rotate(-90*t.Math.RADIAN),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Star=function(e,o,r,i,n,s){var a,l,h,p,u=0,c=2*s,f=2*Math.PI/c;for(e.Recreate([]),u;u<c;++u)p=0==(1&u)?i:n,h=f*u,a=Math.cos(h)*p,l=Math.sin(h)*p,e.AddPoint(t.Vector2D(o+a,r+l));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Butterfly=function(o,r,i,n,s){var a,l,h,p=0,u=e.Construct.Butterfly.C;for(o.Recreate([]),p;p<n;++p)h=p*u._1*Math.PI/n,a=Math.cos(h)*(Math.exp(Math.cos(h))-u._2*Math.cos(u._3*h)-Math.pow(Math.sin(h/u._4),u._5))*s,l=Math.sin(h)*(Math.exp(Math.cos(h))-u._2*Math.cos(u._3*h)-Math.pow(Math.sin(h/u._4),u._5))*s,o.AddPoint(t.Vector2D(r+a,i+l));return o.ComputeBounds(),o.GetNormalsA(),o},e.Construct.Butterfly.C={_1:24,_2:2,_3:4,_4:12,_5:5,Reset:function(){this._1=24,this._2=2,this._3=4,this._4=12,this._5=5}},e.Construct.Supershape=function(o,r,i,n,s,a,l,h,p){l=void 0===l?1:l,h=void 0===h?1:h,p=void 0===p?1:p;var u,c,f,y,d,v,m=0,g=s,A=e.Construct.Supershape.C;for(o.Recreate([]),m;m<g;++m)f=m*Math.PI*2/s,d=Math.cos(a*f/4)/A._A,d=Math.abs(d),d=Math.pow(d,h),v=Math.sin(a*f/4)/A._B,v=Math.abs(v),v=Math.pow(v,p),y=Math.pow(d+v,1/l),0===Math.abs(y)?(u=0,c=0):(y=1/y,u=Math.cos(f)*y*n,c=Math.sin(f)*y*n),o.AddPoint(t.Vector2D(r+u,i+c));return o.ComputeBounds(),o.GetNormalsA(),o},e.Construct.Supershape.C={_A:1,_B:1},e.prototype.TYPE=e.TYPE,e.prototype.aabb=null,e.prototype.dirtyBounds=!0,e.prototype.belongsTo=null,e.prototype.AddPoint=function(t){this.vertices.push(t)},e.prototype.AddPoints=function(t){this.vertices.push.apply(this.vertices,t)},e.prototype.PushPoint=function(e,o){this.vertices.push(t.Vector2D(e,o))},e.prototype.PushPoints=function(t){for(var e=0,o=t.length;e<o;e+=2)this.PushPoint(t[e],t[e+1])},e.prototype.Recreate=function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)},e.prototype.ComputeBounds=function(){null===this.aabb&&(this.aabb=t.Geom.AABB2D());for(var e,o=1/0,r=-o,i=o,n=-o,s=0,a=this.vertices,l=a.length;s<l;++s)e=a[s],e.x<o&&(o=e.x),e.x>r&&(r=e.x),e.y<i&&(i=e.y),e.y>n&&(n=e.y);this.aabb.Set(o,i,r,n),this.dirtyBounds=!1},e.prototype.Rotate=function(t,e,o,r){!0===this.dirtyBounds&&!0===r?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e;var i=this.aabb,n=i.tl.Copy();n.AddV(i.br),n.Multiply(e,void 0===o?e:o);var s,a=0,l=this.vertices,h=l.length;for(a;a<h;++a)s=l[a],s.RotateAroundV(n,t);this.dirtyBounds=!0},e.prototype.GetCentroid=function(){var t=this.centroid;t.Set(0,0);for(var e,o=0,r=this.vertices,i=r.length;o<i;++o)e=r[o],t.AddV(e);return t.Divide(i,i),t},e.prototype.GetNormalsA=function(){var t=this.normals;t.length=0;for(var e=0,o=this.vertices,r=o[e],i=this.vertices.length-1;e<i;r=o[++e])t.push(r.GetNormalAV(o[e+1]));return t.push(o[i].GetNormalAV(o[0])),t},e.prototype.GetNormalsB=function(){var t=this.normals;t.length=0;for(var e=0,o=this.vertices,r=o[e],i=o.length-1;e<i;r=o[++e])t.push(r.GetNormalBV(o[e+1]));return t.push(o[i].GetNormalBV(o[0])),t},e.prototype.GetPerimeterMidPoints=function(){var t=this.perimeterMidPoints;t.length=0;for(var e=0,o=this.vertices,r=o[e],i=o.length-1;e<i;r=o[++e])t.push(r.GetMidPointV(o[e+1]));return t.push(o[i].GetMidPointV(o[0])),t},e.prototype.IntersectsPoint=function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;var e,o,r,i,n=t.x,s=t.y,a=!1,l=this.vertices,h=l.length;for(e=0,o=h-1;e<h;o=e++)r=l[e],i=l[o],r.y>s!=i.y>s&&n<(i.x-r.x)*(s-r.y)/(i.y-r.y)+r.x&&(a=!a);return a},t.Geom.Polygon2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i){if(!(this instanceof e))return new e(o,r,i);this.center=t.Vector2D(o,r),this.radius=void 0===i?32:i}var o=t.Utils.RandomFloat,r=t.Utils.RandomInteger;e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=2,e.GenerateRandomPoints=function(e,i,n,s){null==s&&(s=!1);var a=o,l=t.Vector2D(e.x-e.radius,e.y-e.radius),h=t.Vector2D(e.x+e.radius,e.y+e.radius),p=[];!0===n&&(a=r);for(var u=0;u<i;++u){for(var c=t.Vector2D(a(l.x,h.x),a(l.y,h.y));e.IntersectsPoint(c)===s;)c.Set(a(l.x,h.x),a(l.y,h.y));p.push(c)}return p},e.prototype.TYPE=e.TYPE,e.prototype.diameter=0,e.prototype.w=0,e.prototype.h=0,e.prototype.radiusSquared=0,e.prototype.radiusUnsquared=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,o){this.center.Set(t,e),this.radius=o},e.prototype.SetC=function(t){this.center.SetV(t),this.radius=t.radius},e.prototype.Scale=function(t){this.radius*=t},e.prototype.IntersectsCircle=function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)},e.prototype.IntersectsPoint=function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)},Object.defineProperty(e.prototype,"x",{set:function(t){this.center.x=t},get:function(){return this.center.x}}),Object.defineProperty(e.prototype,"y",{set:function(t){this.center.y=t},get:function(){return this.center.y}}),Object.defineProperty(e.prototype,"radius",{set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=Math.PI*t*t},get:function(){return this.radiusUnsquared}}),t.Geom.Circle=e}},function(t,e){t.exports=function(t){"use strict";var e=Object.create(null);e.AABB2DvsAABB2D=Object.create(null),e.AABB2DvsAABB2D.Relative=Object.create(null),e.CirclevsCircle=Object.create(null),e.CirclevsCircle.Relative=Object.create(null),e.PolygonvsPolygon=Object.create(null),e.PolygonvsPolygon.Relative=Object.create(null),e.CirclevsLine=Object.create(null),e.CirclevsLine.Relative=Object.create(null),e.VectorSortMinMag=function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()};var o=t.Vector2D.GetMinMaxDot,r=t.Math.ClosestPointOnLine;e.AABB2DvsAABB2D.Result=function(){this.mtv=t.Vector2D()},e.AABB2DvsAABB2D.Result.prototype.occured=!1,e.AABB2DvsAABB2D.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.occured=!1},e.AABB2DvsAABB2D.Relative.Collide=function(o,r,i){var n=o.shape,s=n.w,a=n.h,l=o.anchor,h=r.shape,p=h.w,u=h.h,c=r.anchor,f=n.tl.SubtractVC(o.relative),y=h.tl.SubtractVC(r.relative);void 0!=l&&(f.x+=l.x*s,f.y+=l.y*a),void 0!=c&&(y.x+=c.x*p,y.y+=c.y*u);var d=y.x+s,v=f.x+p,m=y.y+a,g=f.y+u;if(f.x<d&&y.x<v&&f.y<m&&y.y<g){if(void 0!=i){var A=[t.Vector2D(f.x-d,0),t.Vector2D(v-y.x,0),t.Vector2D(0,f.y-m),t.Vector2D(0,g-y.y)];A.sort(e.VectorSortMinMag),i.mtv.SetV(A[0]),i.occured=!0}return!0}return!1},e.CirclevsCircle.Result=function(){this.mtv=t.Vector2D(0,0),this.poc={a:null,b:null,c:null}},e.CirclevsCircle.Result.prototype.mtd=0,e.CirclevsCircle.Result.prototype.delta=null,e.CirclevsCircle.Result.prototype.occured=!1,e.CirclevsCircle.Result.prototype.Reset=function(){this.poc.a=null,this.poc.b=null,this.poc.c=null,this.mtv.Set(0,0),this.mtd=0,this.delta=null,this.occured=!1},e.CirclevsCircle.Relative.Collide=function(e,o,r){var i=e.shape,n=o.shape,s=i.radius,a=n.radius,l=s+a,h=e.anchor,p=o.anchor,u=e.relative.Copy(),c=o.relative.Copy();void 0!=h&&(u.x+=h.x*i.diameter,u.y+=h.y*i.diameter),void 0!=p&&(c.x+=p.x*n.diameter,c.y+=p.y*n.diameter);var f=c.SubtractVC(u),y=f.GetMagnitudeSquared();if(l*l>y){if(void 0!=r){var d=Math.sqrt(y),v=(i.radiusSquared-n.radiusSquared+y)/(d+d),m=t.Vector2D(u.x+f.x*v/d,u.y+f.y*v/d),g=Math.sqrt(i.radiusSquared-v*v)/d,A=-f.y*g,T=f.x*g,S=t.Vector2D(m.x+A,m.y+T),x=t.Vector2D(m.x-A,m.y-T),C=u.SubtractVC(c);C.Divide(l,l);var b=d-s-a;r.poc.a=m,r.poc.b=S,r.poc.c=x,r.mtv.SetV(C),r.mtd=b,r.delta=f,r.occured=!0}return!0}return!1},e.CirclevsCircle.Relative.ElasticResponse=function(t,e,o){var r=o.delta.Copy(),i=o.mtv.Copy();r.Normalize();var n=t.mass,s=e.mass,a=t.velocity,l=e.velocity,h=a.GetDotV(r),p=l.GetDotV(r),u=2*(h-p)/(n+s);a.Set(a.x-u*s*r.x,a.y-u*s*r.y),l.Set(l.x+u*n*r.x,l.y+u*n*r.y),i.Multiply(o.mtd,o.mtd),i.Divide(2,2),t.relative.SubtractV(i),e.relative.AddV(i)},e.PolygonvsPolygon.Result=function(){this.mtv=t.Vector2D(0,0),this.olAxis=t.Vector2D(0,0)},e.PolygonvsPolygon.Result.prototype.occured=!1,e.PolygonvsPolygon.Result.prototype.mtd=1/0,e.PolygonvsPolygon.Result.prototype.Reset=function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)};var i=e.PolygonvsPolygon.Relative.AxisSeparates=function(t,e,r,i){var n=o(t.shape.vertices,r),s=o(e.shape.vertices,r),a=e.relative.SubtractVC(t.relative).GetDotV(r);if(s.Add(a,a),n.x>s.y||s.x>n.y)return!0;if(void 0!=i){var l=0,h=n.x,p=n.y,u=s.x,c=s.y,f=0,y=0;h<u?p<c?l=p-u:(f=p-u,y=c-h,l=f<y?f:-y):p>c?l=h-c:(f=p-u,y=c-h,l=f<y?f:-y);var d=Math.abs(l);d<i.mtd&&(i.mtd=d,i.olAxis.SetV(r),l<0&&i.olAxis.Invert())}return!1};e.PolygonvsPolygon.Relative.Collide=function(t,e,o){var r=t.shape,n=e.shape,s=r.normals,a=n.normals,l=0,h=s.length,p=a.length;for(l;l<h;++l)if(!0===i(t,e,s[l],o))return!1;for(l=0;l<p;++l)if(!0===i(t,e,a[l],o))return!1;return void 0!=o&&(o.mtv.SetV(o.olAxis),o.mtv.Multiply(o.mtd,o.mtd),o.occured=!0),!0},e.CirclevsLine.Result=function(){this.mtv=t.Vector2D(0,0),this.cp=t.Vector2D(0,0)},e.CirclevsLine.Result.prototype.occured=!1,e.CirclevsLine.Result.prototype.sore=0,e.CirclevsLine.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.cp.Set(0,0),this.occured=!1,this.sore=0},e.CirclevsLine.Relative.Collide=function(t,e,o){var i=e.shape,n=t.shape,s=e.relative,a=t.relative,l=i.s.AddVC(s),h=i.e.AddVC(s),p=r(l,h,a),u=a.SubtractVC(p),c=u.GetMagnitudeSquared();if(c<n.radiusSquared){if(o){var f=u,y=n.radius-Math.sqrt(c);f.Normalize(),f.Multiply(y,y),o.mtv.SetV(f),o.cp.SetV(p),o.occured=!0,p===l?o.sore=1:p===h&&(o.sore=2)}return!0}return!1},e.CirclevsLine.Relative.ReflectingResponse=function(t,e,o){var r,i,n=e.shape,s=t.velocity,a=t.relative,l=o.cp;0!==o.sore?(r=l.SubtractVC(a),r.Normalize()):r=n.GetNormalA(),i=s.GetReflectionV(r),s.SetV(i),a.AddV(o.mtv)},t.Math.Collision2D=e}},function(t,e){t.exports=function(t){"use strict";t.Math.Ease=Object.create(null);var e=Math.sin,o=Math.cos,r=Math.PI;t.Math.Ease.Linear=function(t,e,o,r){return o*t/r+e},t.Math.Ease.QuadIn=function(t,e,o,r){return t/=r,o*t*t+e},t.Math.Ease.QuadOut=function(t,e,o,r){return t/=r,-o*t*(t-2)+e},t.Math.Ease.QuadInOut=function(t,e,o,r){return(t/=.5*r)<1?.5*o*t*t+e:(t--,.5*-o*(t*(t-2)-1)+e)},t.Math.Ease.SineIn=function(t,e,i,n){return-i*o(t/n*(.5*r))+i+e},t.Math.Ease.SineOut=function(t,o,i,n){return i*e(t/n*(.5*r))+o},t.Math.Ease.SineInOut=function(t,e,i,n){return.5*-i*(o(r*t/n)-1)+e},t.Ease=t.Math.Ease}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n,s,a){if(!(this instanceof e))return new e(o,r,i,n,s,a);this.id=o,this.target=r,this.propertyString=i,void 0!==n&&(this.value=n),void 0!==s&&(this.duration=s),this.easing=t.Math.Ease[void 0===a?e.DEFAULT_EASING:a],this.onStart=t.Event.LocalEvent(),this.onEnd=t.Event.LocalEvent(),this.onStop=t.Event.LocalEvent(),this.onReconfigure=t.Event.LocalEvent(),this.onReset=t.Event.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.DEFAULT_EASING="Linear",e.prototype.id=null,e.prototype.target=null,e.prototype.easing=null,e.prototype.duration=1e3,e.prototype.time=0,e.prototype.value=1,e.prototype.startValue=0,e.prototype.propertyString=null,e.prototype.change=0,e.prototype.property=null,e.prototype.propertyObject=null,e.prototype.running=!1,e.prototype.Start=function(){var e=this.propertyString.split(".");this.property=e[e.length-1],this.propertyObject=t.Utils.Nested(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)},e.prototype.Stop=function(){delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onStop.Dispatch(this,null)},e.prototype.Process=function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))},e.prototype.Reconfigure=function(o,r,i,n){void 0!==o&&(this.propertyString=o),this.value=r,this.duration=i,this.easing=t.Math.Ease[void 0===n?e.DEFAULT_EASING:n],this.onReconfigure.Dispatch(this,null)},e.prototype.Reset=function(){if(null===this.propertyObject||null===this.property)return!1;this.propertyObject[this.property]=this.startValue,delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onReset.Dispatch(this,null)},t.Motion=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.motions=[],this.target=t}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.target=null,e.prototype.motions=null,e.prototype.Create=function(e,o,r,i,n){if(null===this.GetMotion(e)){var s=t.Motion(e,this.target,o,r,i,n);return this.motions.push(s),s}return null},e.prototype.Add=function(t){null===this.GetMotion(t.id)&&this.motions.push(t)},e.prototype.Start=function(t){var e=this.GetMotion(t);return null!==e&&e.Start(),e},e.prototype.StartMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Start(t[e])},e.prototype.Stop=function(t){var e=this.GetMotion(t);return null!==e&&e.Stop(),e},e.prototype.StopMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Stop(t[e])},e.prototype.Reset=function(t){var e=this.GetMotion(t);return null!==e&&e.Reset(),e},e.prototype.ResetMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Reset(t[e])},e.prototype.Process=function(){for(var t,e=0,o=this.motions,r=o.length;e<r;++e)t=o[e],t.Process()},e.prototype.GetMotion=function(t){for(var e,o=0,r=this.motions,i=r.length;o<i;++o)if(e=r[o],e.id===t)return e;return null},t.MotionManager=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i){if(!(this instanceof e))return new e(t,o,r,i);this.Set(t,o,r,i),this.nodes={},this.objects=[],this.convergence=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.Pool=t.Utils.Pool(e),e.Pool.Retrieve=function(t,e,o,r){0===this.objects.length&&this.Flood();var i=this.objects.pop();return i.Set(t,e,o,r),i},e.USE_POOL=!0,e.prototype.objectCap=0,e.prototype.levelCap=0,e.prototype.level=0,e.prototype.nodes=null,e.prototype.objects=null,e.prototype.convergence=null,e.prototype.aabb=null,e.prototype.hasSplit=!1,e.prototype.Set=function(t,e,o,r){this.aabb=t,this.level=e,this.objectCap=o,this.levelCap=r},e.prototype.FromStore=function(t,o,r,i){return!0===e.USE_POOL?e.Pool.Retrieve(t,o,r,i):e(t,o,r,i)},e.prototype.Add=function(t){var e="",o=this.objects,r=this.nodes,i=0;if(!0===this.hasSplit&&null!==(e=this.Marking(t)))return void r[e].Add(t);if(o.push(t),this.level<this.levelCap&&o.length>this.objectCap)for(!1===this.hasSplit&&this.Split();i<o.length;)e=this.Marking(o[i]),null!==e?r[e].Add(o.fickleSplice(i)):++i},e.prototype.Converge=function(t){var o=this.convergence;o.length=0,o.push.apply(o,this.objects);var r=null,i=this.nodes;return!0===this.hasSplit&&(r=this.Marking(t),null!==r?o.push.apply(o,i[r].Converge(t)):(o.push.apply(o,i[e.TOP_LEFT].Converge(t)),o.push.apply(o,i[e.TOP_RIGHT].Converge(t)),o.push.apply(o,i[e.BOTTOM_LEFT].Converge(t)),o.push.apply(o,i[e.BOTTOM_RIGHT].Converge(t)))),o},e.prototype.Split=function(){var t=this.level+1,o=this.objectCap,r=this.levelCap,i=this.nodes,n=this.aabb;i[e.TOP_LEFT]=this.FromStore(n.GetQuadrant(e.TOP_LEFT),t,o,r),i[e.TOP_RIGHT]=this.FromStore(n.GetQuadrant(e.TOP_RIGHT),t,o,r),i[e.BOTTOM_LEFT]=this.FromStore(n.GetQuadrant(e.BOTTOM_LEFT),t,o,r),i[e.BOTTOM_RIGHT]=this.FromStore(n.GetQuadrant(e.BOTTOM_RIGHT),t,o,r),this.hasSplit=!0},e.prototype.Dump=function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[e.TOP_LEFT].Dump(),t[e.TOP_RIGHT].Dump(),t[e.BOTTOM_LEFT].Dump(),t[e.BOTTOM_RIGHT].Dump(),!0===e.USE_POOL&&(t[e.TOP_LEFT].Store(),t[e.TOP_RIGHT].Store(),t[e.BOTTOM_LEFT].Store(),t[e.BOTTOM_RIGHT].Store())),this.nodes={},this.hasSplit=!1},e.prototype.Marking=function(t){var o=this.nodes;return!0===o[e.TOP_LEFT].aabb.ContainsAABB2D(t)?e.TOP_LEFT:!0===o[e.TOP_RIGHT].aabb.ContainsAABB2D(t)?e.TOP_RIGHT:!0===o[e.BOTTOM_LEFT].aabb.ContainsAABB2D(t)?e.BOTTOM_LEFT:!0===o[e.BOTTOM_RIGHT].aabb.ContainsAABB2D(t)?e.BOTTOM_RIGHT:null},e.prototype.ConcatNodes=function(t){void 0===t&&(t=[]),t.push(this);var o=this.nodes;return!1===this.hasSplit?t:(o[e.TOP_LEFT].ConcatNodes(t),o[e.TOP_RIGHT].ConcatNodes(t),o[e.BOTTOM_LEFT].ConcatNodes(t),o[e.BOTTOM_RIGHT].ConcatNodes(t),t)},e.prototype.Store=function(){e.Pool.Store(this)},t.Utils.QuadtreeNode=e,t.QuadtreeNode=e,e.Pool.Flood(function(){},1e3)}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.transform=t.Math.Transform2D(o,r),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=t.Math.Transform2D(),e.prototype.parent=null,e.prototype.transform=null,e.prototype.data=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.globalPosition=null,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){var e=this.transform.worldTransform;return null===this.globalPosition?this.globalPosition=t.Vector2D(e.e,e.f):this.globalPosition.Set(e.e,e.f),this.globalPosition},e.prototype.ComputeBounds=function(e){var o=e&&e.x?e.x:0,r=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=t.Geom.AABB2D(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w*this.scale.x},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}),t.Entity.CoreEntity2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);o.call(this,t,r),this.children=[]}var o=t.Entity.CoreEntity2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.children=null,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.isBatchParent=!1,e.prototype.childDataBuffer=null,e.prototype.bufferData=null,e.prototype.programController=null,e.prototype.bufferStartIndex=0,e.prototype.bufferEndIndex=0,e.prototype.PreDraw=function(){},e.prototype.GLPreDraw=function(){},e.prototype.Draw=function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t))},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t)))},e.prototype.RequestTransformUpdate=function(){this.transformShouldUpdate=!0},e.prototype.DrawChildren=function(t){for(var e=0,o=this.children,r=o.length;e<r;++e)o[e].Draw(t)},e.prototype.GLDrawChildren=function(t){for(var e=0,o=this.children,r=o.length;e<r;++e)o[e].GLDraw(t)},e.prototype.GLBatchDrawChildren=function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)},e.prototype.ComputeBatchBuffer=function(t){for(var e,o,r=[],i=0,n=this.children,s=n.length;i<s;++i)e=n[i],o=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=r.length,e.bufferEndIndex=r.length+o.length,r.push.apply(r,o);this.childDataBuffer=new Float32Array(r)},e.prototype.UpdateInBuffer=function(){throw new Error("Cannot update buffer data directly!")},e.prototype.GetBufferData=function(){throw new Error("Cannot access buffer data directly!")},e.prototype.AddChild=function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t},e.prototype.AddChildren=function(){var t=arguments;Array.isArray(t[0])&&(t=t[0]);for(var e=0,o=t.length;e<o;++e)this.AddChild(t[e])},e.prototype.Mount=function(){this.AddChildren.apply(this,arguments)},e.prototype.AddSibling=function(t){var e=this.parent;return null!==e&&e.AddChild(t),t},e.prototype.RemoveChild=function(t){var e=this.children,o=e.indexOf(t);if(-1!==o)return t.parent=null,e.fickleSplice(o)},e.prototype.RemoveChildren=function(){for(var t,e,o=this.children,r=arguments[0].length?arguments[0]:arguments,i=[],n=0,s=r.length;n<s;++n)t=r[n],-1!==(e=o.indexOf(t))&&(i.push(o.fickleSplice(e)),t.parent=null);return i},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.fickleSplice(e))}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.unshift(t.fickleSplice(e))}},e.prototype.Dump=function(){this.children.length=0},e.prototype.Destroy=function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.GetChildClosestTo=function(t,e){var o=this.children,r=null;if(0!==o.length){for(var i,n,s=0,a=o.length,l=1/0;s<a;++s)i=o[s],void 0!==e&&!1===e(i)||(n=Math.abs(i.position.GetDistanceSquared(t.x,t.y)))<l&&(l=n,r=i);return r}return null},e.prototype.GetChildFurthestFrom=function(t,e){var o=this.children,r=null;if(0!==o.length){for(var i,n,s=0,a=o.length,l=0;s<a;++s)i=o[s],void 0!==e&&!1===e(i)||(n=Math.abs(i.position.GetDistanceSquared(t.x,t.y)))>l&&(l=n,r=i);return r}return null},e.prototype.UseAsBatchParent=function(t){this.isBatchParent=!0,this.programController=t},t.Entity.Container2D=e,t.Container2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);o.call(this,t,r)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Render=function(){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&this.RenderChildren())},e.prototype.RenderChildren=function(){for(var t,e=0,o=this.children,r=o.length;e<r;++e)t=o[e],t.Render&&t.Render()},t.Entity.Case2D=e,t.Case2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i,n){if(!(this instanceof e))return new e(t,o,r,i,n);this.id=t.split(" "),this.handle=o,this.info=r,void 0!==i&&(this.priority=i),void 0!==n&&(this.breakIfExecuted=n),this.data={}}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.command=null,e.prototype.priority=0,e.prototype.breakIfExecuted=!1,e.prototype.Execute=function(t,e,o){return this.handle(t,e,o),this.breakIfExecuted},t.CP.Option=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i,n){if(!(this instanceof e))return new e(t,o,r,i,n);this.id=t.split(" "),this.handle=o,this.info=r,this.data={},this.optionPrefix=void 0===n?e.OPTION_PREFIX:n,this.dsCopy=[],void 0!==i&&(this.continueToPrime=i)}e.prototype=Object.create(null),e.prototype.constructor=e,e.OPTION_PREFIX="",e.prototype.dataSeparator="=",e.prototype.options=null,e.prototype.allOptionIds=null,e.prototype.fullInfo=null,e.prototype.optionPrefix=null,e.prototype.continueToPrime=!0,e.prototype.dsCopy=null,e.prototype.register=null,e.prototype.Execute=function(t,e,o){this.HandleData(t,e),!0===this.HandleOptions(t,e,o)&&this.handle(t,e,o)},e.prototype.AddOption=function(e,o,r,i,n,s){s=void 0===s?this.optionPrefix:s,null!==s&&(e=e.replace(/\S+/g,s+"$&")),null===this.options&&(this.options=[]),i=void 0===i?0:i;var a=t.CP.Option(e,o,r,i,n);a.command=this;for(var l,h=0,p=this.options,u=p.length;h<u;++h)if(l=p[h],l.priority<=i)return p.splice(h,0,a),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(a),this.allOptionIds=this.GetAllOptionIds(),this},e.prototype.HandleData=function(t,e){var o=this.dsCopy;o.push.apply(o,t);for(var r,i,n=0,s=o.length,a=this.dataSeparator;n<s;++n)r=o[n],i=r.split(a),2===i.length&&(t.fickleSplice(n),e[i[0]]=i[1]);o.length=0},e.prototype.HandleOptions=function(t,e,o){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null===r)return this.continueToPrime;for(var i,n=0,s=r.length;n<s;++n)if(i=this.GetOptionById(r[n]),!0===i.Execute(t,e,o))return!1;return this.continueToPrime},e.prototype.GetOptionById=function(t){for(var e,o=0,r=this.options,i=r.length;o<i;++o)if(e=r[o],-1!==e.id.indexOf(t))return e;return null},e.prototype.GetAllOptionIds=function(){for(var t=[],e=0,o=this.options,r=o.length;e<r;++e)t.push.apply(t,o[e].id);return t},e.prototype.GetAndRemoveMatchingOptionIds=function(t){var e=this.allOptionIds;if(null===e)return null;for(var o=[],r=0,i=e.length;r<i;++r){var n=t.indexOf(e[r]);-1!==n&&o.push(t.fickleSplice(n))}return o},e.prototype.GenerateInfoString=function(){for(var t,e="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",o=0,r=this.options,i=r.length;o<i;++o)t=r[o],e+="OPTION: "+t.id.join(", ")+" -> "+t.info+"\n";return e},t.CP.Command=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.commands=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.splitter=" ",e.prototype.AddCommand=function(t){if(null===t.register)return this.commands.push(t),t.register=this,t},e.prototype.RemoveCommand=function(t){var e=this.commands,o=e.indexOf(t);if(-1!==o)return t.register=null,e.fickleSplice(o)},e.prototype.GetCommand=function(t){for(var e,o=0,r=this.commands,i=r.length;o<i;++o)if(e=this.commands[o])for(var n=0,s=e.id.length;n<s;++n)if(e.id[n]===t)return e;return null},e.prototype.Parse=function(t,e){var o=String(t).split(this.splitter),r=o.shift(),i=this.GetCommand(r);return i?(i.Execute(o,{},e),null):r},t.CP.Register=e}},function(t,e,o){t.exports=o(32)},function(t,e,o){(function(e){var r=Object.create(null);o(1)(),o(33)(r),o(34)(r),o(2)(r),o(3)(r),o(4)(r),o(5)(r),o(6)(r),o(41)(r),o(42)(r),o(7)(r),o(8)(r),o(43)(r),o(44)(r),o(45)(r),o(46)(r),o(47)(r),o(48)(r),o(49)(r),o(50)(r),o(51)(r),o(9)(r),o(10)(r),o(52)(r),o(11)(r),o(12)(r),o(13)(r),o(14)(r),o(15)(r),o(16)(r),o(17)(r),o(18)(r),o(19)(r),o(20)(r),o(21)(r),o(22)(r),o(23)(r),o(24)(r),o(53)(r),o(54)(r),o(55)(r),o(56)(r),o(57)(r),o(58)(r),o(59)(r),o(60)(r),o(61)(r),o(25)(r),o(26)(r),o(27)(r),o(62)(r),o(63)(r),o(64)(r),o(65)(r),o(66)(r),o(67)(r),o(68)(r),o(69)(r),o(70)(r),o(71)(r),o(72)(r),o(73)(r),o(74)(r),o(75)(r),o(76)(r),o(77)(r),o(78)(r),o(28)(r),o(29)(r),o(30)(r),o(79)(r),o(80)(r),o(81)(r),o(82)(r),o(83)(r),o(84)(r),o(85)(r),o(86)(r),o(87)(r),o(88)(r),e.Nenkraft=e.nk=r,t.exports=r}).call(e,o(0))},function(t,e){t.exports=function(t){t.Geom=Object.create(null),t.Style=Object.create(null),t.Math=Object.create(null),t.Utils=Object.create(null),t.Texture=Object.create(null),t.Controller=Object.create(null),t.Entity=Object.create(null),t.Path=Object.create(null),t.Event=Object.create(null),t.Time=Object.create(null),t.Input=Object.create(null),t.CP=Object.create(null),t.Load=Object.create(null),t.Animator=Object.create(null),t.VERSION="1.0.2",t.PRINT_VERSION=function(){console.log("%cnenkraft %cversion %c"+t.VERSION,"color:cyan;background-color:black;font-family:Arial;font-size:16px;font-weight:900;","color:magenta;background-color:black;font-family:Arial;font-size:16px;","color:yellow;background-color:black;font-family:Arial;font-size:18px;")}}},function(t,e,o){t.exports=function(t){"use strict";function e(t){var e,o,r="@vertex@",i="@fragment@";e=t.indexOf(r)+r.length,o=t.indexOf("@vertex-end@");var n=t.substring(e,o);return e=t.indexOf(i)+i.length,o=t.indexOf("@fragment-end@"),{v:n,f:t.substring(e,o)}}t.SHADER_CODE={TEXTURE_2D:e(o(35)),TEXTURE_2D_BATCH:e(o(36)),LINE2D:e(o(37)),RECTANGLE:e(o(38)),CIRCLE:e(o(39)),PIXEL_BATCH:e(o(40))}}},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition0;\r\nattribute vec2 aTexCoord0;\r\n\r\nattribute vec2 aPosition1;\r\nattribute vec2 aTexCoord1;\r\n\r\nattribute vec2 aPosition2;\r\nattribute vec2 aTexCoord2;\r\n\r\nattribute vec2 aPosition3;\r\nattribute vec2 aTexCoord3;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nuniform float uUnitId;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  if ( uUnitId == 0.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 1.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition1, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord1, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 2.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition2, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord2, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 3.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition3, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord3, 1.0 ) ).xy;\r\n  }\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord );\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vColor = uColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = vFillColor;\r\n  } else {\r\n    gl_FragColor = vOutlineColor;\r\n  }\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vRadius = uRadius;\r\n  vOutline = uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = vRadius * vRadius;\r\n  float ors = vRadius - vOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = vOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = vFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports=function(t){"use strict";var e=null,o=null,r=null;t.Utils.GenerateSimpleBase64Png=function(t,r,i){var n=t();return null==e&&(e=document.createElement("canvas"),o=e.getContext("2d")),o.clearRect(0,0,e.width,e.height),e.width=n.w,e.height=n.h,null!=r&&(e.width=r),null!=i&&(e.height=i),o.setTransform(1,0,0,1,0,0),n.Draw(o),e.toDataURL("image/png")},t.Utils.ImageFromDataURL=function(t,e,o,r){var i=new Image;return i.width=e,i.height=o,i.onload=r,i.src=t,i},t.Utils.ParsedXMLToJSON=function(e,o){var r,i,n,s,a,l,h,p={},u=e.childNodes;if(1===e.nodeType){if(n=e.attributes,(i=n.length)>0)for(p.attributes={},r=0,s=n.item(r);r<i;s=n.item(++r))p.attributes[s.nodeName]=s.nodeValue}else 3===e.nodeType&&(/^\s*$/g.exec(e.nodeValue)||(p=e.nodeValue,!0===o&&(p=p.replace(/^\s+|\s+&|\n/gim,""))));if(null!=u)for(i=u.length,r=0,a=u.item(r);r<i;a=u.item(++r))void 0===p[a.nodeName]?p[a.nodeName]=t.Utils.ParsedXMLToJSON(a,o):(void 0===p[a.nodeName].push&&(h=p[a.nodeName],p[a.nodeName]=[],t.Utils.IsObjectEmpty(h)||p[a.nodeName].push(h)),l=t.Utils.ParsedXMLToJSON(a,o),t.Utils.IsObjectEmpty(l)||p[a.nodeName].push(l));return p["#text"]&&0===p["#text"].length&&delete p["#text"],p},t.Utils.XMLToJSON=function(e,o){return null==r&&(r=new DOMParser),t.Utils.ParsedXMLToJSON(r.parseFromString(e,"text/xml"),o)},t.Utils.DownloadAsJSON=function(t,e){var o="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),r=document.createElement("a");r.setAttribute("href",o),r.setAttribute("download",e+".json"),r.click()}}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i){if(!(this instanceof e))return new e(t,o,r,i);this.channel=new Float32Array([null==t?0:t,null==o?0:o,null==r?0:r,null==i?1:i]),this.ComputeValueRGBA()}var o=t.Utils.Base16ToBase10,r=t.Utils.Clamp;e.prototype=Object.create(null),e.prototype.constructor=e;var i=e.NORM=1/255;e.prototype.value="",e.prototype.currentConversion="",e.prototype.Copy=function(){var t=new e(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return t.value=this.value,t.currentConversion=this.currentConversion,t},e.prototype.ComputeValueRGBA=function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value},e.prototype.ComputeValueHSLA=function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value},e.prototype.ComputeValueHex=function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value},e.prototype.ConvertToHSLA=function(t){var e=this.channel[0]/255,o=this.channel[1]/255,r=this.channel[2]/255,i=Math.max(e,o,r),n=Math.min(e,o,r),s=i-n,a=i+n,l=0,h=0,p=.5*a;i!==n&&(h=p>.5?s/(2-i-n):s/(i+n),l=i===e?(o-r)/s+(o<r?6:0):i===o?(r-e)/s+2:(e-o)/s+4,l/=6),this.channel[0]=360*l,this.channel[1]=100*h,this.channel[2]=100*p,!0===t&&(this.channel[0]=Math.round(this.channel[0]),this.channel[1]=Math.round(this.channel[1]),this.channel[2]=Math.round(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()},e.prototype.SetRGB=function(t,e,o,i){this.channel[0]=r(t,0,255),this.channel[1]=r(e,0,255),this.channel[2]=r(o,0,255),this.currentConversion="rgb",i||this.ComputeValueRGBA()},e.prototype.SetRGBA=function(t,e,o,i){this.SetRGB(t,e,o,!0),this.channel[3]=r(i,0,1),this.ComputeValueRGBA()},e.prototype.SetHex=function(t){t=t.replace(/#/g,"");var e=t.match(/.{2}/g);e=e.map(o),null==e[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])},e.prototype.IncreaseChannel=function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()},e.prototype.SetChannel=function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()},e.prototype.Normalize=function(){this.channel[0]=i*this.channel[0],this.channel[1]=i*this.channel[1],this.channel[2]=i*this.channel[2]},Object.defineProperty(e.prototype,"r",{set:function(t){this.channel[0]=t},get:function(){return this.channel[0]}}),Object.defineProperty(e.prototype,"g",{set:function(t){this.channel[1]=t},get:function(){return this.channel[1]}}),Object.defineProperty(e.prototype,"b",{set:function(t){this.channel[2]=t},get:function(){return this.channel[2]}}),Object.defineProperty(e.prototype,"a",{set:function(t){this.channel[3]=t},get:function(){return this.channel[3]}}),t.Color=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n){if(!(this instanceof e))return new e(o,r,i,n);this.canvas=o,this.w=r,this.h=i,this.aspectRatio=t.Math.SAR(r,i),this.onChange=t.LocalEvent(),null!=n&&(this.mode=n),o.setAttribute("width",r),o.setAttribute("height",i),window.addEventListener("resize",this.OnWindowResize.bind(this))}e.prototype=Object.create(null),e.prototype.constructor=e,e.FILL_SCREEN="FillScreen",e.KEEP_ASPECT_RATIO="KeepAspectRatio",e.KEEP_ASPECT_RATIO_MIN="KeepAspectRatioMIN",e.KEEP_ASPECT_RATIO_MAX="KeepAspectRatioMAX",e.KEEP_ASPECT_RATIO_FIT="KeepAspectRatioFIT",e.prototype.canvas=null,e.prototype.stage=null,e.prototype.container=null,e.prototype.w=0,e.prototype.h=0,e.prototype.currentWidth=0,e.prototype.currentHeight=0,e.prototype.aspectRatio=null,e.prototype.onChange=null,e.prototype.mode=e.FILL_SCREEN,e.prototype.OnWindowResize=function(){this[this.mode]()},e.prototype.Trigger=function(){return this.OnWindowResize(),this},e.prototype.Reconfigure=function(t,e,o){return this.w=t,this.h=e,this.mode=o,this},e.prototype.BindStage=function(t){return this.stage=t,this},e.prototype.BindContainer=function(t){return this.container=t,this},e.prototype.SetCurrent=function(t,e){this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e,null!==this.stage&&(this.stage.w=t,this.stage.h=e,this.stage.mouse&&this.stage.mouse.scale.Set(t/this.w,e/this.h),this.stage.touch&&this.stage.touch.scale.Set(t/this.w,e/this.h),!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.container&&this.container.scale.Set(t/this.w,e/this.h)},e.prototype.FillScreen=function(){this.SetCurrent(window.innerWidth,window.innerHeight)},e.prototype.KeepAspectRatio=function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)},e.prototype.KeepAspectRatioMAX=function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)},e.prototype.KeepAspectRatioMIN=function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)},e.prototype.KeepAspectRatioFIT=function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(e=window.innerHeight,t=e/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)},t.Utils.CanvasManager=e,t.CanvasManager=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#444499",e.prototype.applied=!0,e.prototype.Apply=function(t){t.fillStyle=this.color},t.Style.Fill=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#000000",e.prototype.blur=5,e.prototype.offsetX=0,e.prototype.offsetY=0,e.prototype.applied=!1,e.prototype.Apply=function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY},t.Style.Shadow=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,t.Style.LINE_CAP={ROUND:"round",BUTT:"butt",SQUARE:"square"},t.Style.LINE_JOIN={BEVEL:"bevel",ROUND:"round",MITER:"miter"},e.prototype.color="#00FFFF",e.prototype.lineCap=t.Style.LINE_CAP.ROUND,e.prototype.lineJoin=t.Style.LINE_JOIN.ROUND,e.prototype.lineWidth=1,e.prototype.miterLimit=10,e.prototype.applied=!0,e.prototype.Apply=function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit},t.Style.Stroke=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o),this.ConcatFont()}e.prototype=Object.create(null),e.prototype.constructor=e,t.Style.TEXT_ALIGN={START:"start",END:"end",CENTER:"center",LEFT:"left",RIGHT:"right"},t.Style.TEXT_BASELINE={ALPHABETIC:"alphabetic",TOP:"top",HANGING:"hanging",MIDDLE:"middle",IDEOGRAPHIC:"ideographic",BOTTOM:"bottom"},e.prototype.fillColor="#444499",e.prototype.strokeColor="#00FFFF",e.prototype.fontSize=22,e.prototype.font=null,e.prototype.fontFamily="Arial",e.prototype.align=t.Style.TEXT_ALIGN.LEFT,e.prototype.baseline=t.Style.TEXT_BASELINE.TOP,e.prototype.applied=!0,e.prototype.lineWidth=.5,e.prototype.Apply=function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth},e.prototype.ConcatFont=function(){this.font=this.fontSize+"px "+this.fontFamily},t.Style.Text=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);t.Utils.ApplyProperties(this,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#000000",e.prototype.size=1,t.Style.Pixel=e}},function(t,e){t.exports=function(t){"use strict";t.Style.CreateAll=function(e){return{fill:t.Style.Fill(e?e.fill:null),stroke:t.Style.Stroke(e?e.stroke:null),shadow:t.Style.Shadow(e?e.shadow:null),text:t.Style.Text(e?e.text:null),pixel:t.Style.Pixel(e?e.pixel:null)}},t.Style.CreateFSSa=function(e){return{fill:t.Style.Fill(e?e.fill:null),stroke:t.Style.Stroke(e?e.stroke:null),shadow:t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateSSa=function(e){return{stroke:t.Style.Stroke(e?e.stroke:null),shadow:t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateFSa=function(e){return{fill:t.Style.Fill(e?e.fill:null),shadow:t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateSaT=function(e){return{shadow:t.Style.Shadow(e?e.shadow:null),text:t.Style.Text(e?e.text:null)}},t.Style.CreateP=function(e){return{pixel:t.Style.Pixel(e?e.pixel:null)}},t.Style.GCO=Object.create(null),t.Style.GCO.SOURCE_OVER=t.Style.GCO.DEFAULT="source-over",t.Style.GCO.SOURCE_IN="source-in",t.Style.GCO.SOURCE_OUT="source-out",t.Style.GCO.SOURCE_ATOP="source-atop",t.Style.GCO.DESTINATION_OVER="destination-over",t.Style.GCO.DESTINATION_IN="destination-in",t.Style.GCO.DESTINATION_OUT="destination-out",t.Style.GCO.DESTINATION_ATOP="destination-atop",t.Style.GCO.LIGHTER="lighter",t.Style.GCO.COPY="copy",t.Style.GCO.XOR="xor",t.Style.GCO.MULTIPLY="multiply",t.Style.GCO.OVERLAY="overlay",t.Style.GCO.DARKEN="darken",t.Style.GCO.LIGHTEN="lighten",t.Style.GCO.COLOR_DODGE="color-dodge",t.Style.GCO.COLOR_BURN="color-burn",t.Style.GCO.HARD_LIGHT="hard-light",t.Style.GCO.SOFT_LIGHT="soft-light",t.Style.GCO.DIFFERENCE="difference",t.Style.GCO.EXCLUSION="exclusion",t.Style.GCO.HUE="hue",t.Style.GCO.SATURATION="saturation",t.Style.GCO.COLOR="color",t.Style.GCO.LUMINOSITY="luminosity"}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i,n,s){if(!(this instanceof e))return new e(t,o,r,i,n,s);this.image=t,this.id=null!=o?o:t.id,this.w=null!=r?r:t.naturalWidth,this.h=null!=i?i:t.naturalHeight,this.fw=null!=n?n:t.naturalWidth,this.fh=null!=s?s:t.naturalHeight}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.image=null,e.prototype.id=null,e.prototype.w=0,e.prototype.h=0,e.prototype.fw=0,e.prototype.fh=0,e.prototype.uniformId=0,t.Texture.BasicTexture=e,t.BasicTexture=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.id=o.id,this.basicTexture=o,this.data=r,this.frameCache=t.Utils.Cache(t.Animator.Frame)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.id=null,e.prototype.basicTexture=null,e.prototype.data=null,e.prototype.frameCache=null,e.prototype.GenerateFrames=function(){for(var e,o,r,i=this.data,n=i.frames,s=i.meta.frameTags,a=0,l=n.length;a<l;++a)e=n[a],o=e.frame,r=s[a],this.frameCache.Store(t.Animator.Frame(o.x,o.y,o.w,o.h,e.duration,r?r.name:null))},e.prototype.GetFrameById=function(t){return this.frameCache.GetById(t)},t.Texture.Spritesheet=e,t.Spritesheet=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r){if(!(this instanceof e))return new e(t,o,r);if("function"!=typeof t)throw new Error("Ticker: An onProcess function is required!");this.SetDesiredRate(o),this.onProcess=t,void 0!=r&&!1!==r||this.StartAF()}e.prototype=Object.create(null),e.prototype.constructor=e,e.LOG=!0,e.GLOBAL_CSS="background-color:black;font-family:Arial;font-size:16px;",e.Log=function(){!1!==e.LOG&&console.log.apply(null,arguments)},e.prototype.intervalId=null,e.prototype.afId=null,e.prototype.delta=0,e.prototype.then=0,e.prototype.now=0,e.prototype.desiredRate=0,e.prototype.supplyDelta=!0,e.prototype.Process=function(){this.onProcess(this.ComputeDelta())},e.prototype.ProcessAF=function(){this.ComputeDelta(),this.onProcess(this.delta),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))},e.prototype.ComputeDelta=function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta},e.prototype.GetTPS=function(){return t.Math.PR(1/this.delta*1e3,2)},e.prototype.SetDesiredRate=function(t){this.desiredRate=void 0===t?16.66:1e3/t},e.prototype.Start=function(t){if(null!==this.afId)return e.Log("%cTicker: RAF is running!","color:red;".concat(e.GLOBAL_CSS)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),e.Log("%cTicker: Starting interval!","color:#0F0;".concat(e.GLOBAL_CSS))):e.Log("%cTicker: Interval already running!","color:#F00;".concat(e.GLOBAL_CSS)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),e.Log("%cTicker: Starting interval!","color:#0F0;".concat(e.GLOBAL_CSS)))},e.prototype.StartAF=function(t){if(null!==this.intervalId)return e.Log("%cTicker: Interval is running!","color:#F00;".concat(e.GLOBAL_CSS)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),e.Log("%cTicker: Starting RAF!","color:#0F0;".concat(e.GLOBAL_CSS))):e.Log("%cTicker: RAF already running!","color:#F00;".concat(e.GLOBAL_CSS)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),e.Log("%cTicker: Starting RAF!","color:#0F0;".concat(e.GLOBAL_CSS)))},e.prototype.Stop=function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,e.Log("%cTicker: Stopping interval!","color:cyan;".concat(e.GLOBAL_CSS))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,e.Log("%cTicker: Stopping RAF!","color:cyan;".concat(e.GLOBAL_CSS)))},t.Time.Ticker=e,t.Ticker=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i){if(!(this instanceof e))return new e(o,r,i);this.element=o,this.position=t.Vector2D(),this.scale=t.Vector2D(1,1),this.offset=t.Vector2D(r,i),this.eventData={position:this.position,native:null},this.element.addEventListener("mousemove",this.OnMove.bind(this)),this.element.addEventListener("mousedown",this.OnDown.bind(this)),this.element.addEventListener("mouseup",this.OnUp.bind(this)),this.element.addEventListener("mouseleave",this.OnLeave.bind(this)),this.element.addEventListener("wheel",this.OnWheel.bind(this),{passive:!0}),this.onMove=t.Event.LocalEvent(),this.onDown=t.Event.LocalEvent(),this.onUp=t.Event.LocalEvent(),this.onLeave=t.Event.LocalEvent(),this.onWheel=t.Event.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.eventData=null,e.prototype.OnMove=function(t){return t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1},e.prototype.OnDown=function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)},e.prototype.OnUp=function(t){t.stopPropagation(),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)},e.prototype.OnLeave=function(t){t.stopPropagation(),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)},e.prototype.OnWheel=function(t){t.stopPropagation(),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)},e.prototype.CalculatePosition=function(t,e){var o=this.position;o.Set(t,e),o.Subtract(this.element.offsetLeft,this.element.offsetTop),o.SubtractV(this.offset),o.DivideV(this.scale)},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y}}),t.Input.Mouse=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);this.element=o,this.element.setAttribute("tabindex","1"),this.element.focus(),this.element.addEventListener("keydown",this.OnKeyDown.bind(this)),this.element.addEventListener("keyup",this.OnKeyUp.bind(this)),this.onDown=t.Event.LocalEvent(),this.onUp=t.Event.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.OnKeyDown=function(t){t.preventDefault(),t.stopPropagation(),this.onDown.Dispatch(this.element,t)},e.prototype.OnKeyUp=function(t){t.preventDefault(),t.stopPropagation(),this.onUp.Dispatch(this.element,t)},t.Input.Keyboard=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i){if(!(this instanceof e))return new e(o,r,i);this.element=o,this.position=t.Vector2D(),this.scale=t.Vector2D(1,1),this.offset=t.Vector2D(r,i),this.eventData={position:this.position,native:null},this.element.addEventListener("touchmove",this.OnMove.bind(this)),this.element.addEventListener("touchstart",this.OnStart.bind(this),{passive:!0}),this.element.addEventListener("touchend",this.OnEnd.bind(this)),this.element.addEventListener("touchcancel",this.OnCancel.bind(this)),this.onMove=t.Event.LocalEvent(),this.onStart=t.Event.LocalEvent(),this.onEnd=t.Event.LocalEvent(),this.onCancel=t.Event.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.eventData=null,e.prototype.OnMove=function(t){return t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1},e.prototype.OnStart=function(t){t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)},e.prototype.OnEnd=function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)},e.prototype.OnCancel=function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)},e.prototype.CalculatePosition=function(t,e){var o=this.position;o.Set(t,e),o.Subtract(this.element.offsetLeft,this.element.offsetTop),o.SubtractV(this.offset),o.DivideV(this.scale)},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y}}),t.Input.Touch=e}},function(t,e){t.exports=function(t){"use strict";function e(){throw new Error("Cannot be instantiated")}e.Draw={},e.Draw.AABB2D=function(t,e,o){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.1,t.strokeStyle="rgba(100, 0, 100, 1)",t.fillStyle="rgba(0, 100, 0, 1)",o&&o.strokeStyle&&(t.strokeStyle=o.strokeStyle),o&&o.fillStyle&&(t.fillStyle=o.fillStyle),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),o&&o.noStroke||t.stroke(),o&&o.noFill||t.fill()},t.Debug=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n){if(!(this instanceof e))return new e(r,i,n);o.call(this,r,i),this.style=t.Style.CreateP(n),this.colorObj=t.Color()}var o=t.Math.Vector2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.colorObj=null,e.prototype.style=null,e.prototype.programController=null,e.prototype.bufferData=null,e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())},e.prototype.GetBufferData=function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData;return t[0]=this.x,t[1]=this.y,t[2]=this.colorObj.r,t[3]=this.colorObj.g,t[4]=this.colorObj.b,t[5]=this.colorObj.a,t[6]=this.style.pixel.size,t},e.prototype.UpdateInBuffer=function(t,e){t[e]=this.x,t[e+1]=this.y,t[e+2]=this.colorObj.r,t[e+3]=this.colorObj.g,t[e+4]=this.colorObj.b,t[e+5]=this.colorObj.a,t[e+6]=this.style.pixel.size},t.Path.Pixel=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n,s,a){if(!(this instanceof e))return new e(r,i,n,s,a);o.call(this,r,i,n,s),this.style=t.Style.CreateSSa(a)}var o=t.Geom.Line2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.style=null,e.prototype.programController=null,e.prototype.Draw=function(t){var e=this.s,o=this.e,r=this.style,i=r.stroke,n=r.shadow;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,o.y),t.closePath(),!0===n.applied&&n.Apply(t),!0===i.applied&&(i.Apply(t),t.stroke())},e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.s,this.e)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize())},t.Path.Line2D=e,t.Path.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n,s,a){if(!(this instanceof e))return new e(r,i,n,s,a);o.call(this,r,i,n,s),this.style=t.Style.CreateFSSa(a)}var o=t.Geom.AABB2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Draw=function(t){var e=this.tl,o=this.br,r=this.style,i=r.fill,n=r.stroke,s=r.shadow;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,e.y),t.lineTo(o.x,o.y),t.lineTo(e.x,o.y),t.closePath(),!0===s.applied&&s.Apply(t),!0===i.applied&&(i.Apply(t),t.fill()),!0===n.applied&&(n.Apply(t),t.stroke())},e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2)},t.Path.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i){if(!(this instanceof e))return new e(r,i);o.call(this,r),this.style=t.Style.CreateFSSa(i)}var o=t.Geom.Polygon2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Draw=function(t){var e=this.style,o=e.fill,r=e.stroke,i=e.shadow,n=this.vertices,s=n[0];t.beginPath(),t.moveTo(s.x,s.y);for(var a=1,l=n.length;a<l;++a)s=n[a],t.lineTo(s.x,s.y);t.closePath(),!0===i.applied&&i.Apply(t),!0===o.applied&&(o.Apply(t),t.fill()),!0===r.applied&&(r.Apply(t),t.stroke())},t.Path.Polygon2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n,s){if(!(this instanceof e))return new e(r,i,n,s);o.call(this,r,i,n),this.style=t.Style.CreateFSSa(s)}var o=t.Geom.Circle;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Draw=function(e){var o=this.center,r=this.style,i=r.fill,n=r.stroke,s=r.shadow;e.beginPath(),e.arc(o.x,o.y,this.radius,0,t.Math.PII,!1),e.closePath(),!0===s.applied&&s.Apply(e),!0===i.applied&&(i.Apply(e),e.fill()),!0===n.applied&&(n.Apply(e),e.stroke())},e.prototype.GLDraw=function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.center.x,this.center.y,this.radius)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2)},t.Path.Circle=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);if(o.call(this,r.x,r.y),this.positionReconfiguration=t.Vector2D(r.x,r.y),"string"==typeof r.canvas&&(r.canvas=document.getElementById(r.canvas)),this.canvas=r.canvas,this.w=r.canvas.width,this.h=r.canvas.height,"WebGL"===r.mode){if(this.gl=r.canvas.getContext("webgl",{antialias:r.antialias,preserveDrawingBuffer:!0}),null==this.gl&&(this.gl=r.canvas.getContext("experimental-webgl")),null==this.gl)throw new Error("WebGL is not supported!");this.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),this.usingWebGL=!0,!0!==r.noTicker&&(this.ticker=t.Time.Ticker(this.GLProcess.bind(this),60,r.halt)),this.GLConfig(this.gl)}else this.rc=r.canvas.getContext("2d"),!0!==r.noTicker&&(this.ticker=t.Time.Ticker(this.Process.bind(this),60,r.halt));null!=r.backgroundColor&&(this.backgroundColor=r.backgroundColor),!1===r.clear&&(this.clear=!1),!1===r.fill&&(this.fill=!1),null!=r.id&&(this.id=r.id),this.onProcess=t.Event.LocalEvent(),!0!==r.noMouse&&(this.mouse=t.Input.Mouse(r.canvas,r.x,r.y)),!0!==r.noKeyboard&&(this.keyboard=t.Input.Keyboard(r.canvas)),!0!==r.noTouch&&(this.touch=t.Input.Touch(r.canvas,r.x,r.y))}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.id=null,e.prototype.canvas=null,e.prototype.backgroundColor="rgba(10,20,30,1)",e.prototype.clear=!0,e.prototype.fill=!0,e.prototype.usingWebGL=!1,e.prototype.positionReconfiguration=null,e.prototype.canvasManager=null,e.prototype.mouse=null,e.prototype.keyboard=null,e.prototype.touch=null,e.prototype.PreDraw=function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation="source-over",!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)},e.prototype.GLConfig=function(t){null==t&&(t=this.gl),this.position.Set(0,0),this.scale.Set(2/this.w,-2/this.h),this.position.Add(-1,1),this.position.Add(this.positionReconfiguration.x*this.scale.x,this.positionReconfiguration.y*this.scale.y),this.UpdateTransform(),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},e.prototype.GLPreDraw=function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)},e.prototype.GLPostDraw=function(t){t.flush()},e.prototype.Process=function(t){this.Draw(this.rc),this.onProcess.Dispatch(this,t)},e.prototype.GLProcess=function(t){this.GLDraw(this.gl),this.GLPostDraw(this.gl),this.onProcess.Dispatch(this,t)},e.prototype.MixedProcess=function(t){!0===this.usingWebGL?(this.GLDraw(this.gl),this.GLPostDraw(this.gl)):this.Draw(this.rc),this.onProcess.Dispatch(this,t)},t.Entity.Stage2D=e,t.Stage2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);this.SetOptions(o),this.stages=[],this.ticker=t.Time.Ticker(this.Process.bind(this),60,o.halt)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.stages=null,e.prototype.currentStage=null,e.prototype.onlyCurrent=!1,e.prototype.options=null,e.prototype.ticker=null,e.prototype.SetOptions=function(t){null!=t&&(this.options=t)},e.prototype.CreateStage2D=function(e){var o=null;"string"==typeof e&&(o=e,e=null),null==e&&(e=this.options),null==e&&(e={}),null!==o&&(e.id=o);var r=document.createElement("canvas");null!=e.width&&(r.width=e.width),null!=e.height&&(r.height=e.height),null!=e.className&&(r.className=e.className),null==e.rootNode&&(e.rootNode=document.body),e.rootNode.appendChild(r),e.canvas=r,e.noTicker=!0,e.halt=!0;var i=t.Stage2D(e);return e.id=void 0,e.canvas=void 0,this.stages.push(i),i},e.prototype.GetStages=function(){for(var t,e=[],o=0,r=this.stages,i=r.length;o<i;++o){t=r[o];for(var n=0;n<arguments.length;++n)t.id===arguments[n]&&e.push(t)}return e},e.prototype.Process=function(t){for(var e=0,o=this.stages,r=o.length;e<r;++e)o[e].MixedProcess(t)},t.Entity.Stadium=e,t.Stadium=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n){if(!(this instanceof e))return new e(r,i,n);o.call(this,r,i),this.anchor=t.Vector2D(),this.SetPath(n)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.path=null,e.prototype.anchor=null,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(this.PreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t);var e=this.path;e&&e.Draw&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Draw(t)),this.children.length>0&&this.DrawChildren(t)}},e.prototype.GLDraw=function(t){if(this.GLPreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.path;e&&e.GLDraw&&!0===this.display&&e.GLDraw(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t))}},e.prototype.GetBufferData=function(){this.UpdateTransform();var t=this.transform.worldTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e},e.prototype.UpdateInBuffer=function(){this.UpdateTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.parent.childDataBuffer,o=this.bufferStartIndex;e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3],e[o+4]=t[4],e[o+5]=t[5],e[o+6]=t[6],e[o+7]=t[7],e[o+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,o+9)},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return this.path.IntersectsPoint(e)},e.prototype.SetPath=function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)},t.Entity.Graphic2D=e,t.Graphic2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.transform=t.Math.Basetransform2D(o,r),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=t.Math.Basetransform2D(),e.prototype.parent=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){return this.transform.worldTransform.Copy()},e.prototype.ComputeBounds=function(e){var o=e&&e.x?e.x:0,r=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=t.Geom.AABB2D(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},e.prototype.Destroy=function(){null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.fickleSplice(e))}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.unshift(t.fickleSplice(e))}},Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h},set:function(t){this.h=t}}),t.Entity.Plain2D=e,t.Plain2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,i){if(!(this instanceof e))return new e(t,r,i);o.call(this,t,r),void 0!==i&&(void 0!==i.w&&void 0!==i.h?(this.w=i.w,this.h=i.h):void 0!==i.GetLength?this.w=this.h=i.GetLength():void 0!==i.diameter?this.w=this.h=i.diameter:void 0!==i.aabb&&(this.w=i.aabb.w,this.h=i.aabb.h),this.path=i)}var o=t.Entity.Plain2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.path=null,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t);var e=this.path;e&&e.Draw&&!0===this.display&&e.Draw(t)}},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.DivideV(this.scale),this.path.IntersectsPoint(e)},t.Entity.Plaingraphic2D=e,t.Plaingraphic2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n){if(!(this instanceof e))return new e(r,i,n);o.call(this,r,i),this.anchor=t.Vector2D(0,0),this.clip=t.Geom.AABB2D(),this.shape=t.Geom.AABB2D(),null==n&&(n=e.DEFAULT_TEXTURE),this.SetTexture(n)}var o=t.Entity.Plain2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=null,e.BUILD_DEFAULT_TEXTURE=function(o){e.DEFAULT_TEXTURE=t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=t.Path.Polygon2D();return e.AddPoint(t.Vector2D(0,0)),e.AddPoint(t.Vector2D(64,0)),e.AddPoint(t.Vector2D(64,64)),e.AddPoint(t.Vector2D(0,64)),e.AddPoint(t.Vector2D(0,0)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(64,0)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(64,64)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#3399FF",e.style.stroke.lineWidth=3,t.Graphic2D(0,0,e)}),64,64,o),"DEFAULT_PLAINSPRITE_TEXTURE",64,64,64,64),delete e.BUILD_DEFAULT_TEXTURE},e.prototype.shape=null,e.prototype.clip=null,e.prototype.texture=null,e.prototype.anchor=null,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display)){var e=this.clip,o=e.tl,r=e.br,i=this.w,n=this.h,s=this.anchor;t.drawImage(this.texture.image,o.x,o.y,r.x,r.y,-i*s.x,-n*s.y,i,n)}},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.w*this.anchor.x,this.h*this.anchor.y),this.shape.IntersectsPoint(e)},e.prototype.SetTexture=function(t){this.texture=t,this.w=t.w,this.h=t.h,this.clip.Set(0,0,this.w,this.h),this.shape.SetC(this.clip)},t.Entity.Plainsprite=e,t.Plainsprite=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n){if(!(this instanceof e))return new e(r,i,n);o.call(this,r,i),void 0!==n&&(this.text=n),this.style=t.Style.CreateSaT()}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.text="",e.prototype.maxWidth=void 0,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.Draw=function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.DrawChildren(t)}},e.prototype.IntersectsPoint=function(){return!1},t.Entity.Text=e,t.Text=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n,s){if(!(this instanceof e))return new e(r,i,n,s);o.call(this,r,i),this.anchor=t.Vector2D(0,0),this.clip=t.Geom.AABB2D(),this.shape=t.Geom.AABB2D(),this.textureTransformation=t.Math.Matrix2D(),this.textureTranslation=t.Math.Matrix2D(),this.originalShape=t.Geom.AABB2D(),this.tint=t.Color(1,1,1,1),n instanceof t.GLTextureProgramController?(this.programController=n,null!=s?this.SetTexture(n["originalTexture"+s]):this.SetTexture(n.originalTexture0)):null==n?this.SetTexture(e.DEFAULT_TEXTURE):this.SetTexture(n)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=null,e.BUILD_DEFAULT_TEXTURE=function(o){e.DEFAULT_TEXTURE=t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=t.Path.Polygon2D();return e.AddPoint(t.Vector2D(0,0)),e.AddPoint(t.Vector2D(64,0)),e.AddPoint(t.Vector2D(64,64)),e.AddPoint(t.Vector2D(0,64)),e.AddPoint(t.Vector2D(0,0)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(64,0)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(64,64)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#00FFFF",e.style.stroke.lineWidth=3,t.Graphic2D(0,0,e)}),64,64,o),"DEFAULT_SPRITE_TEXTURE",64,64,64,64),delete e.BUILD_DEFAULT_TEXTURE},e.prototype.shape=null,e.prototype.originalShape=null,e.prototype.clip=null,e.prototype.texture=null,e.prototype.anchor=null,e.prototype.tint=null,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.interactive=!0,e.prototype.programController=null,e.prototype.textureTransformation=null,e.prototype.textureTranslation=null,e.prototype.animationController=null,e.prototype.Draw=function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display){var e=this.clip,o=e.tl,r=e.br,i=this.w,n=this.h,s=this.anchor;t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,o.x,o.y,r.x,r.y,-i*s.x,-n*s.y,i,n)}this.children.length>0&&this.DrawChildren(t)}},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.programController.Execute(this.transform.worldTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))},e.prototype.GetBufferData=function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),o=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var r=this.bufferData;return r.length=0,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=e[0],r[10]=e[1],r[11]=e[2],r[12]=e[3],r[13]=e[4],r[14]=e[5],r[15]=e[6],r[16]=e[7],r[17]=e[8],r[18]=o[0],r[19]=o[1],r[20]=o[2],r[21]=o[3],r[22]=o[4],r[23]=o[5],r[24]=o[6],r[25]=o[7],r[26]=o[8],r},e.prototype.UpdateInBuffer=function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),o=this.textureTransformation.AsArray(!0),r=this.parent.childDataBuffer,i=this.bufferStartIndex;r[i]=t[0],r[i+1]=t[1],r[i+2]=t[2],r[i+3]=t[3],r[i+4]=t[4],r[i+5]=t[5],r[i+6]=t[6],r[i+7]=t[7],r[i+8]=t[8],r[i+9]=e[0],r[i+10]=e[1],r[i+11]=e[2],r[i+12]=e[3],r[i+13]=e[4],r[i+14]=e[5],r[i+15]=e[6],r[i+16]=e[7],r[i+17]=e[8],r[i+18]=o[0],r[i+19]=o[1],r[i+20]=o[2],r[i+21]=o[3],r[i+22]=o[4],r[i+23]=o[5],r[i+24]=o[6],r[i+25]=o[7],r[i+26]=o[8]},e.prototype.UpdateTextureTransform=function(){var t=this.w/this.texture.fw,e=this.h/this.texture.fh;this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(t*this.clip.tl.x/this.w,e*this.clip.tl.y/this.h)},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint(e)},e.prototype.UpdateShape=function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)},e.prototype.SetTexture=function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.clip)},e.prototype.ClipReconfigure=function(t,e,o,r){var i=o/this.texture.fw,n=r/this.texture.fh,s=this.width,a=this.height;this.clip.Set(t,e,o,r),this.w=o,this.h=r,0!==s&&0!==a&&(this.width=s,this.height=a),this.textureTranslation.SetTransform(-o*this.anchor.x,-r*this.anchor.y,i,n),this.textureTransformation.SetTransform(i*this.clip.tl.x/o,n*this.clip.tl.y/r,i,n)},e.prototype.CreateAnimation=function(e){null===this.animationController&&(this.animationController=t.Animator.Controller(this));var o=this.animationController.CreateAnimation(e.id,e.rate);if(null!=e.spritesheet)for(var r=0;r<e.frames.length;++r)o.AddFrame(e.spritesheet.GetFrameById(e.frames[r]));return o},Object.defineProperty(e.prototype,"width",{get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}),t.Entity.Sprite=e,t.Sprite=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i,n,s){if(!(this instanceof e))return new e(r,i,n,s);null==n&&(n=e.DEFAULT_TEXTURE),o.call(this,r,i,n,s),this.patternOffset=t.Vector2D()}var o=t.Entity.Sprite;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=null,e.BUILD_DEFAULT_TEXTURE=function(o){e.DEFAULT_TEXTURE=t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=t.Path.Polygon2D();return e.AddPoint(t.Vector2D(0,0)),e.AddPoint(t.Vector2D(64,0)),e.AddPoint(t.Vector2D(64,64)),e.AddPoint(t.Vector2D(0,64)),e.AddPoint(t.Vector2D(0,0)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(64,0)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(64,64)),e.AddPoint(t.Vector2D(32,32)),e.AddPoint(t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#446644",e.style.stroke.lineWidth=3,t.Graphic2D(0,0,e)}),64,64,o),"DEFAULT_TILESPRITE_TEXTURE",64,64,64,64),delete e.BUILD_DEFAULT_TEXTURE},e.prototype.pattern=null,e.prototype.patternOffset=null,e.prototype.Draw=function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display&&null!==this.pattern&&(t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.DrawChildren(t))},e.prototype.GeneratePattern=function(t,e,o){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=o,this.scale.Set(1)):(this.width=e,this.height=o,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))},e.prototype.OffsetPattern=function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)},e.prototype.SetPatternOffset=function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)},e.prototype.GetPatternOffset=function(){return this.patternOffset},t.Entity.Tilesprite=e,t.Tilesprite=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this),r&&(this.id=parseInt(r.id),this.cx=parseInt(r.x),this.cy=parseInt(r.y),this.w=parseInt(r.width),this.h=parseInt(r.height),this.xoffset=parseInt(r.xoffset),this.yoffset=parseInt(r.yoffset),this.xadvance=parseInt(r.xadvance),this.kernings=[],this.translation=t.Matrix2D(),this.transformation=t.Matrix2D())}var o=t.Entity.CoreEntity2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.id=0,e.prototype.xoffset=0,e.prototype.yoffset=0,e.prototype.xadvance=0,e.prototype.yadvance=0,e.prototype.kernings=null,e.prototype.translation=null,e.prototype.transformation=null,e.prototype.ApplyKernings=function(t){for(var e,o=0,r=t.length;o<r;++o)e=t[o].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))},e.prototype.Crunch=function(t){if(this.position.Set(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings.length>0&&this.kernings.length>0))for(var e=0,o=this.kernings,r=o.length;e<r;e+=3)if(o[e+1]===t.id){this.x+=o[e+2];break}this.position.Add(this.xoffset,this.yoffset)},e.prototype.UpdateMatrices=function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,o=this.height/t.fh;this.UpdateTransform(),this.translation.SetTransform(0,0,e,o),this.transformation.SetTransform(e*this.cx/this.width,o*this.cy/this.height,e,o)}},t.Entity.Char=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,i,n,s){if(!(this instanceof e))return new e(t,r,i,n,s);o.call(this,t,r,i),this.fontData=n,this.lineHeight=n.font.common.attributes.lineHeight,null!=s&&(this.text=s),this.chars=[],this.ComputeText()}var o=t.Entity.Sprite,r=t.Entity.Char;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.maxWidth=1024,e.prototype.fontData=null,e.prototype.text="",e.prototype.chars=null,e.prototype.lineHeight=0,e.prototype.Draw=function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.DrawText(t)),this.children.length>0&&this.DrawChildren(t))},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.GLDrawText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))},e.prototype.DrawText=function(t){for(var e,o=0,r=this.chars,i=r.length;o<i;++o)e=r[o],t.drawImage(this.texture.image,e.cx,e.cy,e.width,e.height,e.position.x,e.position.y,e.width,e.height)},e.prototype.GLDrawText=function(){for(var t,e=0,o=this.chars,r=o.length;e<r;++e)t=o[e],this.programController.Execute(t.transform.worldTransform.AsArray(!0),t.translation.AsArray(!0),t.transformation.AsArray(!0),this.tint.channel,0)},e.prototype.GetBufferData=t.Entity.Container2D.prototype.GetBufferData,e.prototype.UpdateInBuffer=t.Entity.Container2D.prototype.UpdateInBuffer,e.prototype.ComputeText=function(){this.UpdateTransform(),this.chars.length=0;var t=null;this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var e,o,i=0,n=0,s=!1,a=0,l=0,h=0,p=0,u=0,c=this.chars,f=this.text,y=f.length;u<y;++u){o=c[u-1-n];var d=f.charCodeAt(u);10!==d?(e=new r(this.GetCharData(d)),null!==t&&e.ApplyKernings(t),e.Crunch(o),h=e.position.x+e.width,p=e.position.y+e.height,(h>this.maxWidth||!0===s)&&(e.position.Set(0),e.yadvance=this.lineHeight*++i,e.position.Add(e.xoffset,e.yoffset+e.yadvance),s=!1),h>a&&(a=h),p>l&&(l=p),e.parent=this,e.UpdateMatrices(),c.push(e)):(n++,s=!0)}this.w=a,this.h=l},e.prototype.GetCharData=function(t){for(var e=0,o=this.fontData.font.chars.char,r=o.length;e<r;++e)if(parseInt(o[e].attributes.id)===t)return o[e].attributes},t.Entity.BitmapText=e,t.BitmapText=e}},function(t,e){t.exports=function(t){"use strict";function e(r,i){if(!(this instanceof e))return new e(r,i);o.call(this),this.focus=r,null!=i&&(this.target=i),this.velocity=t.Vector2D()}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.focus=null,e.prototype.target=null,e.prototype.velocity=null,e.prototype.stopRadiusSq=1e3,e.prototype.EPSILON=2e-4,e.prototype.Process=function(){var t=this.target;if(null!==t){var e=t.position.Copy();e.Invert(),e.AddV(this.focus);var o=this.position.SubtractVC(e),r=o.GetLengthSquared();if(r<this.stopRadiusSq)return;r*=this.EPSILON;var i=o.GetAngle();this.velocity.Set(r*Math.cos(i),r*Math.sin(i)),this.position.SubtractV(this.velocity)}},e.prototype.SetTarget=function(t){this.target=t},t.Entity.Camera2D=e,t.Camera2D=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}function o(e){if(!(this instanceof o))return new o(e);this.velocity=t.Vector2D(),this.torque=0,this.spin=0,this.growth=t.Vector2D(1,1),this.acceleration=t.Vector2D(1,1),this.gravity=t.Vector2D(),this.Renew(e)}var r=t.Utils.MinMaxOrValue,i=t.Utils.RandomInArray,n=t.Math.Oscillate,s=t.Utils.RandomInteger;e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.velocityX=null,e.prototype.velocityY=null,e.prototype.torque=null,e.prototype.accelerationX=null,e.prototype.accelerationY=null,e.prototype.spin=null,e.prototype.growthX=null,e.prototype.growthY=null,e.prototype.gravityX=null,e.prototype.gravityY=null,e.prototype.CreateOscillatingObject=function(t,e,o,r){if(null!==this[t])throw new Error("Invalid key");this[t]={from:e,to:o,amplitude:r}},e.prototype.SetOscillatingObject=function(t,e,o,r){var i=this[t];if(null==i)return this.CreateOscillatingObject(t,e,o,r);i.from=e,i.to=o,i.amplitude=r},o.prototype=Object.create(null),o.prototype.constructor=o,o.Pool=t.Utils.Pool(o),o.Oscillation=e,o.Pool.Retrieve=function(t){0===this.objects.length&&this.Flood();var e=this.objects.pop();return e.Renew(t),e},o.USE_POOL=!0,o.prototype.velocity=null,o.prototype.torque=null,o.prototype.spin=null,o.prototype.growth=null,o.prototype.acceleration=null,o.prototype.fade=!1,o.prototype.deflate=!1,o.prototype.gravity=null,o.prototype.lifespan=0,o.prototype.lifespanTot=0,o.prototype.dead=!1,o.prototype.entity=null,o.prototype.system=null,o.prototype.oscillation=null,o.prototype.oscillationOffset=0,o.prototype.Process=function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTot){var t=this.entity,e=this.velocity,o=1-this.lifespan/this.lifespanTot,r=this.oscillation;if(e.AddV(this.gravity),e.MultiplyV(this.acceleration),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=o),!0===this.deflate?t.scale.Set(o):t.scale.MultiplyV(this.growth),t.rotation+=this.spin,null!==r){var i=this.lifespan+this.oscillationOffset;null!=r.torque&&(this.torque=n(i,r.torque.from,r.torque.to,r.torque.amplitude)),null!=r.spin&&(this.spin=n(i,r.spin.from,r.spin.to,r.spin.amplitude)),null!=r.velocityX&&(this.velocity.x=n(i,r.velocityX.from,r.velocityX.to,r.velocityX.amplitude)),null!=r.velocityY&&(this.velocity.y=n(i,r.velocityY.from,r.velocityY.to,r.velocityY.amplitude)),null!=r.gravityX&&(this.gravity.x=n(i,r.gravityX.from,r.gravityX.to,r.gravityX.amplitude)),null!=r.gravityY&&(this.gravity.y=n(i,r.gravityY.from,r.gravityY.to,r.gravityY.amplitude)),null!=r.accelerationX&&(this.acceleration.x=n(i,r.accelerationX.from,r.accelerationX.to,r.accelerationX.amplitude)),null!=r.accelerationY&&(this.acceleration.y=n(i,r.accelerationY.from,r.accelerationY.to,r.accelerationY.amplitude)),null!=r.growthX&&(this.growth.x=n(i,r.growthX.from,r.growthX.to,r.growthX.amplitude)),null!=r.growthY&&(this.growth.y=n(i,r.growthY.from,r.growthY.to,r.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1},o.prototype.Renew=function(o){if(null!=o){this.dead=!1;var i=this.entity;if(null!=o.path)null===i?i=this.entity=t.Graphic2D(0,0,o.path):this.ResetEntity();else{if(null==o.texture)throw new Error("Path or Texture needed!");null===i?(i=this.entity=t.Sprite(0,0,o.texture),null!=o.anchor&&(i.anchor.Set(o.anchor),i.UpdateTextureTransform())):this.ResetEntity(),null!=o.frames&&(o.frames[s(0,o.frames.length-1)].Apply(i),i.scale.Set(1),i.UpdateTextureTransform())}if(this.RenewVector(o.position,i.position),this.RenewVector(o.velocity,this.velocity),this.RenewVector(o.gravity,this.gravity),this.RenewVector(o.acceleration,this.acceleration),this.RenewVector(o.growth,this.growth),null!=o.rotation&&(i.rotation=r(o.rotation)),null!=o.lifespan&&this.SetLifespan(o.lifespan),null!=o.torque&&(this.torque=r(o.torque)),null!=o.spin&&(this.spin=r(o.spin)),null!=o.fade&&(this.fade=o.fade),null!=o.deflate&&(this.deflate=o.deflate),null!=o.oscillation){var n=o.oscillation,a=this.oscillation;null===a&&(a=this.oscillation=e()),null!=n.offset&&(this.oscillationOffset=r(n.offset)),null!=n.torque&&a.SetOscillatingObject("torque",n.torque.from,n.torque.to,n.torque.amplitude),null!=n.spin&&a.SetOscillatingObject("spin",n.spin.from,n.spin.to,n.spin.amplitude),null!=n.velocity&&(null!=n.velocity.x&&a.SetOscillatingObject("velocityX",n.velocity.x.from,n.velocity.x.to,n.velocity.x.amplitude),null!=n.velocity.y&&a.SetOscillatingObject("velocityY",n.velocity.y.from,n.velocity.y.to,n.velocity.y.amplitude)),null!=n.gravity&&(null!=n.gravity.x&&a.SetOscillatingObject("gravityX",n.gravity.x.from,n.gravity.x.to,n.gravity.x.amplitude),null!=n.gravity.y&&a.SetOscillatingObject("gravityY",n.gravity.y.from,n.gravity.y.to,n.gravity.y.amplitude)),null!=n.acceleration&&(null!=n.acceleration.x&&a.SetOscillatingObject("accelerationX",n.acceleration.x.from,n.acceleration.x.to,n.acceleration.x.amplitude),null!=n.acceleration.y&&a.SetOscillatingObject("accelerationY",n.acceleration.y.from,n.acceleration.y.to,n.acceleration.y.amplitude)),null!=n.growth&&(null!=n.growth.x&&a.SetOscillatingObject("growthX",n.growth.x.from,n.growth.x.to,n.growth.x.amplitude),null!=n.growth.y&&a.SetOscillatingObject("growthY",n.growth.y.from,n.growth.y.to,n.growth.y.amplitude))}}},o.prototype.RenewVector=function(t,e){null!=t&&(null!=t.points?e.SetV(i(t.points)):(null!=t.x&&(e.x=r(t.x)),null!=t.y&&(e.y=r(t.y))))},o.prototype.SetLifespan=function(t){this.lifespan=0,this.lifespanTot=t},o.prototype.ResetEntity=function(){var t=this.entity;t.scale.Set(1),t.alpha=1,t.display=!0,t.rotation=0},o.prototype.Destroy=function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),o.USE_POOL&&o.Pool.Store(this),!0)},o.Pool.Flood(function(){},1e3),t.Particle=o}},function(t,e){t.exports=function(t){"use strict";function e(r,i){if(!(this instanceof e))return new e(r,i);o.call(this,r,i),this.particles=[],this.deletionTimer=t.Timer(60),this.deletionTimer.onFinish.Add(this.HandleParticleDeletion,this),this.deletionTimer.Start()}var o=t.Entity.Container2D,r=t.Particle;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.particles=null,e.prototype.deletionTimer=null,e.prototype.Process=function(){this.HandleParticles(),this.deletionTimer.Process()},e.prototype.HandleParticles=function(){for(var t=0,e=this.particles,o=e.length;t<o;++t)e[t].Process()},e.prototype.HandleParticleDeletion=function(){for(var t,e=0,o=this.particles,r=o.length;e<r;++e)(t=o[e])&&t.Destroy(!0)&&e--;this.deletionTimer.Start()},e.prototype.AddParticle=function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t},e.prototype.RemoveParticle=function(t){var e=this.particles,o=e.indexOf(t);if(-1!==o)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(o)},e.prototype.Emit=function(t){for(var e=0;e<t.amount;++e)!0===r.USE_POOL?this.AddParticle(r.Pool.Retrieve(t)):this.AddParticle(r(t))},t.ParticleSystem=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i,n,s){if(!(this instanceof e))return new e(t,o,r,i,n,s);this.rate=n,this.timer=n,this.x=t,this.y=o,this.w=r,this.h=i,null!=s&&(this.id=s)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.id=null,e.prototype.x=0,e.prototype.y=0,e.prototype.w=0,e.prototype.h=0,e.prototype.rate=0,e.prototype.timer=0,e.prototype.nextFrameIndex=null,e.prototype.Process=function(){return this.timer--<=0&&(this.Reset(),!0)},e.prototype.Apply=function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)},e.prototype.Reset=function(){this.timer=this.rate},t.Animator.Frame=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i){if(!(this instanceof e))return new e(o,r,i);this.frames=[],this.controller=o,this.sprite=o.sprite,this.id=r,this.onEnd=t.Event.LocalEvent(),this.onStop=t.Event.LocalEvent(),this.onStart=t.Event.LocalEvent(),null!=i&&(this.rate=i)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.currentFrame=0,e.prototype.currentFrameIndex=0,e.prototype.playing=!1,e.prototype.id=null,e.prototype.rate=60,e.prototype.timer=0,e.prototype.reverse=!1,e.prototype.sprite=null,e.prototype.overrideFrameRate=!1,e.prototype.CreateFrame=function(e,o,r,i,n){n=null==n?this.rate:n,this.frames.push(t.Animator.Frame(e,o,r,i,n))},e.prototype.AddFrame=function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)},e.prototype.GenerateFrames=function(t,e,o,r,i,n){n=null==n?{}:n;for(var s,a=0,l=o/r;a<i;++a)s=n[a],this.CreateFrame(a%l*t,(a/l|0)*e,t,e,s)},e.prototype.SetFrame=function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))},e.prototype.SetFrameById=function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)},e.prototype.GetFrameById=function(t,e){for(var o=0,r=this.frames;o<r.length;++o)if(r[o].id===t)return!0===e?o:r[o]},e.prototype.Start=function(){this.playing=!0,this.onStart.Dispatch()},e.prototype.Stop=function(){this.playing=!1,this.onStop.Dispatch()},e.prototype.Process=function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())},e.prototype.NextFrame=function(){var t=this.frames,e=t.length,o=!1;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=e?(this.currentFrameIndex=0,o=!0):this.currentFrameIndex<0&&(this.currentFrameIndex=e-1,o=!0),this.currentFrame=t[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===o&&this.onEnd.Dispatch()},e.prototype.Clear=function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate},e.prototype.Restart=function(t){this.SetFrame(t),this.ResetAllFrames(),this.Start(),this.timer=this.rate},e.prototype.Reset=function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1},e.prototype.ResetAllFrames=function(){for(var t,e=0,o=this.frames,r=o.length;e<r;++e)t=o[e],t.Reset()},t.Animator.Animation=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.animations=[],null!=t&&(this.sprite=t)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.currentAnimation=null,e.prototype.sprite=null,e.prototype.CreateAnimation=function(e,o){var r=t.Animator.Animation(this,e,o);return this.animations.push(r),r},e.prototype.AddAnimation=function(t){t.controller=this,this.animations.push(t)},e.prototype.GetAnimationById=function(t){for(var e,o=0,r=this.animations,i=r.length;o<i;++o)if((e=r[o])&&e.id===t)return e;return null},e.prototype.PlayAnimation=function(t,e){var o=this.GetAnimationById(t);null!==o&&(this.currentAnimation=o,o.Restart(e))},e.prototype.StopCurrentAnimation=function(){null!==this.currentAnimation&&this.currentAnimation.Stop()},e.prototype.Process=function(){var t=this.currentAnimation;null!==t&&t.Process()},t.Animator.Controller=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i){if(!(this instanceof e))return new e(o,r,i);this.imageCache=t.Utils.Cache(Image),this.basicTextureCache=t.Utils.Cache(t.Texture.BasicTexture),this.onImageLoaded=t.Event.LocalEvent(),this.onComplete=t.Event.LocalEvent(),null!=i&&this.onComplete.Add(i,this),null!=o&&this.Load(o,r)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.imageCache=null,e.prototype.basicTextureCache=null,e.prototype.onImageLoaded=null,e.prototype.onComplete=null,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.createTextures=!1,e.prototype.Load=function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];if(null!=e){var o=new Image;o.onload=this.OnLoad.bind(this),o.onerror=this.OnError.bind(this),o.src=e.src,o.id=e.id,o.data=Object.create(null),o.data.w=e.w,o.data.h=e.h,o.data.fw=e.fw,o.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})},e.prototype.OnLoad=function(e){var o=e.currentTarget;delete o.onload,delete o.onerror,this.imageCache.StoreSafe(o),!0===this.createTextures&&this.basicTextureCache.StoreSafe(t.Texture.BasicTexture(o,null,o.data.w,o.data.h,o.data.fw,o.data.fh)),this.onImageLoaded.Dispatch(o,{count:this.count}),this.Haul(++this.count)},e.prototype.OnError=function(){throw new Error("Request failed")},e.prototype.GetImage=function(t){return this.imageCache.GetById(t)},e.prototype.GetBasicTexture=function(t){return this.basicTextureCache.GetById(t)},t.Load.ImageLoader=e,t.ImageLoader=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.XHRcache=t.Utils.Cache(XMLHttpRequest),this.dataCache=t.Utils.Cache(),this.onXHRLoaded=t.Event.LocalEvent(),this.onComplete=t.Event.LocalEvent(),null!=r&&this.onComplete.Add(r,this),null!=o&&this.Load(o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.XHRcache=null,e.prototype.dataCache=null,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.onXHRLoaded=null,e.prototype.onComplete=null,e.prototype.Load=function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];if(null!=e){var o=new XMLHttpRequest;switch(o.open("GET",e.src),e.type){case"json":o.onreadystatechange=this.OnLoadJSON.bind(this);break;default:o.onreadystatechange=this.OnLoadXML.bind(this)}o.onerror=this.OnError.bind(this),null!=o.data?o.data.id=e.id:o.data={id:e.id},o.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})},e.prototype.OnLoadXML=function(e){var o=e.currentTarget;200!==o.status&&null==o.responseText||4!==o.readyState||(o.onload=null,o.onerror=null,this.XHRcache.StoreSafe(o),this.dataCache.Store({id:o.data.id,data:t.Utils.XMLToJSON(o.responseText,!0)}),this.onXHRLoaded.Dispatch(o,{count:this.count}),this.Haul(++this.count),o.abort())},e.prototype.OnLoadJSON=function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())},e.prototype.OnError=function(t){throw console.error(t),new Error("Request failed")},e.prototype.GetXHR=function(t){return this.XHRcache.GetById(t)},e.prototype.GetData=function(t){return this.dataCache.GetById(t).data},t.Load.XHRLoader=e,t.XHRLoader=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.spritesheetCache=t.Utils.Cache(t.Texture.Spritesheet),this.xhrLoader=t.Load.XHRLoader(),this.imageLoader=t.Load.ImageLoader(),this.onComplete=t.Event.LocalEvent(),this.onSpritesheetLoaded=t.Event.LocalEvent(),this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=r&&this.onComplete.Add(r,this),null!=o&&this.Load(o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.xhrLoader=null,e.prototype.imageLoader=null,e.prototype.spritesheetCache=null,e.prototype.onSpritesheetLoaded=null,e.prototype.onComplete=null,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.pairCount=0,e.prototype.tempBasicTexture=null,e.prototype.tempData=null,e.prototype.Load=function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))},e.prototype.OnPartLoaded=function(){if(2==++this.pairCount){var e=this.tempData.meta.size;this.tempBasicTexture.fw=e.w,this.tempBasicTexture.fh=e.h;var o=t.Texture.Spritesheet(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(o),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(o,{count:this.count}),this.Haul(++this.count)}},e.prototype.OnPartXHRLoaded=function(t){this.tempData=this.xhrLoader.GetData(t.target.data.id),this.OnPartLoaded()},e.prototype.OnPartImageLoaded=function(t){this.tempBasicTexture=this.imageLoader.GetBasicTexture(t.target.id),this.OnPartLoaded()},e.prototype.GetSpritesheet=function(t){return this.spritesheetCache.GetById(t)},t.Load.SpritesheetLoader=e,t.SpritesheetLoader=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);this.gl=t,this.data=Object.create(null),null!=t&&null!=o&&this.Init(o.v,o.f)}e.prototype=Object.create(null),e.prototype.constructor=e,e.LAST_USED_CONTROLLER=null,e.prototype.program=null,e.prototype.gl=null,e.prototype.attributes=null,e.prototype.uniforms=null,e.prototype.data=null,e.prototype.Init=function(t,e){var o=this.gl,r=this.CreateShader(t,o.VERTEX_SHADER),i=this.CreateShader(e,o.FRAGMENT_SHADER),n=this.program=o.createProgram();if(o.attachShader(n,r),o.attachShader(n,i),o.linkProgram(n),!o.getProgramParameter(n,o.LINK_STATUS)){var s=o.getProgramInfoLog(n);throw new Error("Program link failed:"+s)}o.detachShader(n,r),o.detachShader(n,i),o.deleteShader(r),o.deleteShader(i),this.attributes={},this.uniforms={}},e.prototype.CreateShader=function(t,e){var o=this.gl,r=o.createShader(e);if(o.shaderSource(r,t),o.compileShader(r),!o.getShaderParameter(r,o.COMPILE_STATUS)){var i=o.getShaderInfoLog(r);throw new Error("Shader compilation failed:"+i)}return r},e.prototype.AssignAttribute=function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)},e.prototype.AssignUniform=function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)},e.prototype.Execute=function(){},t.Controller.GLProgramController=e,t.GLProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.LINE2D),this.Initialise()}var o=t.Controller.GLProgramController;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.essenceBuffer=null,e.prototype.vertices=null,e.prototype.color=null,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=t.Color(),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")},e.prototype.Execute=function(t,e,r){var i=this.gl,n=this.attributes,s=this.uniforms,a=this.vertices,l=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=r.x,a[3]=r.y,this!==o.LAST_USED_CONTROLLER&&(i.useProgram(this.program),o.LAST_USED_CONTROLLER=this),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,a),i.enableVertexAttribArray(n.aPosition),i.vertexAttribPointer(n.aPosition,2,i.FLOAT,!1,0,0),i.uniformMatrix3fv(s.uProjection,!1,t),i.uniform4f(s.uColor,l[0],l[1],l[2],l[3]),i.drawArrays(i.LINES,0,2)},t.Controller.GLLine2DProgramController=e,t.GLLine2DProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.RECTANGLE),this.Initialise()}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.geometricBuffer=null,e.prototype.vertices=null,e.prototype.fillColor=null,e.prototype.outlineColor=null,e.prototype.outline=5,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array(t.Math.TriRectArray(0,0,1,1)),this.fillColor=t.Color(),this.outlineColor=t.Color(),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")},e.prototype.Execute=function(t,e,i,n,s){var a=this.gl,l=this.attributes,h=this.uniforms,p=this.vertices,u=this.fillColor.channel,c=this.outlineColor.channel;r(e,i,n,s,p),this!==o.LAST_USED_CONTROLLER&&(a.useProgram(this.program),o.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,p),a.enableVertexAttribArray(l.aPosition),a.vertexAttribPointer(l.aPosition,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(h.uProjection,!1,t),a.uniform4f(h.uFillColor,u[0],u[1],u[2],u[3]),a.uniform4f(h.uOutlineColor,c[0],c[1],c[2],c[3]),a.uniform1f(h.uOutline,this.outline),a.uniform2f(h.uSize,n,s),a.drawArrays(a.TRIANGLE_STRIP,0,6)},t.Controller.GLRectangleProgramController=e,t.GLRectangleProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.CIRCLE),this.Initialise()}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.essenceBuffer=null,e.prototype.vertices=null,e.prototype.fillColor=null,e.prototype.outlineColor=null,e.prototype.outline=5,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array(t.Math.TriRectArray(0,0,1,1)),this.fillColor=t.Color(),this.outlineColor=t.Color(),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")},e.prototype.Execute=function(t,e,i,n){var s=this.gl,a=this.attributes,l=this.uniforms,h=this.vertices,p=this.fillColor.channel,u=this.outlineColor.channel;r(e-n,i-n,2*n,2*n,h),this!==o.LAST_USED_CONTROLLER&&(s.useProgram(this.program),o.LAST_USED_CONTROLLER=this),s.bindBuffer(s.ARRAY_BUFFER,this.essenceBuffer),s.bufferSubData(s.ARRAY_BUFFER,0,h),s.enableVertexAttribArray(a.aPosition),s.vertexAttribPointer(a.aPosition,2,s.FLOAT,!1,0,0),s.uniformMatrix3fv(l.uProjection,!1,t),s.uniform4f(l.uFillColor,p[0],p[1],p[2],p[3]),s.uniform4f(l.uOutlineColor,u[0],u[1],u[2],u[3]),s.uniform1f(l.uOutline,this.outline),s.uniform1f(l.uRadius,n),s.drawArrays(s.TRIANGLE_STRIP,0,6)},t.Controller.GLCircleProgramController=e,t.GLCircleProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.TEXTURE_2D),this.Initialise()}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.originalTexture0=null,e.prototype.boundTexture0=null,e.prototype.essenceBuffer0=null,e.prototype.originalTexture1=null,e.prototype.boundTexture1=null,e.prototype.essenceBuffer1=null,e.prototype.originalTexture2=null,e.prototype.boundTexture2=null,e.prototype.essenceBuffer2=null,e.prototype.originalTexture3=null,e.prototype.boundTexture3=null,e.prototype.essenceBuffer3=null,e.prototype.lastUsedUnit=0,e.prototype.Initialise=function(){this.AssignAttribute("aPosition0"),this.AssignAttribute("aTexCoord0"),this.AssignAttribute("aPosition1"),this.AssignAttribute("aTexCoord1"),this.AssignAttribute("aPosition2"),this.AssignAttribute("aTexCoord2"),this.AssignAttribute("aPosition3"),this.AssignAttribute("aTexCoord3"),this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")},e.prototype.BindBasicTexture=function(t,e){(null==e||e<0||e>3)&&(e=0);var o=this.gl;t.uniformId=e,this["originalTexture"+e]=t,this["boundTexture"+e]=o.createTexture(),this["essenceBuffer"+e]=o.createBuffer();var i=r(0,0,t.w,t.h);i.push.apply(i,r(0,0,1,1)),o.bindTexture(o.TEXTURE_2D,this["boundTexture"+e]),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t.image),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.bindBuffer(o.ARRAY_BUFFER,this["essenceBuffer"+e]),o.bufferData(o.ARRAY_BUFFER,new Float32Array(i),o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,null),o.bindTexture(o.TEXTURE_2D,null)},e.prototype.BindUnit=function(t,e,o,r){null!=this["boundTexture"+r]&&(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this["boundTexture"+r]),t.bindBuffer(t.ARRAY_BUFFER,this["essenceBuffer"+r]),t.enableVertexAttribArray(o["aPosition"+r]),t.vertexAttribPointer(o["aPosition"+r],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o["aTexCoord"+r]),t.vertexAttribPointer(o["aTexCoord"+r],2,t.FLOAT,!1,0,48))},e.prototype.Execute=function(t,e,r,i,n){var s=this.gl,a=this.attributes,l=this.uniforms;this!==o.LAST_USED_CONTROLLER?(s.useProgram(this.program),this.BindUnit(s,l,a,0),this.BindUnit(s,l,a,1),this.BindUnit(s,l,a,2),this.BindUnit(s,l,a,3),s.uniform1f(l.uUnitId,n),s.uniform1i(l.uImage,n),o.LAST_USED_CONTROLLER=this,this.lastUsedUnit=n):n!==this.lastUsedUnit&&(s.uniform1f(l.uUnitId,n),s.uniform1i(l.uImage,n),this.lastUsedUnit=n),s.uniform4fv(l.uTint,i),s.uniformMatrix3fv(l.uProjection,!1,t),s.uniformMatrix3fv(l.uTranslation,!1,e),s.uniformMatrix3fv(l.uTransformation,!1,r),s.drawArrays(s.TRIANGLE_STRIP,0,6)},t.Controller.GLTextureProgramController=e,t.GLTextureProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.TEXTURE_2D_BATCH)}var o=t.Controller.GLProgramController,r=t.Math.TriRectArray;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.originalTexture=null,e.prototype.boundTexture=null,e.prototype.essenceBuffer=null,e.prototype.dataBuffer=null,e.prototype.indexBuffer=null,e.prototype.previousNumberOfElements=null,e.prototype.BindBasicTexture=function(t){var e=this.gl;this.aia=e.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,this.boundTexture=e.createTexture(),this.essenceBuffer=e.createBuffer(),this.dataBuffer=e.createBuffer();var o=r(0,0,t.w,t.h);o.push.apply(o,r(0,0,1,1)),e.bindTexture(e.TEXTURE_2D,this.boundTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")},e.prototype.Execute=function(t,e){var r=this.gl,i=this.aia,n=this.attributes,s=this.uniforms;this!==o.LAST_USED_CONTROLLER&&(r.useProgram(this.program),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.boundTexture),r.uniform1i(s.uImage,0),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.enableVertexAttribArray(n.aPosition),r.vertexAttribPointer(n.aPosition,2,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(n.aPosition,0),r.enableVertexAttribArray(n.aTexCoord),r.vertexAttribPointer(n.aTexCoord,2,r.FLOAT,!1,0,48),i.vertexAttribDivisorANGLE(n.aTexCoord,0),o.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?r.bufferData(r.ARRAY_BUFFER,t,r.DYNAMIC_DRAW):r.bufferSubData(r.ARRAY_BUFFER,0,t),r.enableVertexAttribArray(n.aProjection1),r.vertexAttribPointer(n.aProjection1,3,r.FLOAT,!1,108,0),i.vertexAttribDivisorANGLE(n.aProjection1,1),r.enableVertexAttribArray(n.aProjection2),r.vertexAttribPointer(n.aProjection2,3,r.FLOAT,!1,108,12),i.vertexAttribDivisorANGLE(n.aProjection2,1),r.enableVertexAttribArray(n.aProjection3),r.vertexAttribPointer(n.aProjection3,3,r.FLOAT,!1,108,24),i.vertexAttribDivisorANGLE(n.aProjection3,1),r.enableVertexAttribArray(n.aTranslation1),r.vertexAttribPointer(n.aTranslation1,3,r.FLOAT,!1,108,36),i.vertexAttribDivisorANGLE(n.aTranslation1,1),r.enableVertexAttribArray(n.aTranslation2),r.vertexAttribPointer(n.aTranslation2,3,r.FLOAT,!1,108,48),i.vertexAttribDivisorANGLE(n.aTranslation2,1),r.enableVertexAttribArray(n.aTranslation3),r.vertexAttribPointer(n.aTranslation3,3,r.FLOAT,!1,108,60),i.vertexAttribDivisorANGLE(n.aTranslation3,1),r.enableVertexAttribArray(n.aTransformation1),r.vertexAttribPointer(n.aTransformation1,3,r.FLOAT,!1,108,72),i.vertexAttribDivisorANGLE(n.aTransformation1,1),r.enableVertexAttribArray(n.aTransformation2),r.vertexAttribPointer(n.aTransformation2,3,r.FLOAT,!1,108,84),i.vertexAttribDivisorANGLE(n.aTransformation2,1),r.enableVertexAttribArray(n.aTransformation3),r.vertexAttribPointer(n.aTransformation3,3,r.FLOAT,!1,108,96),i.vertexAttribDivisorANGLE(n.aTransformation3,1),i.drawArraysInstancedANGLE(r.TRIANGLE_STRIP,0,6,e)},t.Controller.GLTextureBatchProgramController=e,t.GLTextureBatchProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);o.call(this,r,t.SHADER_CODE.PIXEL_BATCH),this.Initialise()}var o=t.Controller.GLProgramController;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.dataBuffer=null,e.prototype.prevNumElements=0,e.prototype.Initialise=function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")},e.prototype.Execute=function(t,e){var r=this.gl,i=this.attributes;o.LAST_USED_CONTROLLER!==this&&r.useProgram(this.program),r.bindBuffer(r.ARRAY_BUFFER,this.dataBuffer),e!==this.prevNumElements?r.bufferData(r.ARRAY_BUFFER,t,r.DYNAMIC_DRAW):r.bufferSubData(r.ARRAY_BUFFER,0,t),r.enableVertexAttribArray(i.aProjection1),r.vertexAttribPointer(i.aProjection1,3,r.FLOAT,!1,64,0),r.enableVertexAttribArray(i.aProjection2),r.vertexAttribPointer(i.aProjection2,3,r.FLOAT,!1,64,12),r.enableVertexAttribArray(i.aProjection3),r.vertexAttribPointer(i.aProjection3,3,r.FLOAT,!1,64,24),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,64,36),r.enableVertexAttribArray(i.aColor),r.vertexAttribPointer(i.aColor,4,r.FLOAT,!1,64,44),r.enableVertexAttribArray(i.aPointSize),r.vertexAttribPointer(i.aPointSize,1,r.FLOAT,!1,64,60),r.drawArrays(r.POINTS,0,e),this.prevNumElements=e,o.LAST_USED_CONTROLLER=this},t.Controller.GLPixelBatchProgramController=e,t.GLPixelBatchProgramController=e}}]);
//# sourceMappingURL=nk.min.js.map