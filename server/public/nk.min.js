/**
* @package     Nenkraft
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     0.4.0 (Alpha)
* @copyright   (C) 2017 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft/blob/master/LICENSE}
*/
!function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=116)}([function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){(function(t){var e=Object.create(null);r(19)(e),r(65)(e),r(52)(e),r(75)(e),r(80)(e),r(76)(e),r(82)(e),r(77)(e),r(79)(e),r(78)(e),r(66)(e),r(68)(e),r(69)(e),r(71)(e),r(67)(e),r(70)(e),r(72)(e),r(42)(e),r(41)(e),r(73)(e),r(74)(e),r(57)(e),r(56)(e),r(53)(e),r(54)(e),r(55)(e),r(45)(e),r(43)(e),r(46)(e),r(44)(e),r(50)(e),r(51)(e),r(59)(e),r(58)(e),r(81)(e),r(48)(e),r(47)(e),r(30)(e),r(63)(e),r(62)(e),r(60)(e),r(64)(e),r(61)(e),r(33)(e),r(32)(e),r(31)(e),r(39)(e),r(34)(e),r(35)(e),r(36)(e),r(37)(e),r(40)(e),r(38)(e),r(18)(e),r(16)(e),r(17)(e),r(28)(e),r(27)(e),r(29)(e),r(49)(e),r(23)(e),r(21)(e),r(24)(e),r(20)(e),r(26)(e),r(25)(e),r(22)(e),t.Nenkraft=t.nk=e}).call(e,r(0))},,,,,,,,,function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vRadius = uRadius;\r\n  vOutline = uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = vRadius * vRadius;\r\n  float ors = vRadius - vOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = vOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = vFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vColor = uColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = vFillColor;\r\n  } else {\r\n    gl_FragColor = vOutlineColor;\r\n  }\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord );\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( uTransformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord );\r\n}\r\n@fragment-end@\r\n"},function(t,e){t.exports=function(t){"use strict";function e(r,o,n){if(!(this instanceof e))return new e(r,o,n);this.frames=[],this.controller=r,this.id=o,this.onEnd=new t.Event.LocalEvent,this.onStop=new t.Event.LocalEvent,this.onStart=new t.Event.LocalEvent,void 0!=n&&(this.rate=n)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.currentFrame=0,e.prototype.currentFrameIndex=0,e.prototype.playing=!1,e.prototype.id=null,e.prototype.rate=60,e.prototype.reverse=!1,e.prototype.AddFrame=function(e,r,o,n,i){i=void 0==i?this.rate:i,this.frames.push(new t.Animator.Frame(e,r,o,n,i,this.controller.sprite))},e.prototype.GenerateFrames=function(t,e,r,o,n,i){i=void 0==i?{}:i;for(var s,a=0,l=r/o;a<n;++a)s=i[a],this.AddFrame(a%l*t,(a/l|0)*e,t,e,s)},e.prototype.SetFrame=function(t){t=void 0===t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply())},e.prototype.Start=function(){this.playing=!0,this.onStart.Dispatch()},e.prototype.Stop=function(){this.playing=!1,this.onStop.Dispatch()},e.prototype.Process=function(){if(!0===this.playing){var t=this.currentFrame,e=this.frames,r=!1;if(!0===t.Process()){var o;o=!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,o>=e.length?(o=this.currentFrameIndex=0,r=!0):o<0&&(o=this.currentFrameIndex=this.frames.length-1,r=!0),this.currentFrame=e[o],this.currentFrame.Apply(),!0===r&&this.onEnd.Dispatch()}}},e.prototype.Clear=function(){this.frames=[],delete this.currentFrame,delete this.playing,delete this.currentFrameIndex},e.prototype.Restart=function(t){this.SetFrame(t),this.ResetAllFrames(),this.Start()},e.prototype.ResetAllFrames=function(){for(var t,e=0,r=this.frames,o=r.length;e<o;++e)t=r[e],t.Reset()},t.Animator.Animation=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.animations=[],void 0!==t&&(this.sprite=t)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.currentAnimation=null,e.prototype.sprite=null,e.prototype.AddAnimation=function(e,r){var o=new t.Animator.Animation(this,e,r);return this.animations.push(o),o},e.prototype.GetAnimation=function(t){for(var e,r=0,o=this.animations,n=o.length;r<n;++r)if((e=o[r])&&e.id===t)return e;return null},e.prototype.PlayAnimation=function(t,e){var r=this.GetAnimation(t);null!==r&&(this.currentAnimation=r,r.Restart(e))},e.prototype.StopCurrentAnimation=function(){null!==this.currentAnimation&&this.currentAnimation.Stop()},e.prototype.Process=function(){var t=this.currentAnimation;null!==t&&t.Process()},t.Animator.Controller=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n,i,s){if(!(this instanceof e))return new e(t,r,o,n,i,s);this.sprite=s,this.rate=i,this.x=t,this.y=r,this.w=o,this.h=n}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.x=0,e.prototype.y=0,e.prototype.w=0,e.prototype.h=0,e.prototype.sprite=null,e.prototype.rate=0,e.prototype.timer=0,e.prototype.Process=function(){return this.timer--<=0&&(this.Reset(),!0)},e.prototype.Apply=function(){this.sprite.clip.Set(this.x,this.y,this.w,this.h),this.sprite.w=this.w,this.sprite.h=this.h},e.prototype.Reset=function(){this.timer=this.rate},t.Animator.Frame=e}},function(t,e){t.exports=function(t){t.Geom=Object.create(null),t.Style=Object.create(null),t.Math=Object.create(null),t.Utils=Object.create(null),t.Texture=Object.create(null),t.Controller=Object.create(null),t.Entity=Object.create(null),t.Path=Object.create(null),t.Event=Object.create(null),t.Time=Object.create(null),t.Input=Object.create(null),t.CP=Object.create(null),t.Load=Object.create(null),t.Animator=Object.create(null),t.VERSION="0.4.0 (Alpha)",console.log("%cnenkraft %cversion %c"+t.VERSION,"color:cyan;background-color:black;font-family:Arial;font-size:16px;font-weight:900;","color:magenta;background-color:black;font-family:Arial;font-size:16px;","color:yellow;background-color:black;font-family:Arial;font-size:18px;")}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);r.call(this,o,t.SHADER_CODE.CIRCLE),this.Initialise()}var r=t.Controller.GLProgramController,o=t.Math.TriRectArray;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.essenceBuffer=null,e.prototype.vertices=null,e.prototype.fillColor=null,e.prototype.outlineColor=null,e.prototype.outline=5,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array(t.Math.TriRectArray(0,0,1,1)),this.fillColor=new t.Color,this.outlineColor=new t.Color,e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")},e.prototype.Execute=function(t,e,n,i){var s=this.gl,a=this.attributes,l=this.uniforms,h=this.vertices,u=this.fillColor.channel,p=this.outlineColor.channel;o(e-i,n-i,2*i,2*i,h),this!==r.LAST_USED_CONTROLLER&&(s.useProgram(this.program),s.bindBuffer(s.ARRAY_BUFFER,this.essenceBuffer),s.bufferSubData(s.ARRAY_BUFFER,0,h),s.enableVertexAttribArray(a.aPosition),s.vertexAttribPointer(a.aPosition,2,s.FLOAT,!1,0,0),r.LAST_USED_CONTROLLER=this),s.uniformMatrix3fv(l.uProjection,!1,t),s.uniform4f(l.uFillColor,u[0],u[1],u[2],u[3]),s.uniform4f(l.uOutlineColor,p[0],p[1],p[2],p[3]),s.uniform1f(l.uOutline,this.outline),s.uniform1f(l.uRadius,i),s.drawArrays(s.TRIANGLE_STRIP,0,6)},t.Controller.GLCircleProgramController=e,t.GLCircleProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);r.call(this,o,t.SHADER_CODE.LINE2D),this.Initialise()}var r=t.Controller.GLProgramController;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.essenceBuffer=null,e.prototype.vertices=null,e.prototype.color=null,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new t.Color,e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")},e.prototype.Execute=function(t,e,o){var n=this.gl,i=this.attributes,s=this.uniforms,a=this.vertices,l=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=o.x,a[3]=o.y,this!==r.LAST_USED_CONTROLLER&&(n.useProgram(this.program),r.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,a),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),n.uniformMatrix3fv(s.uProjection,!1,t),n.uniform4f(s.uColor,l[0],l[1],l[2],l[3]),n.drawArrays(n.LINES,0,2)},t.Controller.GLLine2DProgramController=e,t.GLLine2DProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);r.call(this,o,t.SHADER_CODE.PIXEL_BATCH),this.Initialise()}var r=t.Controller.GLProgramController;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.dataBuffer=null,e.prototype.Initialise=function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")},e.prototype.Execute=function(t,e){var o=this.gl,n=this.attributes;o.useProgram(this.program),o.bindBuffer(o.ARRAY_BUFFER,this.dataBuffer),o.bufferData(o.ARRAY_BUFFER,t,o.STREAM_DRAW),o.enableVertexAttribArray(n.aProjection1),o.vertexAttribPointer(n.aProjection1,3,o.FLOAT,!1,64,0),o.enableVertexAttribArray(n.aProjection2),o.vertexAttribPointer(n.aProjection2,3,o.FLOAT,!1,64,12),o.enableVertexAttribArray(n.aProjection3),o.vertexAttribPointer(n.aProjection3,3,o.FLOAT,!1,64,24),o.enableVertexAttribArray(n.aPosition),o.vertexAttribPointer(n.aPosition,2,o.FLOAT,!1,64,36),o.enableVertexAttribArray(n.aColor),o.vertexAttribPointer(n.aColor,4,o.FLOAT,!1,64,44),o.enableVertexAttribArray(n.aPointSize),o.vertexAttribPointer(n.aPointSize,1,o.FLOAT,!1,64,60),o.drawArrays(o.POINTS,0,e),r.LAST_USED_CONTROLLER=this},t.Controller.GLPixelBatchProgramController=e,t.GLPixelBatchProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);this.gl=t,this.data=Object.create(null),null!=t&&null!=r&&this.Init(r.v,r.f)}e.prototype=Object.create(null),e.prototype.constructor=e,e.LAST_USED_CONTROLLER=null,e.prototype.program=null,e.prototype.gl=null,e.prototype.attributes=null,e.prototype.uniforms=null,e.prototype.data=null,e.prototype.Init=function(t,e){var r=this.gl,o=this.CreateShader(t,r.VERTEX_SHADER),n=this.CreateShader(e,r.FRAGMENT_SHADER),i=this.program=r.createProgram();if(r.attachShader(i,o),r.attachShader(i,n),r.linkProgram(i),!r.getProgramParameter(i,r.LINK_STATUS)){var s=r.getProgramInfoLog(i);throw new Error("Program link failed:"+s)}r.detachShader(i,o),r.detachShader(i,n),r.deleteShader(o),r.deleteShader(n),this.attributes={},this.uniforms={}},e.prototype.CreateShader=function(t,e){var r=this.gl,o=r.createShader(e);if(r.shaderSource(o,t),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var n=r.getShaderInfoLog(o);throw new Error("Shader compilation failed:"+n)}return o},e.prototype.AssignAttribute=function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)},e.prototype.AssignUniform=function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)},e.prototype.Execute=function(){},t.Controller.GLProgramController=e,t.GLProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);r.call(this,o,t.SHADER_CODE.RECTANGLE),this.Initialise()}var r=t.Controller.GLProgramController,o=t.Math.TriRectArray;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.geometricBuffer=null,e.prototype.vertices=null,e.prototype.fillColor=null,e.prototype.outlineColor=null,e.prototype.outline=5,e.prototype.Initialise=function(){var e=this.gl;this.essenceBuffer=e.createBuffer(),this.vertices=new Float32Array(t.Math.TriRectArray(0,0,1,1)),this.fillColor=new t.Color,this.outlineColor=new t.Color,e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")},e.prototype.Execute=function(t,e,n,i,s){var a=this.gl,l=this.attributes,h=this.uniforms,u=this.vertices,p=this.fillColor.channel,c=this.outlineColor.channel;o(e,n,i,s,u),this!==r.LAST_USED_CONTROLLER&&(a.useProgram(this.program),r.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,u),a.enableVertexAttribArray(l.aPosition),a.vertexAttribPointer(l.aPosition,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(h.uProjection,!1,t),a.uniform4f(h.uFillColor,p[0],p[1],p[2],p[3]),a.uniform4f(h.uOutlineColor,c[0],c[1],c[2],c[3]),a.uniform1f(h.uOutline,this.outline),a.uniform2f(h.uSize,i,s),a.drawArrays(a.TRIANGLE_STRIP,0,6)},t.Controller.GLRectangleProgramController=e,t.GLRectangleProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);r.call(this,o,t.SHADER_CODE.TEXTURE_2D_BATCH)}var r=t.Controller.GLProgramController,o=t.Math.TriRectArray;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.originalTexture=null,e.prototype.boundTexture=null,e.prototype.essenceBuffer=null,e.prototype.dataBuffer=null,e.prototype.indexBuffer=null,e.prototype.BindBasicTexture=function(t){var e=this.gl;this.aia=e.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,this.boundTexture=e.createTexture(),this.essenceBuffer=e.createBuffer(),this.dataBuffer=e.createBuffer();var r=o(0,0,t.w,t.h);r.push.apply(r,o(0,0,1,1)),e.bindTexture(e.TEXTURE_2D,this.boundTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")},e.prototype.Execute=function(t,e){var o=this.gl,n=this.aia,i=this.attributes,s=this.uniforms;this!==r.LAST_USED_CONTROLLER&&(o.useProgram(this.program),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this.boundTexture),o.uniform1i(s.uImage,0),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.enableVertexAttribArray(i.aPosition),o.vertexAttribPointer(i.aPosition,2,o.FLOAT,!1,0,0),n.vertexAttribDivisorANGLE(i.aPosition,0),o.enableVertexAttribArray(i.aTexCoord),o.vertexAttribPointer(i.aTexCoord,2,o.FLOAT,!1,0,48),n.vertexAttribDivisorANGLE(i.aTexCoord,0),r.LAST_USED_CONTROLLER=this),o.bindBuffer(o.ARRAY_BUFFER,this.dataBuffer),o.bufferData(o.ARRAY_BUFFER,t,o.STREAM_DRAW),o.enableVertexAttribArray(i.aProjection1),o.vertexAttribPointer(i.aProjection1,3,o.FLOAT,!1,108,0),n.vertexAttribDivisorANGLE(i.aProjection1,1),o.enableVertexAttribArray(i.aProjection2),o.vertexAttribPointer(i.aProjection2,3,o.FLOAT,!1,108,12),n.vertexAttribDivisorANGLE(i.aProjection2,1),o.enableVertexAttribArray(i.aProjection3),o.vertexAttribPointer(i.aProjection3,3,o.FLOAT,!1,108,24),n.vertexAttribDivisorANGLE(i.aProjection3,1),o.enableVertexAttribArray(i.aTranslation1),o.vertexAttribPointer(i.aTranslation1,3,o.FLOAT,!1,108,36),n.vertexAttribDivisorANGLE(i.aTranslation1,1),o.enableVertexAttribArray(i.aTranslation2),o.vertexAttribPointer(i.aTranslation2,3,o.FLOAT,!1,108,48),n.vertexAttribDivisorANGLE(i.aTranslation2,1),o.enableVertexAttribArray(i.aTranslation3),o.vertexAttribPointer(i.aTranslation3,3,o.FLOAT,!1,108,60),n.vertexAttribDivisorANGLE(i.aTranslation3,1),o.enableVertexAttribArray(i.aTransformation1),o.vertexAttribPointer(i.aTransformation1,3,o.FLOAT,!1,108,72),n.vertexAttribDivisorANGLE(i.aTransformation1,1),o.enableVertexAttribArray(i.aTransformation2),o.vertexAttribPointer(i.aTransformation2,3,o.FLOAT,!1,108,84),n.vertexAttribDivisorANGLE(i.aTransformation2,1),o.enableVertexAttribArray(i.aTransformation3),o.vertexAttribPointer(i.aTransformation3,3,o.FLOAT,!1,108,96),n.vertexAttribDivisorANGLE(i.aTransformation3,1),n.drawArraysInstancedANGLE(o.TRIANGLE_STRIP,0,6,e)},t.Controller.GLTextureBatchProgramController=e,t.GLTextureBatchProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);r.call(this,o,t.SHADER_CODE.TEXTURE_2D)}var r=t.Controller.GLProgramController,o=t.Math.TriRectArray;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.originalTexture=null,e.prototype.boundTexture=null,e.prototype.essenceBuffer=null,e.prototype.BindBasicTexture=function(t){var e=this.gl;this.originalTexture=t,this.boundTexture=e.createTexture(),this.essenceBuffer=e.createBuffer();var r=o(0,0,t.w,t.h);r.push.apply(r,o(0,0,1,1)),e.bindTexture(e.TEXTURE_2D,this.boundTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation")},e.prototype.Execute=function(t,e,o){var n=this.gl,i=this.attributes,s=this.uniforms;this!==r.LAST_USED_CONTROLLER&&(n.useProgram(this.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.boundTexture),n.uniform1i(s.uImage,0),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(i.aTexCoord),n.vertexAttribPointer(i.aTexCoord,2,n.FLOAT,!1,0,48),r.LAST_USED_CONTROLLER=this),n.uniformMatrix3fv(s.uProjection,!1,t),n.uniformMatrix3fv(s.uTranslation,!1,e),n.uniformMatrix3fv(s.uTransformation,!1,o),n.drawArrays(n.TRIANGLE_STRIP,0,6)},t.Controller.GLTextureProgramController=e,t.GLTextureProgramController=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n,i){if(!(this instanceof e))return new e(t,r,o,n,i);this.id=t.split(" "),this.handle=r,this.info=o,this.data={},this.optionPrefix=void 0===i?e.OPTION_PREFIX:i,void 0!==n&&(this.continueToPrime=n)}e.prototype=Object.create(null),e.prototype.constructor=e,e.OPTION_PREFIX="",e.prototype.dataSeparator="=",e.prototype.options=null,e.prototype.allOptionIds=null,e.prototype.fullInfo=null,e.prototype.optionPrefix=null,e.prototype.continueToPrime=!0,e.prototype.Execute=function(t,e){this.HandleData(t,e),!0===this.HandleOptions(t,e)&&this.handle(t,e)},e.prototype.AddOption=function(e,r,o,n,i,s){s=void 0===s?this.optionPrefix:s,null!==s&&(e=e.replace(/\S+/g,s+"$&")),null===this.options&&(this.options=[]),n=void 0===n?0:n;var a=new t.CP.Option(e,r,o,n,i);a.command=this;for(var l,h=0,u=this.options,p=u.length;h<p;++h)if(l=u[h],l.priority<=n)return u.splice(h,0,a),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(a),this.allOptionIds=this.GetAllOptionIds(),this},e.prototype.HandleData=function(t,e){for(var r,o,n=t.slice(),i=0,s=n.length,a=this.dataSeparator;i<s;++i)r=n[i],o=r.split(a),2===o.length&&(t.splice(i,1),e[o[0]]=o[1])},e.prototype.HandleOptions=function(t,e){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null===r)return this.continueToPrime;for(var o,n=0,i=r.length;n<i;++n)if(o=this.GetOptionById(r[n]),!0===o.Execute(t,e))return!1;return this.continueToPrime},e.prototype.GetOptionById=function(t){for(var e,r=0,o=this.options,n=o.length;r<n;++r)if(e=o[r],-1!==e.id.indexOf(t))return e;return null},e.prototype.GetAllOptionIds=function(){for(var t=[],e=0,r=this.options,o=r.length;e<o;++e)t.push.apply(t,r[e].id);return t},e.prototype.GetAndRemoveMatchingOptionIds=function(t){var e=this.allOptionIds;if(null===e)return null;for(var r=[],o=0,n=e.length;o<n;++o){var i=t.indexOf(e[o]);-1!==i&&r.push(t.splice(i,1)[0])}return r},e.prototype.GenerateInfoString=function(){for(var t,e="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",r=0,o=this.options,n=o.length;r<n;++r)t=o[r],e+="OPTION: "+t.id.join(", ")+" -> "+t.info+"\n";return e},t.CP.Command=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n,i){if(!(this instanceof e))return new e(t,r,o,n,i);this.id=t.split(" "),this.handle=r,this.info=o,void 0!==n&&(this.priority=n),void 0!==i&&(this.breakIfExecuted=i),this.data={}}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.command=null,e.prototype.priority=0,e.prototype.breakIfExecuted=!1,e.prototype.Execute=function(t,e){return this.handle(t,e),this.breakIfExecuted},t.CP.Option=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.commands=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.splitter=" ",e.prototype.Add=function(t){this.commands.push(t)},e.prototype.Get=function(t){for(var e,r=0,o=this.commands,n=o.length;r<n;++r)if(e=this.commands[r])for(var i=0,s=e.id.length;i<s;++i)if(e.id[i]===t)return e;return null},e.prototype.Parse=function(t){var e=String(t).split(this.splitter),r=e.shift(),o=this.Get(r);return o?(o.Execute(e,{}),null):r},t.CP.Register=e}},function(t,e){t.exports=function(t){"use strict";function e(){throw new Error("Cannot be instantiated")}e.Draw={},e.Draw.AABB2D=function(t,e,r){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.1,t.strokeStyle="rgba(100, 0, 100, 1)",t.fillStyle="rgba(0, 100, 0, 1)",r&&r.strokeStyle&&(t.strokeStyle=r.strokeStyle),r&&r.fillStyle&&(t.fillStyle=r.fillStyle),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),r&&r.noStroke||t.stroke(),r&&r.noFill||t.fill()},t.Debug=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);r.call(this,t,o)}var r=t.Entity.Container2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.Render=function(){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&this.RenderChildren())},e.prototype.RenderChildren=function(){for(var t,e=0,r=this.children,o=r.length;e<o;++e)t=r[e],t.Render&&t.Render()},t.Entity.Case2D=e,t.Case2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);r.call(this,t,o),this.children=[]}var r=t.Entity.CoreEntity2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.children=null,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.isBatchParent=!1,e.prototype.childDataBuffer=null,e.prototype.bufferData=null,e.prototype.programController=null,e.prototype.bufferStartIndex=0,e.prototype.bufferEndIndex=0,e.prototype.Draw=function(t){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t))},e.prototype.GLDraw=function(t){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t)))},e.prototype.RequestTransformUpdate=function(){this.transformShouldUpdate=!0},e.prototype.DrawChildren=function(t){for(var e,r=0,o=this.children,n=o.length;r<n;++r)e=o[r],e.Draw&&e.Draw(t)},e.prototype.GLDrawChildren=function(t){for(var e,r=0,o=this.children,n=o.length;r<n;++r)e=o[r],e.GLDraw&&e.GLDraw(t)},e.prototype.GLBatchDrawChildren=function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)},e.prototype.ComputeBatchBuffer=function(t){for(var e,r,o=[],n=0,i=this.children,s=i.length;n<s;++n)e=i[n],r=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=o.length,e.bufferEndIndex=o.length+r.length,o.push.apply(o,r);this.childDataBuffer=new Float32Array(o)},e.prototype.UpdateInBuffer=function(){throw new Error("Cannot update buffer data directly on Container2D object!")},e.prototype.GetBufferData=function(){throw new Error("Cannot access buffer data directly on Container2D object!")},e.prototype.AddChild=function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t},e.prototype.AddChildren=function(){var t=arguments;Array.isArray(t[0])&&(t=t[0]);for(var e=0,r=t.length;e<r;++e)this.AddChild(t[e])},e.prototype.Mount=function(){this.AddChildren.apply(this,arguments)},e.prototype.AddSibling=function(t){var e=this.parent;return null!==e&&e.AddChild(t),t},e.prototype.RemoveChild=function(t){var e=this.children,r=e.indexOf(t);if(-1!==r)return delete t.parent,e.splice(r,1)[0]},e.prototype.RemoveChildren=function(){for(var t,e,r=this.children,o=arguments[0].length?arguments[0]:arguments,n=[],i=0,s=o.length;i<s;++i)t=o[i],-1!==(e=r.indexOf(t))&&(n.push(r.splice(e,1)[0]),delete t.parent);return n},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.splice(e,1)[0])}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.splice(0,0,t.splice(e,1)[0])}},e.prototype.Dump=function(){this.children.length=0},e.prototype.Destroy=function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.GetChildClosestTo=function(t,e){var r=this.children,o=null;if(0!==r.length){for(var n,i,s=0,a=r.length,l=1/0;s<a;++s)n=r[s],void 0!==e&&!1===e(n)||(i=Math.abs(n.position.GetDistanceSquared(t.x,t.y)))<l&&(l=i,o=n);return o}return null},e.prototype.GetChildFurthestFrom=function(t,e){var r=this.children,o=null;if(0!==r.length){for(var n,i,s=0,a=r.length,l=0;s<a;++s)n=r[s],void 0!==e&&!1===e(n)||(i=Math.abs(n.position.GetDistanceSquared(t.x,t.y)))>l&&(l=i,o=n);return o}return null},e.prototype.UseAsBatchParent=function(t){this.isBatchParent=!0,this.programController=t},t.Entity.Container2D=e,t.Container2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o){if(!(this instanceof e))return new e(r,o);this.transform=new t.Math.Transform2D(r,o),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=new t.Math.Transform2D,e.prototype.parent=null,e.prototype.transform=null,e.prototype.data=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){var e=this.transform.worldTransform;return new t.Vector2D(e.e,e.f)},e.prototype.ComputeBounds=function(e){var r=e&&e.x?e.x:0,o=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=new t.Geom.AABB2D(this.x-this.width*r,this.y-this.height*o,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*r,this.y-this.height*o,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w*this.scale.x},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}),t.Entity.CoreEntity2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i){if(!(this instanceof e))return new e(o,n,i);r.call(this,o,n),this.anchor=new t.Vector2D,this.SetPath(i)}var r=t.Entity.Container2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.path=null,e.prototype.anchor=null,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t);var e=this.path;e&&e.Draw&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Draw(t)),this.children.length>0&&this.DrawChildren(t)}},e.prototype.GLDraw=function(t){if(!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.path;e&&e.GLDraw&&!0===this.display&&e.GLDraw(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t))}},e.prototype.GetBufferData=function(){this.UpdateTransform();var t=this.transform.worldTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e},e.prototype.UpdateInBuffer=function(){this.UpdateTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.parent.childDataBuffer,r=this.bufferStartIndex;e[r]=t[0],e[r+1]=t[1],e[r+2]=t[2],e[r+3]=t[3],e[r+4]=t[4],e[r+5]=t[5],e[r+6]=t[6],e[r+7]=t[7],e[r+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,r+9)},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return this.path.IntersectsPoint(e)},e.prototype.SetPath=function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)},t.Entity.Graphic2D=e,t.Graphic2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o){if(!(this instanceof e))return new e(r,o);this.transform=new t.Math.Basetransform2D(r,o),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=new t.Math.Basetransform2D,e.prototype.parent=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){return this.transform.worldTransform.Copy()},e.prototype.ComputeBounds=function(e){var r=e&&e.x?e.x:0,o=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=new t.Geom.AABB2D(this.x-this.width*r,this.y-this.height*o,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*r,this.y-this.height*o,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},e.prototype.Destroy=function(){null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.splice(e,1)[0])}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.splice(0,0,t.splice(e,1)[0])}},Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h},set:function(t){this.h=t}}),t.Entity.Plain2D=e,t.Plain2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,n){if(!(this instanceof e))return new e(t,o,n);r.call(this,t,o),void 0!==n&&(void 0!==n.w&&void 0!==n.h?(this.w=n.w,this.h=n.h):void 0!==n.GetLength?this.w=this.h=n.GetLength():void 0!==n.diameter?this.w=this.h=n.diameter:void 0!==n.aabb&&(this.w=n.aabb.w,this.h=n.aabb.h),this.path=n)}var r=t.Entity.Plain2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.path=null,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t);var e=this.path;e&&e.Draw&&!0===this.display&&e.Draw(t)}},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.DivideV(this.scale),this.path.IntersectsPoint(e)},t.Entity.Plaingraphic2D=e,t.Plaingraphic2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i){if(!(this instanceof e))return new e(o,n,i);r.call(this,o,n),this.anchor=new t.Vector2D(0,0),this.clip=new t.Geom.AABB2D,this.shape=new t.Geom.AABB2D,null==i&&(i=e.DEFAULT_TEXTURE),this.SetTexture(i)}var r=t.Entity.Plain2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=new t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=new t.Path.Polygon2D;return e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(0,64)),e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#3399FF",e.style.stroke.lineWidth=3,new t.Graphic2D(0,0,e)})),"DEFAULT_PLAINSPRITE_TEXTURE",64,64,64,64),e.prototype.shape=null,e.prototype.clip=null,e.prototype.texture=null,e.prototype.anchor=null,e.prototype.interactive=!0,e.prototype.Draw=function(t){if(!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display)){var e=this.clip,r=e.tl,o=e.br,n=this.w,i=this.h,s=this.anchor;t.drawImage(this.texture.image,r.x,r.y,o.x,o.y,-n*s.x,-i*s.y,n,i)}},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.w*this.anchor.x,this.h*this.anchor.y),this.shape.IntersectsPoint(e)},e.prototype.SetTexture=function(t){this.texture=t,this.w=t.w,this.h=t.h,this.clip.Set(0,0,this.w,this.h),this.shape.SetC(this.clip)},t.Entity.Plainsprite=e,t.Plainsprite=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i){if(!(this instanceof e))return new e(o,n,i);r.call(this,o,n),this.anchor=new t.Vector2D(0,0),this.clip=new t.Geom.AABB2D,this.shape=new t.Geom.AABB2D,this.textureTransformation=new t.Math.Matrix2D,this.textureTranslation=new t.Math.Matrix2D,this.originalShape=new t.Geom.AABB2D,i instanceof t.GLTextureProgramController?(this.programController=i,this.SetTexture(i.originalTexture)):null==i?this.SetTexture(e.DEFAULT_TEXTURE):this.SetTexture(i)}var r=t.Entity.Container2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.DEFAULT_TEXTURE=new t.Texture.BasicTexture(t.Utils.ImageFromDataURL(t.Utils.GenerateSimpleBase64Png(function(){var e=new t.Path.Polygon2D;return e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(0,64)),e.AddPoint(new t.Vector2D(0,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,0)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(64,64)),e.AddPoint(new t.Vector2D(32,32)),e.AddPoint(new t.Vector2D(0,64)),e.ComputeBounds(),e.style.fill.color="rgba(66,66,66,0.5)",e.style.stroke.color="#00FFFF",e.style.stroke.lineWidth=3,new t.Graphic2D(0,0,e)})),"DEFAULT_SPRITE_TEXTURE",64,64,64,64),e.prototype.shape=null,e.prototype.originalShape=null,e.prototype.clip=null,e.prototype.texture=null,e.prototype.anchor=null,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.interactive=!0,e.prototype.programController=null,e.prototype.textureTransformation=null,e.prototype.textureTranslation=null,e.prototype.Draw=function(t){if(!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display){var e=this.clip,r=e.tl,o=e.br,n=this.w,i=this.h,s=this.anchor;t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,r.x,r.y,o.x,o.y,-n*s.x,-i*s.y,n,i)}this.children.length>0&&this.DrawChildren(t)}},e.prototype.GLDraw=function(t){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),this.UpdateTextureTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!=this.programController&&this.programController.Execute(this.transform.worldTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))},e.prototype.GetBufferData=function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),r=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var o=this.bufferData;return o.length=0,o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=e[0],o[10]=e[1],o[11]=e[2],o[12]=e[3],o[13]=e[4],o[14]=e[5],o[15]=e[6],o[16]=e[7],o[17]=e[8],o[18]=r[0],o[19]=r[1],o[20]=r[2],o[21]=r[3],o[22]=r[4],o[23]=r[5],o[24]=r[6],o[25]=r[7],o[26]=r[8],o},e.prototype.UpdateInBuffer=function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.worldTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),r=this.textureTransformation.AsArray(!0),o=this.parent.childDataBuffer,n=this.bufferStartIndex;o[n]=t[0],o[n+1]=t[1],o[n+2]=t[2],o[n+3]=t[3],o[n+4]=t[4],o[n+5]=t[5],o[n+6]=t[6],o[n+7]=t[7],o[n+8]=t[8],o[n+9]=e[0],o[n+10]=e[1],o[n+11]=e[2],o[n+12]=e[3],o[n+13]=e[4],o[n+14]=e[5],o[n+15]=e[6],o[n+16]=e[7],o[n+17]=e[8],o[n+18]=r[0],o[n+19]=r[1],o[n+20]=r[2],o[n+21]=r[3],o[n+22]=r[4],o[n+23]=r[5],o[n+24]=r[6],o[n+25]=r[7],o[n+26]=r[8]},e.prototype.UpdateTextureTransform=function(){var t=this.textureTranslation,e=this.textureTransformation,r=this.texture,o=this.clip;t.e=-this.w*this.anchor.x,t.f=-this.h*this.anchor.y,e.e=r.w/r.fw*o.tl.x/o.br.x,e.f=r.h/r.fh*o.tl.y/o.br.y},e.prototype.IntersectsPoint=function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.w*this.anchor.x*this.scale.x,this.h*this.anchor.y*this.scale.y),this.shape.IntersectsPoint(e)},e.prototype.UpdateShape=function(){this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)},e.prototype.SetTexture=function(t){this.texture=t,this.w=t.w,this.h=t.h,this.clip.Set(0,0,this.w,this.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.clip),this.textureTransformation.a=t.w/t.fw,this.textureTransformation.d=t.h/t.fh},t.Entity.Sprite=e,t.Sprite=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i,s,a){if(!(this instanceof e))return new e(o,n,i,s,a);if(r.call(this,n,i),this.canvas=o,this.w=o.width,this.h=o.height,!0===a){if(this.gl=o.getContext("webgl"),null==this.gl&&(this.gl=o.getContext("experimental-webgl")),null==this.gl)throw new Error("WebGL is not supported!");this.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,0),this.usingWebGL=!0,this.scale.Set(2/this.w,-2/this.h),this.position.Add(-1,1),this.position.Add(n*this.scale.x,i*this.scale.y),this.UpdateTransform(),this.ticker=new t.Time.Ticker(this.GLProcess.bind(this),60,s)}else this.rc=o.getContext("2d"),this.ticker=new t.Time.Ticker(this.Process.bind(this),60,s);this.onProcess=new t.Event.LocalEvent,this.mouse=new t.Input.Mouse(o,n,i),this.keyboard=new t.Input.Keyboard(o)}var r=t.Entity.Container2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.backgroundColor="rgba(10,20,30,1)",e.prototype.clear=!0,e.prototype.fill=!0,e.prototype.usingWebGL=!1,e.prototype.PreDraw=function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation="source-over",!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)},e.prototype.GLPreDraw=function(t){t.viewport(0,0,this.w,this.h),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},e.prototype.GLPostDraw=function(t){t.flush()},e.prototype.Process=function(t){this.PreDraw(this.rc),this.Draw(this.rc),this.onProcess.Dispatch(this,t)},e.prototype.GLProcess=function(t){this.GLPreDraw(this.gl),this.GLDraw(this.gl),this.GLPostDraw(this.gl),this.onProcess.Dispatch(this,t)},t.Entity.Stage2D=e,t.Stage2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i){if(!(this instanceof e))return new e(o,n);r.call(this,o,n),void 0!==i&&(this.text=i),this.style=t.Style.CreateSaT()}var r=t.Entity.Container2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.text="",e.prototype.maxWidth=void 0,e.prototype.alpha=1,e.prototype.gco=t.Style.GCO.DEFAULT,e.prototype.Draw=function(t){if(!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyWorld(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.DrawChildren(t)}},e.prototype.IntersectsPoint=function(){return!1},t.Entity.Text=e,t.Text=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.listeners=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.stopPropagation=!1,e.prototype.target=null,e.prototype.data=null,e.prototype.GetListenerIndex=function(t,e){var r=this.listeners;if(0===r.length)return-1;for(var o,n=0,i=r.length;n<i;++n)if(o=r[n],o.context===e&&o.handle===t)return n;return-1},e.prototype.Add=function(e,r,o){var n=new t.LocalListener(this,r,e,o);this.listeners.push(n)},e.prototype.Remove=function(t,e){var r=this.GetListenerIndex(t,e);-1!==r&&this.listeners.splice(r,1)},e.prototype.Dump=function(t){var e=this.listeners;if(0!==e.length)if(void 0!==t)for(var r,o=0,n=e.length;o<n;++o)r=e[o],r.context===t&&this.listeners.splice(o,1);else this.listeners.length=0},e.prototype.Dispatch=function(t,e){var r=this.listeners;if(0!==r.length){r=r.slice(),this.stopPropagation=!1,this.target=t,this.data=e;for(var o,n=0,i=r.length;n<i&&(o=r[n],o.Execute(this),!0!==this.stopPropagation);++n);delete this.target,delete this.data}},t.Event.LocalEvent=e,t.LocalEvent=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n){if(!(this instanceof e))return new e(t,r,o,n);this.context=r,this.holderContext=t,this.handle=o,this.removeOnNextCall=n}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.Execute=function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()},e.prototype.Remove=function(){this.holderContext.Remove(this.handle,this.context)},t.Event.LocalListener=e,t.LocalListener=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o,n,i){if(!(this instanceof e))return new e(r,o,n,i);r instanceof t.Vector2D&&o instanceof t.Vector2D?(this.tl=r,this.br=o):void 0!==r&&void 0!==o&&void 0!==r.x&&void 0!==r.y&&void 0!==o.x&&void 0!==o.y?(this.tl=new t.Vector2D(r.x,r.y),this.br=new t.Vector2D(o.x,o.y)):void 0!==r&&void 0!==o&&void 0!==n&&void 0!==i?(this.tl=new t.Vector2D(r,o),this.br=new t.Vector2D(n,i)):(this.tl=new t.Vector2D,this.br=new t.Vector2D),this.ComputeWH()}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=1,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.prototype.TYPE=e.TYPE,e.prototype.w=0,e.prototype.h=0,e.prototype.hw=0,e.prototype.hh=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,r,o){this.tl.x=t,this.tl.y=e,this.br.x=r,this.br.y=o,this.ComputeWH()},e.prototype.SetC=function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)},e.prototype.Scale=function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e)},e.prototype.ComputeWH=function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h},e.prototype.GetQuadrant=function(t){var r=this.tl,o=this.br;switch(t){case e.TOP_LEFT:return new e(r.x,r.y,r.x+this.hw,r.y+this.hh);case e.TOP_RIGHT:return new e(r.x+this.hw,r.y,o.x,r.y+this.hh);case e.BOTTOM_LEFT:return new e(r.x,r.y+this.hh,r.x+this.hw,o.y);case e.BOTTOM_RIGHT:return new e(r.x+this.hw,r.y+this.hh,o.x,o.y);default:return null}},e.prototype.IntersectsPoint=function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)},e.prototype.ContainsPoint=function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y},e.prototype.IntersectsAABB2D=function(t){var e=this.tl,r=this.br,o=t.tl,n=t.br;return!(o.x>=r.x||o.y>=r.y||n.x<=e.x||n.y<=e.y)},e.prototype.ContainsAABB2D=function(t){if(t.area>this.area)return!1;var e=this.tl,r=this.br,o=t.tl,n=t.br;return o.x>=e.x&&o.y>=e.y&&n.x<=r.x&&n.y<=r.y},t.Geom.AABB2D=e,t.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o,n){if(!(this instanceof e))return new e(r,o,n);this.center=new t.Vector2D(r,o),this.radius=void 0===n?32:n}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=2,e.prototype.TYPE=e.TYPE,e.prototype.diameter=0,e.prototype.w=0,e.prototype.h=0,e.prototype.radiusSquared=0,e.prototype.radiusUnsquared=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,r){this.center.Set(t,e),this.radius=r},e.prototype.SetC=function(t){this.center.SetV(t),this.radius=t.radius},e.prototype.Scale=function(t){this.radius*=t},e.prototype.IntersectsCircle=function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)},e.prototype.IntersectsPoint=function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)},Object.defineProperty(e.prototype,"x",{set:function(t){this.center.x=t},get:function(){return this.center.x}}),Object.defineProperty(e.prototype,"y",{set:function(t){this.center.y=t},get:function(){return this.center.y}}),Object.defineProperty(e.prototype,"radius",{set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=Math.PI*t*t},get:function(){return this.radiusUnsquared}}),t.Geom.Circle=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o,n,i){if(!(this instanceof e))return new e(r,o,n,i);void 0!==r&&null!=r.x&&null!=r.y&&void 0!==o&&null!=o.x&&null!=o.y?(this.s=r,this.e=o):void 0!==r&&void 0!==o&&void 0!==n&&void 0!==i?(this.s=new t.Vector2D(r,o),this.e=new t.Vector2D(n,i)):(this.s=new t.Vector2D,this.e=new t.Vector2D)}var r=t.Math.LineLineIntersection,o=t.Math.ClosestPointOnLine;e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=0,e.prototype.TYPE=e.TYPE,e.prototype.epsilon=1e3,e.prototype.belongsTo=null,e.prototype.Stretch=function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)},e.prototype.Rotate=function(t,e,r){e=void 0==e?.5:e;var o=this.s.Copy();o.AddV(this.e),o.Multiply(e,void 0==r?e:r),this.s.RotateAroundV(o,t),this.e.RotateAroundV(o,t)},e.prototype.GetLength=function(){return this.s.GetDistanceV(this.e)},e.prototype.GetLengthSquared=function(){return this.s.GetDistanceSquaredV(this.e)},e.prototype.IntersectsPoint=function(t){var e=this.s,r=this.e,o=(t.y-e.y)*(r.x-e.x)-(t.x-e.x)*(r.y-e.y);if(Math.abs(o)>this.epsilon)return!1;var n=(t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y);return!(n<0)&&!(n>this.GetLengthSquared())},e.prototype.IntersectsLine=function(t){return r(this.s,this.e,t.s,t.e)},e.prototype.GetClosestPointTo=function(t){return o(this.s,this.e,t)},e.prototype.GetNormalA=function(){return this.s.GetNormalAV(this.e)},e.prototype.GetNormalB=function(){return this.s.GetNormalBV(this.e)},t.Geom.Line2D=e,t.Geom.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new t.Vector2D,null!=r&&(r[0]instanceof t.Vector2D?this.AddPoints(r):this.PushPoints(r))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=3,e.CreateCopy=function(t){for(var r=new e,o=0,n=t.vertices,i=n.length;o<i;++o)r.AddPoint(n[o].Copy());return r},e.Construct=Object.create(null),e.Construct.Rectangular=function(e,r,o,n,i){var s=new t.Vector2D(r,o),a=new t.Vector2D(r+n,o),l=new t.Vector2D(r+n,o+i),h=new t.Vector2D(r,o+i);return e.Recreate([s,a,l,h]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Isosceles=function(e,r,o,n,i){var s=new t.Vector2D(r,o),a=new t.Vector2D(r+.5*n,o+i),l=new t.Vector2D(r-.5*n,o+i);return e.Recreate([s,a,l]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Cyclic=function(e,r,o,n,i){var s,a,l,h=0,u=i,p=2*Math.PI/u;for(e.Recreate([]),h;h<u;++h)l=p*h,s=Math.cos(l)*n,a=Math.sin(l)*n,e.AddPoint(new t.Vector2D(r+s,o+a));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Equilateral=function(e,r,o,n){var i,s,a=2.0943951023931953;return e.Recreate([]),i=Math.cos(0)*n,s=Math.sin(0)*n,e.AddPoint(new t.Vector2D(r+i,o+s)),i=Math.cos(a)*n,s=Math.sin(a)*n,e.AddPoint(new t.Vector2D(r+i,o+s)),i=Math.cos(2*a)*n,s=Math.sin(2*a)*n,e.AddPoint(new t.Vector2D(r+i,o+s)),e.Rotate(-90*t.Math.RADIAN),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Star=function(e,r,o,n,i,s){var a,l,h,u,p=0,c=2*s,f=2*Math.PI/c;for(e.Recreate([]),p;p<c;++p)u=0==(1&p)?n:i,h=f*p,a=Math.cos(h)*u,l=Math.sin(h)*u,e.AddPoint(new t.Vector2D(r+a,o+l));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Butterfly=function(r,o,n,i,s){var a,l,h,u=0,p=e.Construct.Butterfly.C;for(r.Recreate([]),u;u<i;++u)h=u*p._1*Math.PI/i,a=Math.cos(h)*(Math.exp(Math.cos(h))-p._2*Math.cos(p._3*h)-Math.pow(Math.sin(h/p._4),p._5))*s,l=Math.sin(h)*(Math.exp(Math.cos(h))-p._2*Math.cos(p._3*h)-Math.pow(Math.sin(h/p._4),p._5))*s,r.AddPoint(new t.Vector2D(o+a,n+l));return r.ComputeBounds(),r.GetNormalsA(),r},e.Construct.Butterfly.C={_1:24,_2:2,_3:4,_4:12,_5:5,Reset:function(){this._1=24,this._2=2,this._3=4,this._4=12,this._5=5}},e.Construct.Supershape=function(r,o,n,i,s,a,l,h,u){l=void 0===l?1:l,h=void 0===h?1:h,u=void 0===u?1:u;var p,c,f,y,d,v,A=0,m=s,T=e.Construct.Supershape.C;for(r.Recreate([]),A;A<m;++A)f=A*Math.PI*2/s,d=Math.cos(a*f/4)/T._A,d=Math.abs(d),d=Math.pow(d,h),v=Math.sin(a*f/4)/T._B,v=Math.abs(v),v=Math.pow(v,u),y=Math.pow(d+v,1/l),0===Math.abs(y)?(p=0,c=0):(y=1/y,p=Math.cos(f)*y*i,c=Math.sin(f)*y*i),r.AddPoint(new t.Vector2D(o+p,n+c));return r.ComputeBounds(),r.GetNormalsA(),r},e.Construct.Supershape.C={_A:1,_B:1},e.prototype.TYPE=e.TYPE,e.prototype.aabb=null,e.prototype.dirtyBounds=!0,e.prototype.belongsTo=null,e.prototype.AddPoint=function(t){this.vertices.push(t)},e.prototype.AddPoints=function(t){this.vertices.push.apply(this.vertices,t)},e.prototype.PushPoint=function(e,r){this.vertices.push(new t.Vector2D(e,r))},e.prototype.PushPoints=function(t){for(var e=0,r=t.length;e<r;e+=2)this.PushPoint(t[e],t[e+1])},e.prototype.Recreate=function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)},e.prototype.ComputeBounds=function(){null===this.aabb&&(this.aabb=new t.Geom.AABB2D);for(var e,r=1/0,o=-r,n=r,i=-r,s=0,a=this.vertices,l=a.length;s<l;++s)e=a[s],e.x<r&&(r=e.x),e.x>o&&(o=e.x),e.y<n&&(n=e.y),e.y>i&&(i=e.y);this.aabb.Set(r,n,o,i),this.dirtyBounds=!1},e.prototype.Rotate=function(t,e,r,o){!0===this.dirtyBounds&&!0===o?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e;var n=this.aabb,i=n.tl.Copy();i.AddV(n.br),i.Multiply(e,void 0===r?e:r);var s,a=0,l=this.vertices,h=l.length;for(a;a<h;++a)s=l[a],s.RotateAroundV(i,t);this.dirtyBounds=!0},e.prototype.GetCentroid=function(){var t=this.centroid;t.Set(0,0);for(var e,r=0,o=this.vertices,n=o.length;r<n;++r)e=o[r],t.AddV(e);return t.Divide(n,n),t},e.prototype.GetNormalsA=function(){var t=this.normals;t.length=0;for(var e=0,r=this.vertices,o=r[e],n=this.vertices.length-1;e<n;o=r[++e])t.push(o.GetNormalAV(r[e+1]));return t.push(r[n].GetNormalAV(r[0])),t},e.prototype.GetNormalsB=function(){var t=this.normals;t.length=0;for(var e=0,r=this.vertices,o=r[e],n=this.vertices.length-1;e<n;o=r[++e])t.push(o.GetNormalBV(r[e+1]));return t.push(r[n].GetNormalBV(r[0])),t},e.prototype.GetPerimeterMidPoints=function(){var t=this.perimeterMidPoints;t.length=0;for(var e=0,r=this.vertices,o=r[e],n=this.vertices.length-1;e<n;o=r[++e])t.push(o.GetMidPointV(r[e+1]));return t.push(r[n].GetMidPointV(r[0])),t},e.prototype.IntersectsPoint=function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;var e,r,o,n,i=t.x,s=t.y,a=!1,l=this.vertices,h=l.length;for(e=0,r=h-1;e<h;r=e++)o=l[e],n=l[r],o.y>s!=n.y>s&&i<(n.x-o.x)*(s-o.y)/(n.y-o.y)+o.x&&(a=!a);return a},t.Geom.Polygon2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);this.element=r,this.element.setAttribute("tabindex","1"),this.element.focus(),this.element.addEventListener("keydown",this.OnKeyDown.bind(this)),this.element.addEventListener("keyup",this.OnKeyUp.bind(this)),this.onDown=new t.Event.LocalEvent,this.onUp=new t.Event.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.OnKeyDown=function(t){t.preventDefault(),t.stopPropagation(),this.onDown.Dispatch(this.element,t)},e.prototype.OnKeyUp=function(t){t.preventDefault(),t.stopPropagation(),this.onUp.Dispatch(this.element,t)},t.Input.Keyboard=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o,n){if(!(this instanceof e))return new e(r,o,n);this.element=r,this.position=new t.Vector2D,this.scale=new t.Vector2D(1,1),this.offset=new t.Vector2D(o,n),this.element.addEventListener("mousemove",this.OnMove.bind(this)),this.element.addEventListener("mousedown",this.OnDown.bind(this)),this.element.addEventListener("mouseup",this.OnUp.bind(this)),this.element.addEventListener("mouseleave",this.OnLeave.bind(this)),this.element.addEventListener("wheel",this.OnWheel.bind(this),{passive:!0}),this.onMove=new t.Event.LocalEvent,this.onDown=new t.Event.LocalEvent,this.onUp=new t.Event.LocalEvent,this.onLeave=new t.Event.LocalEvent,this.onWheel=new t.Event.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.OnMove=function(t){t.preventDefault(),t.stopPropagation();var e=this.element,r=this.position;r.Set(t.pageX,t.pageY),r.Subtract(e.offsetLeft,e.offsetTop),r.SubtractV(this.offset),r.DivideV(this.scale),this.onMove.Dispatch(this.element,{position:r,native:t})},e.prototype.OnDown=function(t){t.stopPropagation(),this.onDown.Dispatch(this.element,{position:this.position,native:t})},e.prototype.OnUp=function(t){t.stopPropagation(),this.onUp.Dispatch(this.element,{position:this.position,native:t})},e.prototype.OnLeave=function(t){t.preventDefault(),t.stopPropagation(),this.onLeave.Dispatch(this.element,{position:this.position,native:t})},e.prototype.OnWheel=function(t){this.onWheel.Dispatch(this.element,{position:this.position,native:t})},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y}}),t.Input.Mouse=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o){if(!(this instanceof e))return new e(r,o);this.imageCache=new t.Utils.Cache(Image),this.basicTextureCache=new t.Utils.Cache(t.Texture.BasicTexture),this.onImageLoaded=new t.Event.LocalEvent,this.onComplete=new t.Event.LocalEvent,void 0!==r&&this.Load(r,o)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.count=0,e.prototype.loading=!1,e.prototype.toLoad=null,e.prototype.createTextures=!1,e.prototype.Load=function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))},e.prototype.Haul=function(t){var e=this.toLoad[t];if(null!=e){var r=new Image;r.onload=this.OnLoad.bind(this),r.onerror=this.OnError.bind(this),r.src=e.src,r.id=e.id,r.data=Object.create(null),r.data.w=e.w,r.data.h=e.h,r.data.fw=e.fw,r.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})},e.prototype.OnLoad=function(e){var r=e.target;delete r.onload,this.imageCache.StoreSafe(r),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new t.Texture.BasicTexture(r,null,r.data.w,r.data.h,r.data.fw,r.data.fh)),this.onImageLoaded.Dispatch(r,{count:this.count}),this.Haul(++this.count)},e.prototype.OnError=function(){throw new Error("Could not load image")},e.prototype.GetImage=function(t){return this.imageCache.GetById(t)},e.prototype.GetBasicTexture=function(t){return this.basicTextureCache.GetById(t)},t.Load.ImageLoader=e,t.ImageLoader=e}},function(t,e){t.exports=function(t){"use strict";var e=Object.create(null);e.AABB2DvsAABB2D=Object.create(null),e.AABB2DvsAABB2D.Relative=Object.create(null),e.CirclevsCircle=Object.create(null),e.CirclevsCircle.Relative=Object.create(null),e.PolygonvsPolygon=Object.create(null),e.PolygonvsPolygon.Relative=Object.create(null),e.CirclevsLine=Object.create(null),e.CirclevsLine.Relative=Object.create(null),e.VectorSortMinMag=function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()};var r=t.Vector2D.GetMinMaxDot,o=t.Math.ClosestPointOnLine;e.AABB2DvsAABB2D.Result=function(){this.mtv=new t.Vector2D},e.AABB2DvsAABB2D.Result.prototype.occured=!1,e.AABB2DvsAABB2D.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.occured=!1},e.AABB2DvsAABB2D.Relative.Collide=function(r,o,n){var i=r.shape,s=i.w,a=i.h,l=r.anchor,h=o.shape,u=h.w,p=h.h,c=o.anchor,f=i.tl.SubtractVC(r.relative),y=h.tl.SubtractVC(o.relative);void 0!=l&&(f.x+=l.x*s,f.y+=l.y*a),void 0!=c&&(y.x+=c.x*u,y.y+=c.y*p);var d=y.x+s,v=f.x+u,A=y.y+a,m=f.y+p;if(f.x<d&&y.x<v&&f.y<A&&y.y<m){if(void 0!=n){var T=[new t.Vector2D(f.x-d,0),new t.Vector2D(v-y.x,0),new t.Vector2D(0,f.y-A),new t.Vector2D(0,m-y.y)];T.sort(e.VectorSortMinMag),n.mtv.SetV(T[0]),n.occured=!0}return!0}return!1},e.CirclevsCircle.Result=function(){this.mtv=new t.Vector2D(0,0),this.poc={a:null,b:null,c:null}},e.CirclevsCircle.Result.prototype.mtd=0,e.CirclevsCircle.Result.prototype.delta=null,e.CirclevsCircle.Result.prototype.occured=!1,e.CirclevsCircle.Result.prototype.Reset=function(){this.poc.a=null,this.poc.b=null,this.poc.c=null,this.mtv.Set(0,0),this.mtd=0,this.delta=null,this.occured=!1},e.CirclevsCircle.Relative.Collide=function(e,r,o){var n=e.shape,i=r.shape,s=n.radius,a=i.radius,l=s+a,h=e.anchor,u=r.anchor,p=e.relative.Copy(),c=r.relative.Copy();void 0!=h&&(p.x+=h.x*n.diameter,p.y+=h.y*n.diameter),void 0!=u&&(c.x+=u.x*i.diameter,c.y+=u.y*i.diameter);var f=c.SubtractVC(p),y=f.GetMagnitudeSquared();if(l*l>y){if(void 0!=o){var d=Math.sqrt(y),v=(n.radiusSquared-i.radiusSquared+y)/(d+d),A=new t.Vector2D(p.x+f.x*v/d,p.y+f.y*v/d),m=Math.sqrt(n.radiusSquared-v*v)/d,T=-f.y*m,S=f.x*m,g=new t.Vector2D(A.x+T,A.y+S),x=new t.Vector2D(A.x-T,A.y-S),C=p.SubtractVC(c);C.Divide(l,l);var b=d-s-a;o.poc.a=A,o.poc.b=g,o.poc.c=x,o.mtv.SetV(C),o.mtd=b,o.delta=f,o.occured=!0}return!0}return!1},e.CirclevsCircle.Relative.ElasticResponse=function(t,e,r){var o=r.delta.Copy(),n=r.mtv.Copy();o.Normalize();var i=t.mass,s=e.mass,a=t.velocity,l=e.velocity,h=a.GetDotV(o),u=l.GetDotV(o),p=2*(h-u)/(i+s);a.Set(a.x-p*s*o.x,a.y-p*s*o.y),l.Set(l.x+p*i*o.x,l.y+p*i*o.y),n.Multiply(r.mtd,r.mtd),n.Divide(2,2),t.relative.SubtractV(n),e.relative.AddV(n)},e.PolygonvsPolygon.Result=function(){this.mtv=new t.Vector2D(0,0),this.olAxis=new t.Vector2D(0,0)},e.PolygonvsPolygon.Result.prototype.occured=!1,e.PolygonvsPolygon.Result.prototype.mtd=1/0,e.PolygonvsPolygon.Result.prototype.Reset=function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)};var n=e.PolygonvsPolygon.Relative.AxisSeparates=function(t,e,o,n){var i=r(t.shape.vertices,o),s=r(e.shape.vertices,o),a=e.relative.SubtractVC(t.relative).GetDotV(o);if(s.Add(a,a),i.x>s.y||s.x>i.y)return!0;if(void 0!=n){var l=0,h=i.x,u=i.y,p=s.x,c=s.y,f=0,y=0;h<p?u<c?l=u-p:(f=u-p,y=c-h,l=f<y?f:-y):u>c?l=h-c:(f=u-p,y=c-h,l=f<y?f:-y);var d=Math.abs(l);d<n.mtd&&(n.mtd=d,n.olAxis.SetV(o),l<0&&n.olAxis.Invert())}return!1};e.PolygonvsPolygon.Relative.Collide=function(t,e,r){var o=t.shape,i=e.shape,s=o.normals,a=i.normals,l=0,h=s.length,u=a.length;for(l;l<h;++l)if(!0===n(t,e,s[l],r))return!1;for(l=0;l<u;++l)if(!0===n(t,e,a[l],r))return!1;return void 0!=r&&(r.mtv.SetV(r.olAxis),r.mtv.Multiply(r.mtd,r.mtd),r.occured=!0),!0},e.CirclevsLine.Result=function(){this.mtv=new t.Vector2D(0,0),this.cp=new t.Vector2D(0,0)},e.CirclevsLine.Result.prototype.occured=!1,e.CirclevsLine.Result.prototype.sore=0,e.CirclevsLine.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.cp.Set(0,0),this.occured=!1,this.sore=0},e.CirclevsLine.Relative.Collide=function(t,e,r){var n=e.shape,i=t.shape,s=e.relative,a=t.relative,l=n.s.AddVC(s),h=n.e.AddVC(s),u=o(l,h,a),p=a.SubtractVC(u),c=p.GetMagnitudeSquared();if(c<i.radiusSquared){if(r){var f=p,y=i.radius-Math.sqrt(c);f.Normalize(),f.Multiply(y,y),r.mtv.SetV(f),r.cp.SetV(u),r.occured=!0,u===l?r.sore=1:u===h&&(r.sore=2)}return!0}return!1},e.CirclevsLine.Relative.ReflectingResponse=function(t,e,r){var o,n,i=e.shape,s=t.velocity,a=t.relative,l=r.cp;0!==r.sore?(o=l.SubtractVC(a),o.Normalize()):o=i.GetNormalA(),n=s.GetReflectionV(o),s.SetV(n),a.AddV(r.mtv)},t.Math.Collision2D=e}},function(t,e){t.exports=function(t){"use strict";t.Math.Ease=Object.create(null),t.Math.Ease.Linear=function(t,e,r,o){return r*t/o+e},t.Math.Ease.QuadIn=function(t,e,r,o){return t/=o,r*t*t+e},t.Math.Ease.QuadOut=function(t,e,r,o){return t/=o,-r*t*(t-2)+e},t.Math.Ease.QuadInOut=function(t,e,r,o){return(t/=.5*o)<1?.5*r*t*t+e:(t--,.5*-r*(t*(t-2)-1)+e)},t.Math.Ease.SineIn=function(t,e,r,o){return-r*Math.cos(t/o*(.5*Math.PI))+r+e},t.Math.Ease.SineOut=function(t,e,r,o){return r*Math.sin(t/o*(.5*Math.PI))+e},t.Math.Ease.SineInOut=function(t,e,r,o){return.5*-r*(Math.cos(Math.PI*t/o)-1)+e}}},function(t,e){t.exports=function(t){"use strict";t.Math.PII=2*Math.PI,t.Math.DEGREES_TO_RADIANS=Math.PI/180,t.Math.RADIANS_TO_DEGREES=180/Math.PI,t.Math.RADIAN=t.Math.DEGREES_TO_RADIANS,t.Math.DegreesToRadians=function(e){return e*t.Math.DEGREES_TO_RADIANS},t.Math.DTR=t.Math.DegreesToRadians,t.Math.RadiansToDegrees=function(e){return e*t.Math.RADIANS_TO_DEGREES},t.Math.RTD=t.Math.RadiansToDegrees,t.Math.PrecisionRound=function(t,e){var r=Math.pow(10,e);return Math.round(r*t)/r},t.Math.PR=t.Math.PrecisionRound,t.Math.Spread=function(t,e,r,o){return t-r*(e-1)*.5+o*r},t.Math.AttractRepel=function(t,e,r,o,n){var i=e.SubtractVC(t);if(i.GetMagnitudeSquared()<o*o){var s=i.GetAngle();r.Add(Math.cos(s)*n,Math.sin(s)*n)}},t.Math.LineLineIntersection=function(t,e,r,o){var n=e.SubtractVC(t),i=o.SubtractVC(r),s=-i.x*n.y+n.x*i.y,a=t.x-r.x,l=t.y-r.y,h=(-n.y*a+n.x*l)/s,u=(i.x*l-i.y*a)/s;return h>=0&&h<=1&&u>=0&&u<=1&&(n.Set(t.x+u*n.x,t.y+u*n.y),n)},t.Math.ClosestPointOnLine=function(t,e,r){var o=e.SubtractVC(t),n=((r.x-t.x)*o.x+(r.y-t.y)*o.y)/o.GetMagnitudeSquared();return n<0?t:n>1?e:(o.Set(t.x+n*o.x,t.y+n*o.y),o)},t.Math.LikeASquareGrid=function(t,e,r,o){for(var n=0,i=t.length,s=e/r|0;n<i;++n)t[n].Set(n%s*r,(n/s|0)*o)},t.Math.SquareGrid=function(t,e,r,o,n){for(var i=[],s=0,a=t/r|0,l=e/o|0,h=a*l;s<h;++s)i.push(new n(s%a*r,(s/a|0)*o));return i},t.Math.TriRectArray=function(t,e,r,o,n){return null!=n?(n[0]=t,n[1]=e,n[2]=t+r,n[3]=e,n[4]=t,n[5]=e+o,n[6]=t,n[7]=e+o,n[8]=t+r,n[9]=e,n[10]=t+r,n[11]=e+o,n):[t,e,t+r,e,t,e+o,t,e+o,t+r,e,t+r,e+o]},Object.defineProperty(t.Math,"PII",{writable:!1}),Object.defineProperty(t.Math,"DEGREES_TO_RADIANS",{writable:!1}),Object.defineProperty(t.Math,"RADIANS_TO_DEGREES",{writable:!1}),Object.defineProperty(t.Math,"RADIAN",{writable:!1})}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.array=new Float32Array(9)}e.prototype=Object.create(null),e.prototype.constructor=e,e.EPSILON=1e-5,e.prototype.array=null,e.prototype.a=1,e.prototype.b=0,e.prototype.c=0,e.prototype.d=1,e.prototype.e=0,e.prototype.f=0,e.prototype.Identity=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},e.prototype.Copy=function(){var t=new e;return t.Set(this.a,this.b,this.c,this.d,this.e,this.f),t},e.prototype.Set=function(t,e,r,o,n,i){return this.a=t,this.b=e,this.c=r,this.d=o,this.e=n,this.f=i,this},e.prototype.SetTransform=function(t,e,r,o,n,i,s,a,l){t=null==t?0:t,e=null==e?0:e,r=null==r?1:r,o=null==o?1:o,n=null==n?0:n,i=null==i?0:i,s=null==s?0:s,a=null==a?0:a,l=null==l?0:l;var h=Math.sin(n),u=Math.cos(n),p=-Math.sin(i),c=Math.cos(i),f=Math.sin(s),y=Math.cos(s),d=u*r,v=h*r,A=-h*o,m=u*o;return this.a=y*d+f*A,this.b=y*v+f*m,this.c=p*d+c*A,this.d=p*v+c*m,this.e=t+a*d+l*A,this.f=e+a*v+l*m,this},e.prototype.Translate=function(t,e){this.e+=t,this.f+=e},e.prototype.ApplyTranslation=function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f},e.prototype.ApplyScale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e},e.prototype.Scale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},e.prototype.Rotate=function(t){var e=Math.sin(t),r=Math.cos(t),o=this.a,n=this.c,i=this.e;this.a=o*r-this.b*e,this.b=o*e+this.b*r,this.c=n*r-this.d*e,this.d=n*e+this.d*r,this.e=i*r-this.f*e,this.f=i*e+this.f*r},e.prototype.Decompose=function(t){var r=this.a,o=this.b,n=this.c,i=this.d,s=-Math.atan2(-n,i),a=Math.atan2(o,r);Math.abs(s+a)<e.EPSILON?(t.rotation=a,r<0&&i>=0&&(t.rotation+=Math.PI),t.skew.Set(0)):t.skew.Set(s,a),t.scale.Set(Math.sqrt(r*r+o*o),Math.sqrt(n*n+i*i)),t.position.Set(this.e,this.f)},e.prototype.ApplyToContext=function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)},e.prototype.AsArray=function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e},t.Math.Matrix2D=e,t.Matrix2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o){if(!(this instanceof e))return new e;this.position=new t.Vector2D(r,o),this.scale=new t.Vector2D(1,1),this.localTransform=new t.Vector2D(0,0),this.worldTransform=new t.Vector2D(0,0)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.UpdateLocal=function(){this.localTransform.SetV(this.position)},e.prototype.UpdateWorld=function(t){var e=this.localTransform;e.SetV(this.position),this.worldTransform.Set(t.e+e.x,t.f+e.y)},e.prototype.ApplyWorld=function(t){t.setTransform(this.scale.x,0,0,this.scale.y,this.worldTransform.x,this.worldTransform.y)},t.Math.Basetransform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o){if(!(this instanceof e))return new e(r,o);this.position=t.Vector2D(r,o),this.scale=new t.Vector2D(1,1),this.skew=new t.Vector2D(0,0),this.pivot=new t.Vector2D(0,0),this.localTransform=new t.Matrix2D,this.worldTransform=new t.Matrix2D}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.rotation=0,e.prototype.skewCX=1,e.prototype.skewSX=0,e.prototype.skewCY=0,e.prototype.skewSY=1,e.prototype.Set=function(t){t.Decompose(this),this.UpdateSkew()},e.prototype.UpdateLocal=function(){var t=this.localTransform,e=this.position,r=this.scale,o=this.pivot;t.a=this.skewCX*r.x,t.b=this.skewSX*r.x,t.c=this.skewCY*r.y,t.d=this.skewSY*r.y,t.e=e.x-o.x*t.a+o.y*t.c,t.f=e.y-o.y*t.b+o.y*t.d},e.prototype.UpdateWorld=function(t){var e=this.localTransform,r=this.worldTransform,o=this.position,n=this.scale,i=this.pivot;e.a=this.skewCX*n.x,e.b=this.skewSX*n.x,e.c=this.skewCY*n.y,e.d=this.skewSY*n.y,e.e=o.x-i.x*e.a+i.y*e.c,e.f=o.y-i.y*e.b+i.y*e.d,r.a=e.a*t.a+e.b*t.c,r.b=e.a*t.b+e.b*t.d,r.c=e.c*t.a+e.d*t.c,r.d=e.c*t.b+e.d*t.d,r.e=e.e*t.a+e.f*t.c+t.e,r.f=e.e*t.b+e.f*t.d+t.f},e.prototype.UpdateSkew=function(){var t=this.skew,e=this.rotation;this.skewCX=Math.cos(e+t.y),this.skewSX=Math.sin(e+t.y),this.skewCY=-Math.sin(e-t.x),this.skewSY=Math.cos(e-t.x)},e.prototype.ApplyWorld=function(t){this.worldTransform.ApplyToContext(t)},t.Math.Transform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i,s,a,l){if(!(this instanceof e))return new e(o,n,i,s,a,l);r.call(this,o,n),this.floor=new t.Vector2D(i,s),this.ceil=new t.Vector2D(a,l)}var r=t.Vector2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.invert=!1,e.prototype.Copy=function(){var t=new e(this.x,this.y,this.floor.x,this.floor.y,this.ceil.x,this.ceil.y);return t.invert=this.invert,t},e.prototype.Limit=function(){var e=!1===this.invert?t.Utils.Clamp:t.Utils.InverseClamp,r=this.floor,o=this.ceil;this.x=e(this.x,r.x,o.x),this.y=e(this.y,r.y,o.y)},t.Math.LimitVector2D=e,t.LimitVector2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);void 0!=t&&void 0!=t.x&&void 0!=t.y?(this.x=t.x,this.y=t.y):void 0!=t&&(void 0==r?(this.x=t,this.y=t):(this.x=t,this.y=r))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TranslateMultiple=function(t,e){for(var r=0,o=t.length;r<o;++r)t[r].AddV(e)},e.GetMinMaxDot=function(t,e){for(var r=1/0,o=-r,n=0,i=e.Copy(),s=0,a=t.length;s<a;++s)n=t[s].GetDotV(e),n>o&&(o=n),n<r&&(r=n);return i.Set(r,o),i},e.Pool=new t.Utils.Pool(e),e.Pool.Retrieve=function(t,e){0===this.objects.length&&this.Flood();var r=this.objects.pop();return r.Set(t,e),r},e.Pool.Flood(function(){},1e5),e.USE_POOL=!0,e.prototype.x=0,e.prototype.y=0,e.prototype.Copy=function(){return!0===e.USE_POOL?e.Pool.Retrieve(this.x,this.y):new e(this)},e.prototype.AbsoluteCopy=function(){var t=this.Copy();return t.Positive(),t},e.prototype.SetV=function(t){this.x=t.x,this.y=t.y},e.prototype.Set=function(t,e){void 0!=t&&void 0==e?(this.x=t,this.y=t):(this.x=t,this.y=e)},e.prototype.Is0=function(){return 0===this.x&&0===this.y},e.prototype.AddV=function(t){this.x+=t.x,this.y+=t.y},e.prototype.AddVC=function(t){var e=this.Copy();return e.AddV(t),e},e.prototype.Add=function(t,e){this.x+=t,this.y+=e},e.prototype.SubtractV=function(t){this.x-=t.x,this.y-=t.y},e.prototype.SubtractVC=function(t){var e=this.Copy();return e.SubtractV(t),e},e.prototype.Subtract=function(t,e){this.x-=t,this.y-=e},e.prototype.MultiplyV=function(t){this.x*=t.x,this.y*=t.y},e.prototype.MultiplyVC=function(t){var e=this.Copy();return e.MultiplyV(t),e},e.prototype.Multiply=function(t,e){this.x*=t,this.y*=e},e.prototype.DivideV=function(t){this.x/=t.x,this.y/=t.y},e.prototype.DivideVC=function(t){var e=this.Copy();return e.DivideV(t),e},e.prototype.Divide=function(t,e){this.x/=t,this.y/=e},e.prototype.Normalize=function(){var t=this.GetMagnitude();this.Divide(t,t)},e.prototype.Positive=function(){this.x=Math.abs(this.x),this.y=Math.abs(this.y)},e.prototype.Negative=function(){this.x=-Math.abs(this.x),this.y=-Math.abs(this.y)},e.prototype.Invert=function(){this.x=-1*this.x,this.y=-1*this.y},e.prototype.Rotate=function(t){var e=Math.sin(t),r=Math.cos(t),o=this.x,n=this.y;this.x=o*r-n*e,this.y=o*e+n*r},e.prototype.RotateBy=function(t){var e=this.GetAngle()+t,r=Math.sin(e),o=Math.cos(e),n=this.x,i=this.y;this.x=n*o-i*r,this.y=n*r+i*o},e.prototype.RotateAroundV=function(t,e){this.SubtractV(t),this.Rotate(e),this.AddV(t)},e.prototype.RotateAround=function(t,e,r){this.Subtract(t,e),this.Rotate(r),this.Add(t,e)},e.prototype.RotateAroundByV=function(t,e){this.SubtractV(t),this.RotateBy(e),this.AddV(t)},e.prototype.RotateAroundBy=function(t,e,r){this.Subtract(t,e),this.RotateBy(r),this.Add(t,e)},e.prototype.PushFromV=function(t,e){var r=this.Copy();r.SubtractV(t),r.Normalize(),r.Multiply(e,e),this.AddV(r)},e.prototype.PushFrom=function(t,e,r){var o=this.Copy();o.Subtract(t,e),o.Normalize(),o.Multiply(r,r),this.AddV(o)},e.prototype.GetAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.GetAngleBetweenV=function(t){return Math.atan2(this.y-t.y,this.x-t.x)},e.prototype.GetAngleBetween=function(t,e){return Math.atan2(this.y-e,this.x-t)},e.prototype.GetDotV=function(t){return this.x*t.x+this.y*t.y},e.prototype.GetDot=function(t,e){return this.x*t+this.y*e},e.prototype.GetCrossV=function(t){return this.x*t.y+this.y*t.x},e.prototype.GetCross=function(t,e){return this.x*e+this.y*t},e.prototype.GetMagnitudeSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.GetMagnitude=function(){return Math.sqrt(this.GetMagnitudeSquared())},e.prototype.GetDistanceV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitude()},e.prototype.GetDistance=function(t,e){var r=this.Copy();return r.Subtract(t,e),r.GetMagnitude()},e.prototype.GetDistanceSquaredV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitudeSquared()},e.prototype.GetDistanceSquared=function(t,e){var r=this.Copy();return r.Subtract(t,e),r.GetMagnitudeSquared()},e.prototype.GetPerpendicularCCWV=function(t){return new e(-(t.y-this.y),t.x-this.x)},e.prototype.GetPerpendicularCCW=function(t,r){return new e(-(r-this.y),t-this.x)},e.prototype.GetPerpendicularCWV=function(t){return new e(t.y-this.y,-(t.x-this.x))},e.prototype.GetPerpendicularCW=function(t,r){return new e(r-this.y,-(t-this.x))},e.prototype.GetNormalAV=function(t){var e=this.GetPerpendicularCCWV(t);return e.Normalize(),e},e.prototype.GetNormalA=function(t,e){var r=this.GetPerpendicularCCW(t,e);return r.Normalize(),r},e.prototype.GetNormalBV=function(t){var e=this.GetPerpendicularCWV(t);return e.Normalize(),e},e.prototype.GetNormalB=function(t,e){var r=this.GetPerpendicularCW(t,e);return r.Normalize(),r},e.prototype.GetMidPointV=function(t){var e=this.Copy();return e.AddV(t),e.Divide(2,2),e},e.prototype.GetMidPoint=function(t,e){var r=this.Copy();return r.Add(t,e),r.Multiply(.5,.5),r},e.prototype.IsEqualTo=function(t,e){return this.x===t&&this.y===e},e.prototype.IsEqualToV=function(t){return this.x===t.x&&this.y===t.y},e.prototype.GetProjectionOntoV=function(t){var r=this.GetDotV(t);if(0===r)return new e;var o=t.GetMagnitude(),n=r/(o*o),i=t.Copy();return i.Multiply(n,n),i},e.prototype.GetProjectionOnto=function(t,r){var o=this.Copy();o.Set(t,r);var n=this.GetDotV(o);if(0===n)return new e;var i=o.GetMagnitude(),s=n/(i*i);return o.Multiply(s,s),o},e.prototype.GetReflectionV=function(t){var e=t.Copy(),r=this.GetDotV(e);return e.Multiply(2,2),e.Multiply(r,r),this.SubtractVC(e)},e.prototype.GetReflection=function(t,e){var r=this.Copy();r.Set(t,e);var o=this.GetDotV(r);return r.Multiply(2,2),r.Multiply(o,o),this.SubtractVC(r)},e.prototype.Assert=function(){var e=t.Utils.Assert;e(this.x,e.IS_SAME_TYPE,0),e(this.y,e.IS_SAME_TYPE,0)},e.prototype.Store=function(){e.Pool.Store(this)},e.prototype.GetLength=e.prototype.GetMagnitude,e.prototype.GetLengthSquared=e.prototype.GetMagnitudeSquared,t.Math.Vector2D=e,t.Vector2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.motions=[],this.target=t}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.target=null,e.prototype.motions=null,e.prototype.Create=function(e,r,o,n,i){if(null===this.GetMotion(e)){var s=new t.Motion(e,this.target,r,o,n,i);return this.motions.push(s),s}return null},e.prototype.Add=function(t){null===this.GetMotion(t.id)&&this.motions.push(t)},e.prototype.Start=function(t){var e=this.GetMotion(t);return null!==e&&e.Start(),e},e.prototype.StartMultiple=function(t){t=t.split(" ");for(var e=0,r=t.length;e<r;++e)this.Start(t[e])},e.prototype.Stop=function(t){var e=this.GetMotion(t);return null!==e&&e.Stop(),e},e.prototype.StopMultiple=function(t){t=t.split(" ");for(var e=0,r=t.length;e<r;++e)this.Stop(t[e])},e.prototype.Reset=function(t){var e=this.GetMotion(t);return null!==e&&e.Reset(),e},e.prototype.ResetMultiple=function(t){t=t.split(" ");for(var e=0,r=t.length;e<r;++e)this.Reset(t[e])},e.prototype.Process=function(){for(var t,e=0,r=this.motions,o=r.length;e<o;++e)t=r[e],t.Process()},e.prototype.GetMotion=function(t){for(var e,r=0,o=this.motions,n=o.length;r<n;++r)if(e=o[r],e.id===t)return e;return null},t.MotionManager=e}},function(t,e){t.exports=function(t){"use strict";function e(r,o,n,i,s,a){if(!(this instanceof e))return new e(r,o,n,i,s,a);this.id=r,this.target=o,this.propertyString=n,void 0!==i&&(this.value=i),void 0!==s&&(this.duration=s),this.easing=t.Math.Ease[void 0===a?e.DEFAULT_EASING:a],this.onStart=new t.Event.LocalEvent,this.onEnd=new t.Event.LocalEvent,this.onStop=new t.Event.LocalEvent,this.onReconfigure=new t.Event.LocalEvent,this.onReset=new t.Event.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.DEFAULT_EASING="Linear",e.prototype.id=null,e.prototype.target=null,e.prototype.easing=null,e.prototype.duration=1e3,e.prototype.time=0,e.prototype.value=1,e.prototype.startValue=0,e.prototype.propertyString=null,e.prototype.change=0,e.prototype.property=null,e.prototype.propertyObject=null,e.prototype.running=!1,e.prototype.Start=function(){var e=this.propertyString.split(".");this.property=e[e.length-1],this.propertyObject=t.Utils.Nested(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)},e.prototype.Stop=function(){delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onStop.Dispatch(this,null)},e.prototype.Process=function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))},e.prototype.Reconfigure=function(r,o,n,i){void 0!==r&&(this.propertyString=r),this.value=o,this.duration=n,this.easing=t.Math.Ease[void 0===i?e.DEFAULT_EASING:i],this.onReconfigure.Dispatch(this,null)},e.prototype.Reset=function(){if(null===this.propertyObject||null===this.property)return!1;this.propertyObject[this.property]=this.startValue,delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onReset.Dispatch(this,null)},t.Motion=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i,s,a){if(!(this instanceof e))return new e(o,n,i,s,a);r.call(this,o,n,i,s),this.style=t.Style.CreateFSSa(a)}var r=t.Geom.AABB2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.Draw=function(t){var e=this.tl,r=this.br,o=this.style,n=o.fill,i=o.stroke,s=o.shadow;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(r.x,e.y),t.lineTo(r.x,r.y),t.lineTo(e.x,r.y),t.closePath(),!0===s.applied&&s.Apply(t),!0===n.applied&&(n.Apply(t),t.fill()),!0===i.applied&&(i.Apply(t),t.stroke())},e.prototype.GLDraw=function(t,e){null!=this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!=t&&null!=t.fillColor&&null!=t.outlineColor&&null!=t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2)},t.Path.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i,s){if(!(this instanceof e))return new e(o,n,i,s);r.call(this,o,n,i),this.style=t.Style.CreateFSSa(s)}var r=t.Geom.Circle;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.Draw=function(e){var r=this.center,o=this.style,n=o.fill,i=o.stroke,s=o.shadow;e.beginPath(),e.arc(r.x,r.y,this.radius,0,t.Math.PII,!1),e.closePath(),!0===s.applied&&s.Apply(e),!0===n.applied&&(n.Apply(e),e.fill()),!0===i.applied&&(i.Apply(e),e.stroke())},e.prototype.GLDraw=function(t,e){null!=this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.center.x,this.center.y,this.radius)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!=t&&null!=t.fillColor&&null!=t.outlineColor&&null!=t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2)},t.Path.Circle=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i,s,a){if(!(this instanceof e))return new e(o,n,i,s,a);r.call(this,o,n,i,s),this.style=t.Style.CreateSSa(a)}var r=t.Geom.Line2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.style=null,e.prototype.programController=null,e.prototype.Draw=function(t){var e=this.s,r=this.e,o=this.style,n=o.stroke,i=o.shadow;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(r.x,r.y),t.closePath(),!0===i.applied&&i.Apply(t),!0===n.applied&&(n.Apply(t),t.stroke())},e.prototype.GLDraw=function(t,e){null!=this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.s,this.e)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!=t&&null!=t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize())},t.Path.Line2D=e,t.Path.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n,i){if(!(this instanceof e))return new e(o,n,i);r.call(this,o,n),this.style=new t.Style.CreateP(i),this.colorObj=new t.Color}var r=t.Math.Vector2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.colorObj=null,e.prototype.style=null,e.prototype.programController=null,e.prototype.bufferData=null,e.prototype.GLDraw=function(t,e){null!=this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)},e.prototype.LinkProgramController=function(t){this.programController=t,this.LinkStyle()},e.prototype.UseProgramController=function(t){this.programController=t},e.prototype.LinkStyle=function(){var t=this.programController;null!=t&&null!=t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())},e.prototype.GetBufferData=function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData;return t[0]=this.x,t[1]=this.y,t[2]=this.colorObj.r,t[3]=this.colorObj.g,t[4]=this.colorObj.b,t[5]=this.colorObj.a,t[6]=this.style.pixel.size,t},e.prototype.UpdateInBuffer=function(t,e){t[e]=this.x,t[e+1]=this.y,t[e+2]=this.colorObj.r,t[e+3]=this.colorObj.g,t[e+4]=this.colorObj.b,t[e+5]=this.colorObj.a,t[e+6]=this.style.pixel.size},t.Path.Pixel2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,n){if(!(this instanceof e))return new e(o,n);r.call(this,o),this.style=t.Style.CreateFSSa(n)}var r=t.Geom.Polygon2D;e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.Draw=function(t){var e=this.style,r=e.fill,o=e.stroke,n=e.shadow,i=this.vertices,s=i[0];t.beginPath(),t.moveTo(s.x,s.y);for(var a=1,l=i.length;a<l;++a)s=i[a],t.lineTo(s.x,s.y);t.closePath(),!0===n.applied&&n.Apply(t),!0===r.applied&&(r.Apply(t),t.fill()),!0===o.applied&&(o.Apply(t),t.stroke())},t.Path.Polygon2D=e}},function(t,e,r){t.exports=function(t){"use strict";function e(t){var e,r,o="@vertex@",n="@fragment@";e=t.indexOf(o)+o.length,r=t.indexOf("@vertex-end@");var i=t.substring(e,r);return e=t.indexOf(n)+n.length,r=t.indexOf("@fragment-end@"),{v:i,f:t.substring(e,r)}}t.SHADER_CODE={TEXTURE_2D:e(r(15)),TEXTURE_2D_BATCH:e(r(14)),LINE2D:e(r(12)),RECTANGLE:e(r(13)),CIRCLE:e(r(11)),PIXEL_BATCH:e(r(10))}}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);t.Utils.ApplyProperties(this,r)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#444499",e.prototype.applied=!0,e.prototype.Apply=function(t){t.fillStyle=this.color},t.Style.Fill=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);t.Utils.ApplyProperties(this,r)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#000000",e.prototype.size=1,t.Style.Pixel=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);t.Utils.ApplyProperties(this,r)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.color="#000000",e.prototype.blur=5,e.prototype.offsetX=0,e.prototype.offsetY=0,e.prototype.applied=!1,e.prototype.Apply=function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY},t.Style.Shadow=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);t.Utils.ApplyProperties(this,r)}e.prototype=Object.create(null),e.prototype.constructor=e,t.Style.LINE_CAP={ROUND:"round",BUTT:"butt",SQUARE:"square"},t.Style.LINE_JOIN={BEVEL:"bevel",ROUND:"round",MITER:"miter"},e.prototype.color="#00FFFF",e.prototype.lineCap=t.Style.LINE_CAP.ROUND,e.prototype.lineJoin=t.Style.LINE_JOIN.ROUND,e.prototype.lineWidth=1,e.prototype.miterLimit=10,e.prototype.applied=!0,e.prototype.Apply=function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit},t.Style.Stroke=e}},function(t,e){t.exports=function(t){"use strict";t.Style.CreateAll=function(e){return{fill:new t.Style.Fill(e?e.fill:null),stroke:new t.Style.Stroke(e?e.stroke:null),shadow:new t.Style.Shadow(e?e.shadow:null),text:new t.Style.Text(e?e.text:null),pixel:new t.Style.Pixel(e?e.pixel:null)}},t.Style.CreateFSSa=function(e){return{fill:new t.Style.Fill(e?e.fill:null),stroke:new t.Style.Stroke(e?e.stroke:null),shadow:new t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateSSa=function(e){return{stroke:new t.Style.Stroke(e?e.stroke:null),shadow:new t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateFSa=function(e){return{fill:new t.Style.Fill(e?e.fill:null),shadow:new t.Style.Shadow(e?e.shadow:null)}},t.Style.CreateSaT=function(e){return{shadow:new t.Style.Shadow(e?e.shadow:null),text:new t.Style.Text(e?e.text:null)}},t.Style.CreateP=function(e){return{pixel:new t.Style.Pixel(e?e.pixel:null)}},t.Style.GCO=Object.create(null),t.Style.GCO.SOURCE_OVER=t.Style.GCO.DEFAULT="source-over",t.Style.GCO.SOURCE_IN="source-in",t.Style.GCO.SOURCE_OUT="source-out",t.Style.GCO.SOURCE_ATOP="source-atop",t.Style.GCO.DESTINATION_OVER="destination-over",t.Style.GCO.DESTINATION_IN="destination-in",t.Style.GCO.DESTINATION_OUT="destination-out",t.Style.GCO.DESTINATION_ATOP="destination-atop",t.Style.GCO.LIGHTER="lighter",t.Style.GCO.COPY="copy",t.Style.GCO.XOR="xor",t.Style.GCO.MULTIPLY="multiply",t.Style.GCO.OVERLAY="overlay",t.Style.GCO.DARKEN="darken",t.Style.GCO.LIGHTEN="lighten",t.Style.GCO.COLOR_DODGE="color-dodge",t.Style.GCO.COLOR_BURN="color-burn",t.Style.GCO.HARD_LIGHT="hard-light",t.Style.GCO.SOFT_LIGHT="soft-light",t.Style.GCO.DIFFERENCE="difference",t.Style.GCO.EXCLUSION="exclusion",t.Style.GCO.HUE="hue",t.Style.GCO.SATURATION="saturation",t.Style.GCO.COLOR="color",t.Style.GCO.LUMINOSITY="luminosity"}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);t.Utils.ApplyProperties(this,r),this.ConcatFont()}e.prototype=Object.create(null),e.prototype.constructor=e,t.Style.TEXT_ALIGN={START:"start",END:"end",CENTER:"center",LEFT:"left",RIGHT:"right"},t.Style.TEXT_BASELINE={ALPHABETIC:"alphabetic",TOP:"top",HANGING:"hanging",MIDDLE:"middle",IDEOGRAPHIC:"ideographic",BOTTOM:"bottom"},e.prototype.fillColor="#444499",e.prototype.strokeColor="#00FFFF",e.prototype.fontSize=22,e.prototype.font=null,e.prototype.fontFamily="Arial",e.prototype.align=t.Style.TEXT_ALIGN.LEFT,e.prototype.baseline=t.Style.TEXT_BASELINE.TOP,e.prototype.applied=!0,e.prototype.lineWidth=.5,e.prototype.Apply=function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth},e.prototype.ConcatFont=function(){this.font=this.fontSize+"px "+this.fontFamily},t.Style.Text=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n,i,s){if(!(this instanceof e))return new e(t,o,n,i,s);this.image=t,this.id=null!=r?r:t.id,this.w=null!=o?o:t.naturalWidth,this.h=null!=n?n:t.naturalHeight,this.fw=null!=i?i:t.naturalWidth,this.fh=null!=s?s:t.naturalHeight}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.image=null,t.Texture.BasicTexture=e,t.BasicTexture=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o){if(!(this instanceof e))return new e(t,r,o);if("function"!=typeof t)throw new Error("Ticker: An onProcess function is required!");this.SetDesiredRate(r),this.onProcess=t,void 0!=o&&!1!==o||this.StartAF()}e.prototype=Object.create(null),e.prototype.constructor=e,e.LOG=!0,e.GLOBAL_CSS="background-color:black;font-family:Arial;font-size:18px;",e.Log=function(){!1!==e.LOG&&console.log.apply(null,arguments)},e.prototype.intervalId=null,e.prototype.afId=null,e.prototype.delta=0,e.prototype.then=0,e.prototype.now=0,e.prototype.desiredRate=0,e.prototype.supplyDelta=!0,e.prototype.Process=function(){this.ComputeDelta(),this.onProcess(this.delta)},e.prototype.ProcessAF=function(){this.ComputeDelta(),this.onProcess(this.delta),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))},e.prototype.ComputeDelta=function(){this.now=(new Date).getTime(),this.delta=this.now-this.then,this.then=this.now},e.prototype.GetTPS=function(){return t.Math.PR(1/this.delta*1e3,2)},e.prototype.SetDesiredRate=function(t){this.desiredRate=void 0===t?16.66:1e3/t},e.prototype.Start=function(t){if(null!==this.afId)return e.Log("%cTicker: RAF is running!","color:red;".concat(e.GLOBAL_CSS)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process,this.desiredRate),e.Log("%cTicker: Starting interval!","color:#0F0;".concat(e.GLOBAL_CSS))):e.Log("%cTicker: Interval already running!","color:#F00;".concat(e.GLOBAL_CSS)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),e.Log("%cTicker: Starting interval!","color:#0F0;".concat(e.GLOBAL_CSS)))},e.prototype.StartAF=function(t){if(null!==this.intervalId)return e.Log("%cTicker: Interval is running!","color:#F00;".concat(e.GLOBAL_CSS)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),e.Log("%cTicker: Starting RAF!","color:#0F0;".concat(e.GLOBAL_CSS))):e.Log("%cTicker: RAF already running!","color:#F00;".concat(e.GLOBAL_CSS)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),e.Log("%cTicker: Starting RAF!","color:#0F0;".concat(e.GLOBAL_CSS)))},e.prototype.Stop=function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,e.Log("%cTicker: Stopping interval!","color:cyan;".concat(e.GLOBAL_CSS))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,e.Log("%cTicker: Stopping RAF!","color:cyan;".concat(e.GLOBAL_CSS)))},t.Time.Ticker=e,t.Ticker=e}},function(t,e){t.exports=function(t){"use strict";function e(r){if(!(this instanceof e))return new e(r);this.stopTime=Math.round(void 0===r?null:r),this.onStop=new t.LocalEvent,this.onFinish=new t.LocalEvent,this.onStart=new t.LocalEvent,this.onReset=new t.LocalEvent,this.onPause=new t.LocalEvent,this.onResume=new t.LocalEvent}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.time=0,e.prototype.isRunning=!1,e.prototype.canResume=!1,e.prototype.count=0,e.prototype.Reset=function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1,this.stopTime=null},e.prototype.Start=function(t){this.stopTime=Math.round(void 0===t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))},e.prototype.Stop=function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))},e.prototype.Pause=function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))},e.prototype.Resume=function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))},e.prototype.Process=function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))},t.Time.Timer=e,t.Timer=e}},function(t,e,r){(function(e){t.exports=function(t){"use strict";function r(t,e,f,y){if(void 0==y||"function"!=typeof t.Assert)switch(e){case r.IS:return void o(t,f,e);case r.IS_NOT:return void n(t,f,e);case r.IS_SAME_TYPE:return void i(t,f,e);case r.IS_NOT_SAME_TYPE:return void s(t,f,e);case r.IS_INSTANCE_OF:return void a(t,f,e);case r.IS_NOT_INSTANCE_OF:return void l(t,f,e);case r.IS_LESS_THAN:return void h(t,f,e);case r.IS_GREATER_THAN:return void u(t,f,e);case r.IS_LESS_THAN_OR_EQUAL:return void p(t,f,e);case r.IS_GREATER_THAN_OR_EQUAL:return void c(t,f,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,f)}function o(t,e,r){var o=!1;t!==e&&(o=!0),f(o,t,e,r)}function n(t,e,r){var o=!1;t===e&&(o=!0),f(o,t,e,r)}function i(t,e,r){var o=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)||Array.isArray(e)||(o=!0):null===t||null===e?t!==e&&(o=!0):typeof t!=typeof e&&(o=!0),f(o,t,e,r)}function s(t,e,r){var o=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(o=!0):null===t||null===e?e===t&&(o=!0):typeof t==typeof e&&(o=!0),f(o,t,e,r)}function a(t,e,r){var o=!1;t instanceof e||(o=!0),f(o,t,e.name,r)}function l(t,e,r){var o=!1;t instanceof e&&(o=!0),f(o,t,e.name,r)}function h(t,e,r){var o=!1;t>=e&&(o=!0),f(o,t,e,r)}function u(t,e,r){var o=!1;t<=e&&(o=!0),f(o,t,e,r)}function p(t,e,r){var o=!1;t>e&&(o=!0),f(o,t,e,r)}function c(t,e,r){var o=!1;t<e&&(o=!0),f(o,t,e,r)}function f(t,e,o,n){if(t)throw y(e,o,n),new Error("Assertion failed: "+n);r.LOG&&window&&d(e,o,n)}function y(t,e,o){switch(o){case r.IS:o=r.IS_NOT;break;case r.IS_NOT:o=r.IS;break;case r.IS_SAME_TYPE:o=r.IS_NOT_SAME_TYPE;break;case r.IS_NOT_SAME_TYPE:o=r.IS_SAME_TYPE;break;case r.IS_INSTANCE_OF:o=r.IS_NOT_INSTANCE_OF;break;case r.IS_NOT_INSTANCE_OF:o=r.IS_INSTANCE_OF;break;case r.IS_LESS_THAN:o=r.IS_GREATER_THAN_OR_EQUAL;break;case r.IS_GREATER_THAN:o=r.IS_LESS_THAN_OR_EQUAL;break;case r.IS_LESS_THAN_OR_EQUAL:o=r.IS_GREATER_THAN;break;case r.IS_GREATER_THAN_OR_EQUAL:o=r.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,o,e)}function d(t,e,r){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(r),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}r.IS="IS",r.IS_NOT="IS NOT",r.IS_SAME_TYPE="IS SAME TYPE",r.IS_NOT_SAME_TYPE="IS NOT SAME TYPE",r.IS_INSTANCE_OF="IS INSTANCE OF",r.IS_NOT_INSTANCE_OF="IS NOT INSTANCE OF",r.IS_LESS_THAN="IS LESS THAN",r.IS_GREATER_THAN="IS GREATER THAN",r.IS_LESS_THAN_OR_EQUAL="IS LESS THAN OR EQUAL",r.IS_GREATER_THAN_OR_EQUAL="IS GREATER THAN OR EQUAL",r.GlobalAssign=function(){var t;if(window?t=window:e&&(t=e),!t)throw new Error("No global namespace");t.IS="IS",t.IS_NOT="IS NOT",t.IS_SAME_TYPE="IS SAME TYPE",t.IS_NOT_SAME_TYPE="IS NOT SAME TYPE",t.IS_INSTANCE_OF="IS INSTANCE OF",t.IS_NOT_INSTANCE_OF="IS NOT INSTANCE OF",t.IS_LESS_THAN="IS LESS THAN",t.IS_GREATER_THAN="IS GREATER THAN",t.IS_LESS_THAN_OR_EQUAL="IS LESS THAN OR EQUAL",t.IS_GREATER_THAN_OR_EQUAL="IS GREATER THAN OR EQUAL"},r.LOG=!1,t.Utils.Assert=r,t.Assert=r}}).call(e,r(0))},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);null!=t&&(this.type=t),this.items=[]}var r=t.Utils.Assert,o=Object.create(null);e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.type=null,e.prototype.Store=function(t){var e=!1;return null==t?null:(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1!==e&&(this.items.push(t),!0))},e.prototype.StoreSafe=function(t){return null!=this.type&&r(t,r.IS_INSTANCE_OF,this.type),r(t,r.IS_SAME_TYPE,o),t.id?(r(t.id,r.IS_SAME_TYPE,""),r(t.id,r.IS_NOT,"")):(r(t.data,r.IS_SAME_TYPE,o),r(t.data.id,r.IS_SAME_TYPE,""),r(t.data.id,r.IS_NOT,"")),this.items.push(t),!0},e.prototype.Get=function(t){for(var e=0,r=this.items,o=r.length;e<o;++e)if(r[e]===t)return t;return null},e.prototype.GetById=function(t){for(var e=0,r=this.items,o=r.length,n=r[e];e<o;n=r[++e])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null},e.prototype.PerformOnAll=function(t,e,r){for(var o=0,n=this.items,i=n.length,s=n[o];o<i;s=n[++o])null!=s&&s[t]&&s[t].apply(r||s,e);return null},e.prototype.Contains=function(t,e){for(var r=0,o=this.items,n=o.length,i=o[r];r<n;i=o[++r])if(null!=i){if(i===t)return!0;if(i.id===e)return!0;if(null!=i.data&&i.data.id===e)return!0}return!1},t.Utils.Cache=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n){if(!(this instanceof e))return new e(t,r,o,n);this.channel=new Float32Array([void 0===t?0:t,void 0===r?0:r,void 0===o?0:o,void 0===n?1:n]),this.ComputeValueRGBA()}var r=t.Utils.Base16ToBase10,o=t.Utils.Clamp;e.prototype=Object.create(null),e.prototype.constructor=e;var n=e.NORM=1/255;e.prototype.value="",e.prototype.currentConversion="",e.prototype.Copy=function(){var t=new e(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return t.value=this.value,t.currentConversion=this.currentConversion,t},e.prototype.ComputeValueRGBA=function(){this.value="rgba(".concat(this.channel.join(",").concat(")"))},e.prototype.ComputeValueHSLA=function(){this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")"},e.prototype.ConvertToHSLA=function(t){var e=this.channel[0]/255,r=this.channel[1]/255,o=this.channel[2]/255,n=Math.max(e,r,o),i=Math.min(e,r,o),s=n-i,a=n+i,l=0,h=0,u=.5*a;n!==i&&(h=u>.5?s/(2-n-i):s/(n+i),l=n===e?(r-o)/s+(r<o?6:0):n===r?(o-e)/s+2:(e-r)/s+4,l/=6),this.channel[0]=360*l,this.channel[1]=100*h,this.channel[2]=100*u,!0===t&&(this.channel[0]=Math.round(this.channel[0]),this.channel[1]=Math.round(this.channel[1]),this.channel[2]=Math.round(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()},e.prototype.SetRGB=function(t,e,r,n){this.channel[0]=o(t,0,255),this.channel[1]=o(e,0,255),this.channel[2]=o(r,0,255),this.currentConversion="rgb",n||this.ComputeValueRGBA()},e.prototype.SetRGBA=function(t,e,r,n){this.SetRGB(t,e,r,!0),this.channel[3]=o(n,0,1),this.ComputeValueRGBA()},e.prototype.SetHex=function(t){t=t.replace(/#/g,"");var e=t.match(/.{2}/g);e=e.map(r),null==e[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])},e.prototype.IncreaseChannel=function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()},e.prototype.SetChannel=function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()},e.prototype.Normalize=function(){this.channel[0]=n*this.channel[0],this.channel[1]=n*this.channel[1],this.channel[2]=n*this.channel[2]},Object.defineProperty(e.prototype,"r",{set:function(t){this.channel[0]=t},get:function(){return this.channel[0]}}),Object.defineProperty(e.prototype,"g",{set:function(t){this.channel[1]=t},get:function(){return this.channel[1]}}),Object.defineProperty(e.prototype,"b",{set:function(t){this.channel[2]=t},get:function(){return this.channel[2]}}),Object.defineProperty(e.prototype,"a",{set:function(t){this.channel[3]=t},get:function(){return this.channel[3]}}),t.Color=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.NONE=0,e.prototype.next=1,e.prototype.Add=function(t){t=t.toUpperCase(),void 0===this[t]&&(this[t]=this.next,this.next=this.next<<1)},t.Utils.FlagEnum=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.value=0,e.prototype.Add=function(t){this.value|=t},e.prototype.Remove=function(t){this.value=this.value&~t},e.prototype.Compare=function(t){return 0!=(this.value&t)},e.prototype.Holds=function(t){return(this.value&t)===t},e.prototype.Toggle=function(t){this.value^=t},t.Utils.FlagList=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.class=t,this.objects=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.class=null,e.prototype.objects=null,e.prototype.floodFunction=null,e.prototype.floodAmount=0,e.prototype.context=null,e.prototype.Store=function(t){this.objects.push(t)},e.prototype.Retrieve=function(){return 0===this.objects.length&&this.Flood(),this.objects.pop()},e.prototype.Flood=function(t,e,r){t&&(this.floodFunction=t),e&&(this.floodAmount=e),r&&(this.context=r);for(var o=0;o<this.floodAmount;++o){var n=new this.class;this.Store(n),this.floodFunction.call(this.context,n)}},e.prototype.Flush=function(){this.objects.length=0},e.prototype.Clean=function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)},t.Utils.Pool=e,t.Pool=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r,o,n){if(!(this instanceof e))return new e(t,r,o,n);this.aabb=t,this.level=r,this.objectCap=o,this.levelCap=n,this.nodes={},this.objects=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.prototype.objectCap=0,e.prototype.levelCap=0,e.prototype.level=0,e.prototype.nodes=null,e.prototype.objects=null,e.prototype.aabb=null,e.prototype.hasSplit=!1,e.prototype.Add=function(t){var e="",r=this.objects,o=this.nodes,n=0;if(!0===this.hasSplit&&null!==(e=this.Marking(t)))return void o[e].Add(t);if(r.push(t),this.level<this.levelCap&&r.length>this.objectCap)for(!1===this.hasSplit&&this.Split();n<r.length;)e=this.Marking(r[n]),null!==e?o[e].Add(r.splice(n,1)[0]):++n},e.prototype.Converge=function(t){var r=this.objects.slice(),o=null,n=this.nodes;return!0===this.hasSplit&&(o=this.Marking(t),null!==o?r=r.concat(n[o].Converge(t)):(r=r.concat(n[e.TOP_LEFT].Converge(t)),r=r.concat(n[e.TOP_RIGHT].Converge(t)),r=r.concat(n[e.BOTTOM_LEFT].Converge(t)),r=r.concat(n[e.BOTTOM_RIGHT].Converge(t)))),r},e.prototype.Split=function(){var t=this.level+1,r=this.objectCap,o=this.levelCap,n=this.nodes,i=this.aabb;n[e.TOP_LEFT]=new e(i.GetQuadrant(e.TOP_LEFT),t,r,o),n[e.TOP_RIGHT]=new e(i.GetQuadrant(e.TOP_RIGHT),t,r,o),n[e.BOTTOM_LEFT]=new e(i.GetQuadrant(e.BOTTOM_LEFT),t,r,o),n[e.BOTTOM_RIGHT]=new e(i.GetQuadrant(e.BOTTOM_RIGHT),t,r,o),this.hasSplit=!0},e.prototype.Dump=function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[e.TOP_LEFT].Dump(),t[e.TOP_RIGHT].Dump(),t[e.BOTTOM_LEFT].Dump(),t[e.BOTTOM_RIGHT].Dump()),this.nodes={},this.hasSplit=!1},e.prototype.Marking=function(t){var r=this.nodes;return!0===r[e.TOP_LEFT].aabb.ContainsAABB2D(t)?e.TOP_LEFT:!0===r[e.TOP_RIGHT].aabb.ContainsAABB2D(t)?e.TOP_RIGHT:!0===r[e.BOTTOM_LEFT].aabb.ContainsAABB2D(t)?e.BOTTOM_LEFT:!0===r[e.BOTTOM_RIGHT].aabb.ContainsAABB2D(t)?e.BOTTOM_RIGHT:null},e.prototype.ConcatNodes=function(t){void 0===t&&(t=[]),t.push(this);var r=this.nodes;return!1===this.hasSplit?t:(r[e.TOP_LEFT].ConcatNodes(t),r[e.TOP_RIGHT].ConcatNodes(t),r[e.BOTTOM_LEFT].ConcatNodes(t),r[e.BOTTOM_RIGHT].ConcatNodes(t),t)},t.Utils.QuadtreeNode=e,t.QuadtreeNode=e}},function(t,e){t.exports=function(t){"use strict";var e=Math.random,r=null,o=null,n=t.Utils.RandomInteger=function(t,r){return e()*(r-t+1)+t|0};t.Utils.RandomFloat=function(t,r){return e()*(r-t)+t};var i=t.Utils.IsInteger=function(t){return Number(t)===t&&t%1==0};t.Utils.IsFloat=function(t){return Number(t)===t&&t%1!=0},t.Utils.Clamp=function(t,e,r){return t<e?e:t>r?r:t},t.Utils.InverseClamp=function(t,e,r){return t<e?r:t>r?e:t},t.Utils.ThisOrThat=function(t,e){return 1===n(1,2)?t:e},t.Utils.IntegerNotation=function(t,e,r){var o=t%e,n=t/e;return Math.ceil(0===o?n+1:n)+r+(1+o)},t.Utils.UUID=function(e,r,o,s){e=void 0===e?32:e,r=void 0===r?4:r,o=void 0===o?0:o,s=void 0===s?"-":s;for(var a,l,h="",u=0,p=e/r|0,c=t.Utils.CharacterSets[o];u<e;++u)a=u/p,0!==a&&i(a)?h+=s:(l=n(1,c.length-1),h+=c.charAt(l));return h},t.Utils.CharacterSets=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"],t.Utils.ApplyProperties=function(t,e){if(void 0!==e){var r;for(r in e)void 0!==t[r]&&(t[r]=e[r])}},t.Utils.Nested=function(e,r,o,n,i,s){"string"==typeof r&&(s=void 0===s?".":s,r=r.split(s));var a;if(r.length>1){if(a=r.shift(),void 0!==e[a])return t.Utils.Nested(e[a],r,o,n,i,s)}else{if(a=r.shift(),void 0!==e[a])return!0===n?void(e[a]=i):!0===o?e:e[a];if(!0===n)return void(e[a]=i)}},t.Utils.ArrayGetRandom=function(t,r){for(var o=[],n={},i=t.length,s=0,a=r;s<a;++s){var l=e()*i|0;void 0===n[l]?(n[l]=null,o.push(t[l])):s--}return o},t.Utils.ArrayShuffle=function(t){for(var r,o,n=t.length-1;n>=0;--n)o=e()*n|0,r=t[n],t[n]=t[o],t[o]=r},t.Utils.Cipher={},t.Utils.Decipher={},t.Utils.Cipher.CCH1=function(t,e){var r=[];e=void 0===e?1:e;for(var o,i,s=0,a=t.split(""),l=a.length;s<l;++s)o=a[s],o=(o.charCodeAt(0)+e).toString(2),i=n(1,9),r.push(i+"x"+o.replace(/1/g,i));return r.join(" ")},t.Utils.Decipher.CCH1=function(t,e){var r=[];e=void 0===e?1:e;for(var o,n=0,i=t.split(" "),s=i.length;n<s;++n)o=i[n],o=o.slice(2-o.length),r.push(String.fromCharCode(parseInt(o.replace(/[2-9]/g,"1"),2)-e));return r.join("")},t.Utils.GenerateSimpleBase64Png=function(t){var e=t();return null==r&&(r=document.createElement("canvas"),o=r.getContext("2d")),o.clearRect(0,0,r.width,r.height),r.width=e.w,r.height=e.h,o.setTransform(1,0,0,1,0,0),e.Draw(o),r.toDataURL("image/png")},t.Utils.ImageFromDataURL=function(t,e,r){var o=new Image;return o.src=t,o.width=e,o.height=r,o},t.Utils.Base16ToBase10=function(t){return parseInt(t,16)},t.Utils.Base2ToBase10=function(t){return parseInt(t,2)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){t.exports=r(1)}]);
//# sourceMappingURL=nk.min.js.map