/**
* @package     Nenkraft
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     0.7.5 (Beta)
* @copyright   (C) 2017-2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft/blob/master/LICENSE}
*/
exports.nkb=function(t){function e(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=84)}([function(t,e){t.exports=function(){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var o=this[e];return this[e]=this[t],this[t]=o,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var o=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),o}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}}},function(t,e){t.exports=function(t){"use strict";t.Math.PII=2*Math.PI,t.Math.DEGREES_TO_RADIANS=Math.PI/180,t.Math.RADIANS_TO_DEGREES=180/Math.PI,t.Math.RADIAN=t.Math.DEGREES_TO_RADIANS,t.Math.DegreesToRadians=function(e){return e*t.Math.DEGREES_TO_RADIANS},t.Math.DTR=t.Math.DegreesToRadians,t.Math.RadiansToDegrees=function(e){return e*t.Math.RADIANS_TO_DEGREES},t.Math.RTD=t.Math.RadiansToDegrees,t.Math.PrecisionRound=function(t,e){var o=Math.pow(10,e);return Math.round(o*t)/o},t.Math.PR=t.Math.PrecisionRound,t.Math.Spread=function(t,e,o,r){return t-o*(e-1)*.5+r*o},t.Math.AttractRepel=function(t,e,o,r,i){var n=e.SubtractVC(t);if(n.GetMagnitudeSquared()<r*r){var s=n.GetAngle();o.Add(Math.cos(s)*i,Math.sin(s)*i)}},t.Math.LineLineIntersection=function(t,e,o,r){var i=e.SubtractVC(t),n=r.SubtractVC(o),s=-n.x*i.y+i.x*n.y,a=t.x-o.x,h=t.y-o.y,p=(-i.y*a+i.x*h)/s,u=(n.x*h-n.y*a)/s;return p>=0&&p<=1&&u>=0&&u<=1&&(i.Set(t.x+u*i.x,t.y+u*i.y),i)},t.Math.ClosestPointOnLine=function(t,e,o){var r=e.SubtractVC(t),i=((o.x-t.x)*r.x+(o.y-t.y)*r.y)/r.GetMagnitudeSquared();return i<0?t:i>1?e:(r.Set(t.x+i*r.x,t.y+i*r.y),r)},t.Math.LikeASquareGrid=function(t,e,o,r){for(var i=0,n=t.length,s=e/o|0;i<n;++i)t[i].Set(i%s*o,(i/s|0)*r)},t.Math.SquareGrid=function(t,e,o,r,i){for(var n=[],s=0,a=t/o|0,h=e/r|0,p=a*h;s<p;++s)n.push(new i(s%a*o,(s/a|0)*r));return n},t.Math.TriRectArray=function(t,e,o,r,i){return null!=i?(i[0]=t,i[1]=e,i[2]=t+o,i[3]=e,i[4]=t,i[5]=e+r,i[6]=t,i[7]=e+r,i[8]=t+o,i[9]=e,i[10]=t+o,i[11]=e+r,i):[t,e,t+o,e,t,e+r,t,e+r,t+o,e,t+o,e+r]},Object.defineProperty(t.Math,"PII",{writable:!1}),Object.defineProperty(t.Math,"DEGREES_TO_RADIANS",{writable:!1}),Object.defineProperty(t.Math,"RADIANS_TO_DEGREES",{writable:!1}),Object.defineProperty(t.Math,"RADIAN",{writable:!1})}},function(t,e,o){(function(e){t.exports=function(t){"use strict";function o(t,e,f,y){if(void 0==y||"function"!=typeof t.Assert)switch(e){case o.IS:return void r(t,f,e);case o.IS_NOT:return void i(t,f,e);case o.IS_SAME_TYPE:return void n(t,f,e);case o.IS_NOT_SAME_TYPE:return void s(t,f,e);case o.IS_INSTANCE_OF:return void a(t,f,e);case o.IS_NOT_INSTANCE_OF:return void h(t,f,e);case o.IS_LESS_THAN:return void p(t,f,e);case o.IS_GREATER_THAN:return void u(t,f,e);case o.IS_LESS_THAN_OR_EQUAL:return void c(t,f,e);case o.IS_GREATER_THAN_OR_EQUAL:return void l(t,f,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,f)}function r(t,e,o){var r=!1;t!==e&&(r=!0),f(r,t,e,o)}function i(t,e,o){var r=!1;t===e&&(r=!0),f(r,t,e,o)}function n(t,e,o){var r=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(r=!0):null===t||null===e?t!==e&&(r=!0):typeof t!=typeof e?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(r=!0),f(r,t,e,o)}function s(t,e,o){var r=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(r=!0):null===t||null===e?e===t&&(r=!0):typeof t==typeof e?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(r=!0),f(r,t,e,o)}function a(t,e,o){var r=!1;t instanceof e||(r=!0),f(r,t,e.name,o)}function h(t,e,o){var r=!1;t instanceof e&&(r=!0),f(r,t,e.name,o)}function p(t,e,o){var r=!1;t>=e&&(r=!0),f(r,t,e,o)}function u(t,e,o){var r=!1;t<=e&&(r=!0),f(r,t,e,o)}function c(t,e,o){var r=!1;t>e&&(r=!0),f(r,t,e,o)}function l(t,e,o){var r=!1;t<e&&(r=!0),f(r,t,e,o)}function f(t,e,r,i){if(t)throw y(e,r,i),new Error("Assertion failed: "+i);o.LOG&&window&&d(e,r,i)}function y(t,e,r){switch(r){case o.IS:r=o.IS_NOT;break;case o.IS_NOT:r=o.IS;break;case o.IS_SAME_TYPE:r=o.IS_NOT_SAME_TYPE;break;case o.IS_NOT_SAME_TYPE:r=o.IS_SAME_TYPE;break;case o.IS_INSTANCE_OF:r=o.IS_NOT_INSTANCE_OF;break;case o.IS_NOT_INSTANCE_OF:r=o.IS_INSTANCE_OF;break;case o.IS_LESS_THAN:r=o.IS_GREATER_THAN_OR_EQUAL;break;case o.IS_GREATER_THAN:r=o.IS_LESS_THAN_OR_EQUAL;break;case o.IS_LESS_THAN_OR_EQUAL:r=o.IS_GREATER_THAN;break;case o.IS_GREATER_THAN_OR_EQUAL:r=o.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,r,e)}function d(t,e,o){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(o),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}o.IS="IS",o.IS_NOT="IS NOT",o.IS_SAME_TYPE="IS SAME TYPE",o.IS_NOT_SAME_TYPE="IS NOT SAME TYPE",o.IS_INSTANCE_OF="IS INSTANCE OF",o.IS_NOT_INSTANCE_OF="IS NOT INSTANCE OF",o.IS_LESS_THAN="IS LESS THAN",o.IS_GREATER_THAN="IS GREATER THAN",o.IS_LESS_THAN_OR_EQUAL="IS LESS THAN OR EQUAL",o.IS_GREATER_THAN_OR_EQUAL="IS GREATER THAN OR EQUAL",o.Assign=function(t){if(window&&!t?t=window:e&&t&&(t=e),!t)throw new Error("No global namespace");t.IS=o.IS,t.IS_NOT=o.IS_NOT,t.IS_SAME_TYPE=o.IS_SAME_TYPE,t.IS_NOT_SAME_TYPE=o.IS_NOT_SAME_TYPE,t.IS_INSTANCE_OF=o.IS_INSTANCE_OF,t.IS_NOT_INSTANCE_OF=o.IS_NOT_INSTANCE_OF,t.IS_LESS_THAN=o.IS_LESS_THAN,t.IS_GREATER_THAN=o.IS_GREATER_THAN,t.IS_LESS_THAN_OR_EQUAL=o.IS_LESS_THAN_OR_EQUAL,t.IS_GREATER_THAN_OR_EQUAL=o.IS_GREATER_THAN_OR_EQUAL},o.LOG=!1,t.Utils.Assert=o,t.Assert=o}}).call(e,o(3))},function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.class=t,this.objects=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.class=null,e.prototype.objects=null,e.prototype.floodFunction=null,e.prototype.floodAmount=100,e.prototype.context=null,e.prototype.Store=function(t){this.objects.push(t)},e.prototype.Retrieve=function(){return 0===this.objects.length&&this.Flood(),this.objects.pop()},e.prototype.Flood=function(t,e,o){t&&(this.floodFunction=t),e&&(this.floodAmount=e),o&&(this.context=o);for(var r=0;r<this.floodAmount;++r)if(null!=this.class){var i=new this.class;this.Store(i),this.floodFunction.call(this.context,i)}else this.Store(this.floodFunction.call(this.context))},e.prototype.Flush=function(){this.objects.length=0},e.prototype.Clean=function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)},t.Utils.Pool=e,t.Pool=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);null!=t&&(this.type=t),this.items=[]}var o=t.Utils.Assert,r=Object.create(null);e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.type=null,e.prototype.Store=function(t){var e=!1;return null==t?(console.warn("Item is null. Cannot store null item."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Item is not valid. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))},e.prototype.StoreSafe=function(t){return null!=this.type&&o(t,o.IS_INSTANCE_OF,this.type),o(t,o.IS_SAME_TYPE,r),t.id?(o(t.id,o.IS_SAME_TYPE,""),o(t.id,o.IS_NOT,"")):(o(t.data,o.IS_SAME_TYPE,r),o(t.data.id,o.IS_SAME_TYPE,""),o(t.data.id,o.IS_NOT,"")),this.Store(t)},e.prototype.Get=function(t){for(var e=0,o=this.items,r=o.length;e<r;++e)if(o[e]===t)return t;return null},e.prototype.GetById=function(t){for(var e=0,o=this.items,r=o.length,i=o[e];e<r;i=o[++e])if(null!=i&&(i.id===t||null!=i.data&&i.data.id===t))return i;return null},e.prototype.PerformOnAll=function(t,e,o){for(var r=0,i=this.items,n=i.length,s=i[r];r<n;s=i[++r])null!=s&&s[t]&&s[t].apply(o||s,e);return null},e.prototype.Contains=function(t,e){for(var o=0,r=this.items,i=r.length,n=r[o];o<i;n=r[++o])if(null!=n){if(n===t)return!0;if(n.id===e)return!0;if(null!=n.data&&n.data.id===e)return!0}return!1},t.Utils.Cache=e}},function(t,e){t.exports=function(t){"use strict";var e=Math.random,o=null,r=null,i=null,n=t.Utils.RandomInteger=function(t,o){return e()*(o-t+1)+t|0};t.Utils.RandomFloat=function(t,o){return e()*(o-t)+t};var s=t.Utils.IsInteger=function(t){return Number(t)===t&&t%1==0};t.Utils.IsFloat=function(t){return Number(t)===t&&t%1!=0},t.Utils.Sign=function(t,e){return 0===t?!0===e?1:0:t>0?1:-1},t.Utils.Clamp=function(t,e,o){return t<e?e:t>o?o:t},t.Utils.InverseClamp=function(t,e,o){return t<e?o:t>o?e:t},t.Utils.ThisOrThat=function(t,e){return 1===n(1,2)?t:e},t.Utils.IntegerNotation=function(t,e,o){var r=t%e,i=t/e;return Math.ceil(0===r?i+1:i)+o+(1+r)},t.Utils.UUID=function(e,o,r,i){e=null==e?32:e,o=null==o?4:o,r=null==r?0:r,i=null==i?"-":i;for(var a,h,p="",u=0,c=e/o|0,l=t.Utils.CharacterSets[r];u<e;++u)a=u/c,0!==a&&s(a)?p+=i:(h=n(1,l.length-1),p+=l.charAt(h));return p},t.Utils.CharacterSets=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"],t.Utils.ApplyProperties=function(t,e){if(void 0!==e){var o;for(o in e)void 0!==t[o]&&(t[o]=e[o])}};var a=t.Utils.Nested=function(t,e,o,r,i,n){"string"==typeof e&&(n=null==n?".":n,e=e.split(n));var s;if(e.length>1){if(s=e.shift(),void 0!==t[s])return a(t[s],e,o,r,i,n)}else{if(s=e.shift(),void 0!==t[s])return!0===r?void(t[s]=i):!0===o?t:t[s];if(!0===r)return void(t[s]=i)}};t.Utils.ArrayGetRandom=function(t,o){for(var r=[],i={},n=t.length,s=0,a=o;s<a;++s){var h=e()*n|0;void 0===i[h]?(i[h]=null,r.push(t[h])):s--}return r},t.Utils.ArrayShuffle=function(t){for(var o,r,i=t.length-1;i>=0;--i)r=e()*i|0,o=t[i],t[i]=t[r],t[r]=o},t.Utils.Cipher={},t.Utils.Decipher={},t.Utils.Cipher.CCH1=function(t,e){var o=[];e=void 0===e?1:e;for(var r,i,s=0,a=t.split(""),h=a.length;s<h;++s)r=a[s],r=(r.charCodeAt(0)+e).toString(2),i=n(1,9),o.push(i+"x"+r.replace(/1/g,i));return o.join(" ")},t.Utils.Decipher.CCH1=function(t,e){var o=[];e=void 0===e?1:e;for(var r,i=0,n=t.split(" "),s=n.length;i<s;++i)r=n[i],r=r.slice(2-r.length),o.push(String.fromCharCode(parseInt(r.replace(/[2-9]/g,"1"),2)-e));return o.join("")},t.Utils.GenerateSimpleBase64Png=function(t){var e=t();return null==o&&(o=document.createElement("canvas"),r=o.getContext("2d")),r.clearRect(0,0,o.width,o.height),o.width=e.w,o.height=e.h,r.setTransform(1,0,0,1,0,0),e.Draw(r),o.toDataURL("image/png")},t.Utils.ImageFromDataURL=function(t,e,o,r){var i=new Image;return i.width=e,i.height=o,i.onload=r,i.src=t,i},t.Utils.Base16ToBase10=function(t){return parseInt(t,16)},t.Utils.Base2ToBase10=function(t){return parseInt(t,2)},t.Utils.IsObjectEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})},t.Utils.ParsedXMLToJSON=function(e,o){var r,i,n,s,a,h,p,u={},c=e.childNodes;if(1===e.nodeType){if(n=e.attributes,(i=n.length)>0)for(u.attributes={},r=0,s=n.item(r);r<i;s=n.item(++r))u.attributes[s.nodeName]=s.nodeValue}else 3===e.nodeType&&(/^\s*$/g.exec(e.nodeValue)||(u=e.nodeValue,!0===o&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=c)for(i=c.length,r=0,a=c.item(r);r<i;a=c.item(++r))void 0===u[a.nodeName]?u[a.nodeName]=t.Utils.ParsedXMLToJSON(a,o):(void 0===u[a.nodeName].push&&(p=u[a.nodeName],u[a.nodeName]=[],t.Utils.IsObjectEmpty(p)||u[a.nodeName].push(p)),h=t.Utils.ParsedXMLToJSON(a,o),t.Utils.IsObjectEmpty(h)||u[a.nodeName].push(h));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u},t.Utils.XMLToJSON=function(e,o){return null==i&&(i=new DOMParser),t.Utils.ParsedXMLToJSON(i.parseFromString(e,"text/xml"),o)};var h=t.Utils.DeepClone=function(t){var e=null,o=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(Array.isArray(t))e=[],o=!0;else{if("object"!=typeof obj)return t;e={}}if(o)for(var r=0;r<t.length;++r)e[r]=h(t[r]);else for(var i in t)t.hasOwnProperty(i)&&(e[i]=h(t[i]));return e}}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.value=0,e.prototype.Add=function(t){this.value|=t},e.prototype.Remove=function(t){this.value=this.value&~t},e.prototype.Compare=function(t){return 0!=(this.value&t)},e.prototype.Holds=function(t){return(this.value&t)===t},e.prototype.Toggle=function(t){this.value^=t},t.Utils.FlagList=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.NONE=0,e.prototype.next=1,e.prototype.Add=function(t){t=t.toUpperCase(),void 0===this[t]&&(this[t]=this.next,this.next=this.next<<1)},t.Utils.FlagEnum=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i){if(!(this instanceof e))return new e(t,o,r,i);this.context=o,this.holderContext=t,this.handle=r,this.removeOnNextCall=i}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.Execute=function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()},e.prototype.Remove=function(){this.holderContext.Remove(this.handle,this.context)},t.Event.LocalListener=e,t.LocalListener=e}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.listeners=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.stopPropagation=!1,e.prototype.target=null,e.prototype.data=null,e.prototype.GetListenerIndex=function(t,e){var o=this.listeners;if(0===o.length)return-1;for(var r,i=0,n=o.length;i<n;++i)if(r=o[i],r.context===e&&r.handle===t)return i;return-1},e.prototype.Add=function(e,o,r){var i=t.LocalListener(this,o,e,r);this.listeners.push(i)},e.prototype.Remove=function(t,e){var o=this.GetListenerIndex(t,e);-1!==o&&this.listeners.fickleSplice(o)},e.prototype.Dump=function(t){var e=this.listeners;if(0!==e.length)if(void 0!==t)for(var o,r=0,i=e.length;r<i;++r)o=e[r],o.context===t&&this.listeners.fickleSplice(r);else this.listeners.length=0},e.prototype.Dispatch=function(t,e){var o=this.listeners;if(0!==o.length){o=o.slice(),this.stopPropagation=!1,this.target=t,this.data=e;for(var r,i=0,n=o.length;i<n&&(r=o[i],r.Execute(this),!0!==this.stopPropagation);++i);delete this.target,delete this.data}},t.Event.LocalEvent=e,t.LocalEvent=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);null!=o&&(this.stopTime=o),this.onStop=t.LocalEvent(),this.onFinish=t.LocalEvent(),this.onStart=t.LocalEvent(),this.onReset=t.LocalEvent(),this.onPause=t.LocalEvent(),this.onResume=t.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.time=0,e.prototype.stopTime=0,e.prototype.isRunning=!1,e.prototype.canResume=!1,e.prototype.count=0,e.prototype.Reset=function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1,this.stopTime=null},e.prototype.Start=function(t){this.stopTime=Math.round(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))},e.prototype.Stop=function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))},e.prototype.Pause=function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))},e.prototype.Resume=function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))},e.prototype.Process=function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))},t.Time.Timer=e,t.Timer=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);void 0!=t&&void 0!=t.x&&void 0!=t.y?(this.x=t.x,this.y=t.y):void 0!=t&&(void 0==o?(this.x=t,this.y=t):(this.x=t,this.y=o))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TranslateMultiple=function(t,e){for(var o=0,r=t.length;o<r;++o)t[o].AddV(e)},e.GetMinMaxDot=function(t,e){for(var o=1/0,r=-o,i=0,n=e.Copy(),s=0,a=t.length;s<a;++s)i=t[s].GetDotV(e),i>r&&(r=i),i<o&&(o=i);return n.Set(o,r),n},e.Pool=t.Utils.Pool(e),e.Pool.Retrieve=function(t,e){0===this.objects.length&&this.Flood();var o=this.objects.pop();return o.Set(t,e),o},e.USE_POOL=!0,e.prototype.x=0,e.prototype.y=0,e.prototype.Copy=function(){return!0===e.USE_POOL?e.Pool.Retrieve(this.x,this.y):e(this)},e.prototype.FromStore=function(t,o){return!0===e.USE_POOL?e.Pool.Retrieve(t,o):e(t,o)},e.prototype.AbsoluteCopy=function(){var t=this.Copy();return t.Positive(),t},e.prototype.SetV=function(t){this.x=t.x,this.y=t.y},e.prototype.Set=function(t,e){void 0!=t&&void 0==e?(this.x=t,this.y=t):(this.x=t,this.y=e)},e.prototype.Is0=function(){return 0===this.x&&0===this.y},e.prototype.AddV=function(t){this.x+=t.x,this.y+=t.y},e.prototype.AddVC=function(t){var e=this.Copy();return e.AddV(t),e},e.prototype.Add=function(t,e){this.x+=t,this.y+=e},e.prototype.SubtractV=function(t){this.x-=t.x,this.y-=t.y},e.prototype.SubtractVC=function(t){var e=this.Copy();return e.SubtractV(t),e},e.prototype.Subtract=function(t,e){this.x-=t,this.y-=e},e.prototype.MultiplyV=function(t){this.x*=t.x,this.y*=t.y},e.prototype.MultiplyVC=function(t){var e=this.Copy();return e.MultiplyV(t),e},e.prototype.Multiply=function(t,e){this.x*=t,this.y*=e},e.prototype.DivideV=function(t){this.x/=t.x,this.y/=t.y},e.prototype.DivideVC=function(t){var e=this.Copy();return e.DivideV(t),e},e.prototype.Divide=function(t,e){this.x/=t,this.y/=e},e.prototype.Normalize=function(){var t=this.GetMagnitude();this.Divide(t,t)},e.prototype.Positive=function(){this.x=Math.abs(this.x),this.y=Math.abs(this.y)},e.prototype.Negative=function(){this.x=-Math.abs(this.x),this.y=-Math.abs(this.y)},e.prototype.Invert=function(){this.x=-1*this.x,this.y=-1*this.y},e.prototype.Rotate=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.x,i=this.y;this.x=r*o-i*e,this.y=r*e+i*o},e.prototype.RotateAbsolute=function(t){this.Rotate(t-this.GetAngle())},e.prototype.RotateAroundV=function(t,e){this.SubtractV(t),this.Rotate(e),this.AddV(t)},e.prototype.RotateAround=function(t,e,o){this.Subtract(t,e),this.Rotate(o),this.Add(t,e)},e.prototype.RotateAbsoluteAroundV=function(t,e){this.SubtractV(t),this.RotateAbsolute(e),this.AddV(t)},e.prototype.RotateAbsoluteAround=function(t,e,o){this.Subtract(t,e),this.RotateAbsolute(o),this.Add(t,e)},e.prototype.PushFromV=function(t,e){var o=this.Copy();o.SubtractV(t),o.Normalize(),o.Multiply(e,e),this.AddV(o)},e.prototype.PushFrom=function(t,e,o){var r=this.Copy();r.Subtract(t,e),r.Normalize(),r.Multiply(o,o),this.AddV(r)},e.prototype.GetAngle=function(){return Math.atan2(this.y,this.x)},e.prototype.GetAngleBetweenV=function(t){return Math.atan2(this.y-t.y,this.x-t.x)},e.prototype.GetAngleBetween=function(t,e){return Math.atan2(this.y-e,this.x-t)},e.prototype.GetDotV=function(t){return this.x*t.x+this.y*t.y},e.prototype.GetDot=function(t,e){return this.x*t+this.y*e},e.prototype.GetCrossV=function(t){return this.x*t.y+this.y*t.x},e.prototype.GetCross=function(t,e){return this.x*e+this.y*t},e.prototype.GetMagnitudeSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.GetMagnitude=function(){return Math.sqrt(this.GetMagnitudeSquared())},e.prototype.GetDistanceV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitude()},e.prototype.GetDistance=function(t,e){var o=this.Copy();return o.Subtract(t,e),o.GetMagnitude()},e.prototype.GetDistanceSquaredV=function(t){var e=this.Copy();return e.SubtractV(t),e.GetMagnitudeSquared()},e.prototype.GetDistanceSquared=function(t,e){var o=this.Copy();return o.Subtract(t,e),o.GetMagnitudeSquared()},e.prototype.GetPerpendicularCCWV=function(t){return this.FromStore(-(t.y-this.y),t.x-this.x)},e.prototype.GetPerpendicularCCW=function(t,e){return this.FromStore(-(e-this.y),t-this.x)},e.prototype.GetPerpendicularCWV=function(t){return this.FromStore(t.y-this.y,-(t.x-this.x))},e.prototype.GetPerpendicularCW=function(t,e){return this.FromStore(e-this.y,-(t-this.x))},e.prototype.GetNormalAV=function(t){var e=this.GetPerpendicularCCWV(t);return e.Normalize(),e},e.prototype.GetNormalA=function(t,e){var o=this.GetPerpendicularCCW(t,e);return o.Normalize(),o},e.prototype.GetNormalBV=function(t){var e=this.GetPerpendicularCWV(t);return e.Normalize(),e},e.prototype.GetNormalB=function(t,e){var o=this.GetPerpendicularCW(t,e);return o.Normalize(),o},e.prototype.GetMidPointV=function(t){var e=this.Copy();return e.AddV(t),e.Divide(2,2),e},e.prototype.GetMidPoint=function(t,e){var o=this.Copy();return o.Add(t,e),o.Multiply(.5,.5),o},e.prototype.IsEqualTo=function(t,e){return this.x===t&&this.y===e},e.prototype.IsEqualToV=function(t){return this.x===t.x&&this.y===t.y},e.prototype.GetProjectionOntoV=function(t){var e=this.GetDotV(t);if(0===e)return this.FromStore(0);var o=t.GetMagnitude(),r=e/(o*o),i=t.Copy();return i.Multiply(r,r),i},e.prototype.GetProjectionOnto=function(t,e){var o=this.Copy();o.Set(t,e);var r=this.GetDotV(o);if(0===r)return this.FromStore(0);var i=o.GetMagnitude(),n=r/(i*i);return o.Multiply(n,n),o},e.prototype.GetReflectionV=function(t){var e=t.Copy(),o=this.GetDotV(e);return e.Multiply(2,2),e.Multiply(o,o),this.SubtractVC(e)},e.prototype.GetReflection=function(t,e){var o=this.Copy();o.Set(t,e);var r=this.GetDotV(o);return o.Multiply(2,2),o.Multiply(r,r),this.SubtractVC(o)},e.prototype.Assert=function(){var e=t.Utils.Assert;e(this.x,e.IS_SAME_TYPE,0),e(this.y,e.IS_SAME_TYPE,0)},e.prototype.Store=function(){e.Pool.Store(this)},e.prototype.GetLength=e.prototype.GetMagnitude,e.prototype.GetLengthSquared=e.prototype.GetMagnitudeSquared,t.Math.Vector2D=e,t.Vector2D=e,e.Pool.Flood(function(){},1e5)}},function(t,e){t.exports=function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.array=new Float32Array(9)}e.prototype=Object.create(null),e.prototype.constructor=e,e.EPSILON=1e-5,e.prototype.array=null,e.prototype.a=1,e.prototype.b=0,e.prototype.c=0,e.prototype.d=1,e.prototype.e=0,e.prototype.f=0,e.prototype.Identity=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},e.prototype.Copy=function(){var t=new e;return t.Set(this.a,this.b,this.c,this.d,this.e,this.f),t},e.prototype.Set=function(t,e,o,r,i,n){return this.a=t,this.b=e,this.c=o,this.d=r,this.e=i,this.f=n,this},e.prototype.SetTransform=function(t,e,o,r,i,n,s,a,h){t=null==t?0:t,e=null==e?0:e,o=null==o?1:o,r=null==r?1:r,i=null==i?0:i,n=null==n?0:n,s=null==s?0:s,a=null==a?0:a,h=null==h?0:h;var p=Math.sin(i),u=Math.cos(i),c=-Math.sin(n),l=Math.cos(n),f=Math.sin(s),y=Math.cos(s),d=u*o,v=p*o,S=-p*r,m=u*r;return this.a=y*d+f*S,this.b=y*v+f*m,this.c=c*d+l*S,this.d=c*v+l*m,this.e=t+a*d+h*S,this.f=e+a*v+h*m,this},e.prototype.Translate=function(t,e){this.e+=t,this.f+=e},e.prototype.TranslateTo=function(t,e){this.e=t,this.f=e},e.prototype.ApplyTranslation=function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f},e.prototype.ApplyScale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e},e.prototype.Scale=function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},e.prototype.Rotate=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.a,i=this.c,n=this.e;this.a=r*o-this.b*e,this.b=r*e+this.b*o,this.c=i*o-this.d*e,this.d=i*e+this.d*o,this.e=n*o-this.f*e,this.f=n*e+this.f*o},e.prototype.Decompose=function(t){var o=this.a,r=this.b,i=this.c,n=this.d,s=-Math.atan2(-i,n),a=Math.atan2(r,o);Math.abs(s+a)<e.EPSILON?(t.rotation=a,o<0&&n>=0&&(t.rotation+=Math.PI),t.skew.Set(0)):t.skew.Set(s,a),t.scale.Set(Math.sqrt(o*o+r*r),Math.sqrt(i*i+n*n)),t.position.Set(this.e,this.f)},e.prototype.ApplyToContext=function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)},e.prototype.AsArray=function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e},t.Math.Matrix2D=e,t.Matrix2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.position=t.Vector2D(o,r),this.scale=t.Vector2D(1,1),this.localTransform=t.Vector2D(0,0),this.worldTransform=t.Vector2D(0,0)}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.UpdateLocal=function(){this.localTransform.SetV(this.position)},e.prototype.UpdateWorld=function(t){var e=this.localTransform;e.SetV(this.position),this.worldTransform.Set(t.e+e.x,t.f+e.y)},e.prototype.ApplyWorld=function(t){t.setTransform(this.scale.x,0,0,this.scale.y,this.worldTransform.x,this.worldTransform.y)},t.Math.Basetransform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.position=t.Vector2D(o,r),this.scale=t.Vector2D(1,1),this.skew=t.Vector2D(0,0),this.pivot=t.Vector2D(0,0),this.localTransform=t.Matrix2D(),this.worldTransform=t.Matrix2D()}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.rotation=0,e.prototype.skewCX=1,e.prototype.skewSX=0,e.prototype.skewCY=0,e.prototype.skewSY=1,e.prototype.Set=function(t){t.Decompose(this),this.UpdateSkew()},e.prototype.UpdateLocal=function(){var t=this.localTransform,e=this.position,o=this.scale,r=this.pivot;t.a=this.skewCX*o.x,t.b=this.skewSX*o.x,t.c=this.skewCY*o.y,t.d=this.skewSY*o.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d},e.prototype.UpdateWorld=function(t){var e=this.localTransform,o=this.worldTransform,r=this.position,i=this.scale,n=this.pivot;e.a=this.skewCX*i.x,e.b=this.skewSX*i.x,e.c=this.skewCY*i.y,e.d=this.skewSY*i.y,e.e=r.x-n.x*e.a+n.y*e.c,e.f=r.y-n.y*e.b+n.y*e.d,o.a=e.a*t.a+e.b*t.c,o.b=e.a*t.b+e.b*t.d,o.c=e.c*t.a+e.d*t.c,o.d=e.c*t.b+e.d*t.d,o.e=e.e*t.a+e.f*t.c+t.e,o.f=e.e*t.b+e.f*t.d+t.f},e.prototype.UpdateSkew=function(){var t=this.skew,e=this.rotation;this.skewCX=Math.cos(e+t.y),this.skewSX=Math.sin(e+t.y),this.skewCY=-Math.sin(e-t.x),this.skewSY=Math.cos(e-t.x)},e.prototype.ApplyWorld=function(t){this.worldTransform.ApplyToContext(t)},t.Math.Transform2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n){if(!(this instanceof e))return new e(o,r,i,n);void 0!==o&&null!=o.x&&null!=o.y&&void 0!==r&&null!=r.x&&null!=r.y?(this.s=o,this.e=r):void 0!==o&&void 0!==r&&void 0!==i&&void 0!==n?(this.s=t.Vector2D(o,r),this.e=t.Vector2D(i,n)):(this.s=t.Vector2D(),this.e=t.Vector2D())}var o=t.Math.LineLineIntersection,r=t.Math.ClosestPointOnLine;e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=0,e.prototype.TYPE=e.TYPE,e.prototype.epsilon=1e3,e.prototype.belongsTo=null,e.prototype.Stretch=function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)},e.prototype.Rotate=function(t,e,o){e=void 0==e?.5:e;var r=this.s.Copy();r.AddV(this.e),r.Multiply(e,void 0==o?e:o),this.s.RotateAroundV(r,t),this.e.RotateAroundV(r,t)},e.prototype.GetLength=function(){return this.s.GetDistanceV(this.e)},e.prototype.GetLengthSquared=function(){return this.s.GetDistanceSquaredV(this.e)},e.prototype.IntersectsPoint=function(t){var e=this.s,o=this.e,r=(t.y-e.y)*(o.x-e.x)-(t.x-e.x)*(o.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var i=(t.x-e.x)*(o.x-e.x)+(t.y-e.y)*(o.y-e.y);return!(i<0)&&!(i>this.GetLengthSquared())},e.prototype.IntersectsLine=function(t){return o(this.s,this.e,t.s,t.e)},e.prototype.GetClosestPointTo=function(t){return r(this.s,this.e,t)},e.prototype.GetNormalA=function(){return this.s.GetNormalAV(this.e)},e.prototype.GetNormalB=function(){return this.s.GetNormalBV(this.e)},t.Geom.Line2D=e,t.Geom.Ray2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n){if(!(this instanceof e))return new e(o,r,i,n);o instanceof t.Vector2D&&r instanceof t.Vector2D?(this.tl=o,this.br=r):void 0!==o&&void 0!==r&&void 0!==o.x&&void 0!==o.y&&void 0!==r.x&&void 0!==r.y?(this.tl=t.Vector2D(o.x,o.y),this.br=t.Vector2D(r.x,r.y)):void 0!==o&&void 0!==r&&void 0!==i&&void 0!==n?(this.tl=t.Vector2D(o,r),this.br=t.Vector2D(i,n)):(this.tl=t.Vector2D(),this.br=t.Vector2D()),this.ComputeWH()}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=1,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.prototype.TYPE=e.TYPE,e.prototype.w=0,e.prototype.h=0,e.prototype.hw=0,e.prototype.hh=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,o,r){this.tl.x=t,this.tl.y=e,this.br.x=o,this.br.y=r,this.ComputeWH()},e.prototype.SetC=function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)},e.prototype.Scale=function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()},e.prototype.ComputeWH=function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h},e.prototype.GetQuadrant=function(t){var o=this.tl,r=this.br;switch(t){case e.TOP_LEFT:return e(o.x,o.y,o.x+this.hw,o.y+this.hh);case e.TOP_RIGHT:return e(o.x+this.hw,o.y,r.x,o.y+this.hh);case e.BOTTOM_LEFT:return e(o.x,o.y+this.hh,o.x+this.hw,r.y);case e.BOTTOM_RIGHT:return e(o.x+this.hw,o.y+this.hh,r.x,r.y);default:return null}},e.prototype.IntersectsPoint=function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)},e.prototype.ContainsPoint=function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y},e.prototype.IntersectsAABB2D=function(t){var e=this.tl,o=this.br,r=t.tl,i=t.br;return!(r.x>=o.x||r.y>=o.y||i.x<=e.x||i.y<=e.y)},e.prototype.ContainsAABB2D=function(t){if(t.area>this.area)return!1;var e=this.tl,o=this.br,r=t.tl,i=t.br;return r.x>=e.x&&r.y>=e.y&&i.x<=o.x&&i.y<=o.y},t.Geom.AABB2D=e,t.AABB2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o){if(!(this instanceof e))return new e(o);this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=t.Vector2D(),null!=o&&(o[0]instanceof t.Vector2D?this.AddPoints(o):this.PushPoints(o))}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=3,e.CreateCopy=function(t){for(var o=new e,r=0,i=t.vertices,n=i.length;r<n;++r)o.AddPoint(i[r].Copy());return o},e.Construct=Object.create(null),e.Construct.Rectangular=function(e,o,r,i,n){var s=t.Vector2D(o,r),a=t.Vector2D(o+i,r),h=t.Vector2D(o+i,r+n),p=t.Vector2D(o,r+n);return e.Recreate([s,a,h,p]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Isosceles=function(e,o,r,i,n){var s=t.Vector2D(o,r),a=t.Vector2D(o+.5*i,r+n),h=t.Vector2D(o-.5*i,r+n);return e.Recreate([s,a,h]),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Cyclic=function(e,o,r,i,n){var s,a,h,p=0,u=n,c=2*Math.PI/u;for(e.Recreate([]),p;p<u;++p)h=c*p,s=Math.cos(h)*i,a=Math.sin(h)*i,e.AddPoint(t.Vector2D(o+s,r+a));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Equilateral=function(e,o,r,i){var n,s,a=2.0943951023931953;return e.Recreate([]),n=Math.cos(0)*i,s=Math.sin(0)*i,e.AddPoint(t.Vector2D(o+n,r+s)),n=Math.cos(a)*i,s=Math.sin(a)*i,e.AddPoint(t.Vector2D(o+n,r+s)),n=Math.cos(2*a)*i,s=Math.sin(2*a)*i,e.AddPoint(t.Vector2D(o+n,r+s)),e.Rotate(-90*t.Math.RADIAN),e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Star=function(e,o,r,i,n,s){var a,h,p,u,c=0,l=2*s,f=2*Math.PI/l;for(e.Recreate([]),c;c<l;++c)u=0==(1&c)?i:n,p=f*c,a=Math.cos(p)*u,h=Math.sin(p)*u,e.AddPoint(t.Vector2D(o+a,r+h));return e.ComputeBounds(),e.GetNormalsA(),e},e.Construct.Butterfly=function(o,r,i,n,s){var a,h,p,u=0,c=e.Construct.Butterfly.C;for(o.Recreate([]),u;u<n;++u)p=u*c._1*Math.PI/n,a=Math.cos(p)*(Math.exp(Math.cos(p))-c._2*Math.cos(c._3*p)-Math.pow(Math.sin(p/c._4),c._5))*s,h=Math.sin(p)*(Math.exp(Math.cos(p))-c._2*Math.cos(c._3*p)-Math.pow(Math.sin(p/c._4),c._5))*s,o.AddPoint(t.Vector2D(r+a,i+h));return o.ComputeBounds(),o.GetNormalsA(),o},e.Construct.Butterfly.C={_1:24,_2:2,_3:4,_4:12,_5:5,Reset:function(){this._1=24,this._2=2,this._3=4,this._4=12,this._5=5}},e.Construct.Supershape=function(o,r,i,n,s,a,h,p,u){h=void 0===h?1:h,p=void 0===p?1:p,u=void 0===u?1:u;var c,l,f,y,d,v,S=0,m=s,T=e.Construct.Supershape.C;for(o.Recreate([]),S;S<m;++S)f=S*Math.PI*2/s,d=Math.cos(a*f/4)/T._A,d=Math.abs(d),d=Math.pow(d,p),v=Math.sin(a*f/4)/T._B,v=Math.abs(v),v=Math.pow(v,u),y=Math.pow(d+v,1/h),0===Math.abs(y)?(c=0,l=0):(y=1/y,c=Math.cos(f)*y*n,l=Math.sin(f)*y*n),o.AddPoint(t.Vector2D(r+c,i+l));return o.ComputeBounds(),o.GetNormalsA(),o},e.Construct.Supershape.C={_A:1,_B:1},e.prototype.TYPE=e.TYPE,e.prototype.aabb=null,e.prototype.dirtyBounds=!0,e.prototype.belongsTo=null,e.prototype.AddPoint=function(t){this.vertices.push(t)},e.prototype.AddPoints=function(t){this.vertices.push.apply(this.vertices,t)},e.prototype.PushPoint=function(e,o){this.vertices.push(t.Vector2D(e,o))},e.prototype.PushPoints=function(t){for(var e=0,o=t.length;e<o;e+=2)this.PushPoint(t[e],t[e+1])},e.prototype.Recreate=function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)},e.prototype.ComputeBounds=function(){null===this.aabb&&(this.aabb=t.Geom.AABB2D());for(var e,o=1/0,r=-o,i=o,n=-o,s=0,a=this.vertices,h=a.length;s<h;++s)e=a[s],e.x<o&&(o=e.x),e.x>r&&(r=e.x),e.y<i&&(i=e.y),e.y>n&&(n=e.y);this.aabb.Set(o,i,r,n),this.dirtyBounds=!1},e.prototype.Rotate=function(t,e,o,r){!0===this.dirtyBounds&&!0===r?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e;var i=this.aabb,n=i.tl.Copy();n.AddV(i.br),n.Multiply(e,void 0===o?e:o);var s,a=0,h=this.vertices,p=h.length;for(a;a<p;++a)s=h[a],s.RotateAroundV(n,t);this.dirtyBounds=!0},e.prototype.GetCentroid=function(){var t=this.centroid;t.Set(0,0);for(var e,o=0,r=this.vertices,i=r.length;o<i;++o)e=r[o],t.AddV(e);return t.Divide(i,i),t},e.prototype.GetNormalsA=function(){var t=this.normals;t.length=0;for(var e=0,o=this.vertices,r=o[e],i=this.vertices.length-1;e<i;r=o[++e])t.push(r.GetNormalAV(o[e+1]));return t.push(o[i].GetNormalAV(o[0])),t},e.prototype.GetNormalsB=function(){var t=this.normals;t.length=0;for(var e=0,o=this.vertices,r=o[e],i=this.vertices.length-1;e<i;r=o[++e])t.push(r.GetNormalBV(o[e+1]));return t.push(o[i].GetNormalBV(o[0])),t},e.prototype.GetPerimeterMidPoints=function(){var t=this.perimeterMidPoints;t.length=0;for(var e=0,o=this.vertices,r=o[e],i=this.vertices.length-1;e<i;r=o[++e])t.push(r.GetMidPointV(o[e+1]));return t.push(o[i].GetMidPointV(o[0])),t},e.prototype.IntersectsPoint=function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;var e,o,r,i,n=t.x,s=t.y,a=!1,h=this.vertices,p=h.length;for(e=0,o=p-1;e<p;o=e++)r=h[e],i=h[o],r.y>s!=i.y>s&&n<(i.x-r.x)*(s-r.y)/(i.y-r.y)+r.x&&(a=!a);return a},t.Geom.Polygon2D=e}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i){if(!(this instanceof e))return new e(o,r,i);this.center=t.Vector2D(o,r),this.radius=void 0===i?32:i}e.prototype=Object.create(null),e.prototype.constructor=e,e.TYPE=2,e.prototype.TYPE=e.TYPE,e.prototype.diameter=0,e.prototype.w=0,e.prototype.h=0,e.prototype.radiusSquared=0,e.prototype.radiusUnsquared=0,e.prototype.area=0,e.prototype.belongsTo=null,e.prototype.Set=function(t,e,o){this.center.Set(t,e),this.radius=o},e.prototype.SetC=function(t){this.center.SetV(t),this.radius=t.radius},e.prototype.Scale=function(t){this.radius*=t},e.prototype.IntersectsCircle=function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)},e.prototype.IntersectsPoint=function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)},Object.defineProperty(e.prototype,"x",{set:function(t){this.center.x=t},get:function(){return this.center.x}}),Object.defineProperty(e.prototype,"y",{set:function(t){this.center.y=t},get:function(){return this.center.y}}),Object.defineProperty(e.prototype,"radius",{set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=Math.PI*t*t},get:function(){return this.radiusUnsquared}}),t.Geom.Circle=e}},function(t,e){t.exports=function(t){"use strict";var e=Object.create(null);e.AABB2DvsAABB2D=Object.create(null),e.AABB2DvsAABB2D.Relative=Object.create(null),e.CirclevsCircle=Object.create(null),e.CirclevsCircle.Relative=Object.create(null),e.PolygonvsPolygon=Object.create(null),e.PolygonvsPolygon.Relative=Object.create(null),e.CirclevsLine=Object.create(null),e.CirclevsLine.Relative=Object.create(null),e.VectorSortMinMag=function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()};var o=t.Vector2D.GetMinMaxDot,r=t.Math.ClosestPointOnLine;e.AABB2DvsAABB2D.Result=function(){this.mtv=t.Vector2D()},e.AABB2DvsAABB2D.Result.prototype.occured=!1,e.AABB2DvsAABB2D.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.occured=!1},e.AABB2DvsAABB2D.Relative.Collide=function(o,r,i){var n=o.shape,s=n.w,a=n.h,h=o.anchor,p=r.shape,u=p.w,c=p.h,l=r.anchor,f=n.tl.SubtractVC(o.relative),y=p.tl.SubtractVC(r.relative);void 0!=h&&(f.x+=h.x*s,f.y+=h.y*a),void 0!=l&&(y.x+=l.x*u,y.y+=l.y*c);var d=y.x+s,v=f.x+u,S=y.y+a,m=f.y+c;if(f.x<d&&y.x<v&&f.y<S&&y.y<m){if(void 0!=i){var T=[t.Vector2D(f.x-d,0),t.Vector2D(v-y.x,0),t.Vector2D(0,f.y-S),t.Vector2D(0,m-y.y)];T.sort(e.VectorSortMinMag),i.mtv.SetV(T[0]),i.occured=!0}return!0}return!1},e.CirclevsCircle.Result=function(){this.mtv=t.Vector2D(0,0),this.poc={a:null,b:null,c:null}},e.CirclevsCircle.Result.prototype.mtd=0,e.CirclevsCircle.Result.prototype.delta=null,e.CirclevsCircle.Result.prototype.occured=!1,e.CirclevsCircle.Result.prototype.Reset=function(){this.poc.a=null,this.poc.b=null,this.poc.c=null,this.mtv.Set(0,0),this.mtd=0,this.delta=null,this.occured=!1},e.CirclevsCircle.Relative.Collide=function(e,o,r){var i=e.shape,n=o.shape,s=i.radius,a=n.radius,h=s+a,p=e.anchor,u=o.anchor,c=e.relative.Copy(),l=o.relative.Copy();void 0!=p&&(c.x+=p.x*i.diameter,c.y+=p.y*i.diameter),void 0!=u&&(l.x+=u.x*n.diameter,l.y+=u.y*n.diameter);var f=l.SubtractVC(c),y=f.GetMagnitudeSquared();if(h*h>y){if(void 0!=r){var d=Math.sqrt(y),v=(i.radiusSquared-n.radiusSquared+y)/(d+d),S=t.Vector2D(c.x+f.x*v/d,c.y+f.y*v/d),m=Math.sqrt(i.radiusSquared-v*v)/d,T=-f.y*m,A=f.x*m,x=t.Vector2D(S.x+T,S.y+A),g=t.Vector2D(S.x-T,S.y-A),b=c.SubtractVC(l);b.Divide(h,h);var O=d-s-a;r.poc.a=S,r.poc.b=x,r.poc.c=g,r.mtv.SetV(b),r.mtd=O,r.delta=f,r.occured=!0}return!0}return!1},e.CirclevsCircle.Relative.ElasticResponse=function(t,e,o){var r=o.delta.Copy(),i=o.mtv.Copy();r.Normalize();var n=t.mass,s=e.mass,a=t.velocity,h=e.velocity,p=a.GetDotV(r),u=h.GetDotV(r),c=2*(p-u)/(n+s);a.Set(a.x-c*s*r.x,a.y-c*s*r.y),h.Set(h.x+c*n*r.x,h.y+c*n*r.y),i.Multiply(o.mtd,o.mtd),i.Divide(2,2),t.relative.SubtractV(i),e.relative.AddV(i)},e.PolygonvsPolygon.Result=function(){this.mtv=t.Vector2D(0,0),this.olAxis=t.Vector2D(0,0)},e.PolygonvsPolygon.Result.prototype.occured=!1,e.PolygonvsPolygon.Result.prototype.mtd=1/0,e.PolygonvsPolygon.Result.prototype.Reset=function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)};var i=e.PolygonvsPolygon.Relative.AxisSeparates=function(t,e,r,i){var n=o(t.shape.vertices,r),s=o(e.shape.vertices,r),a=e.relative.SubtractVC(t.relative).GetDotV(r);if(s.Add(a,a),n.x>s.y||s.x>n.y)return!0;if(void 0!=i){var h=0,p=n.x,u=n.y,c=s.x,l=s.y,f=0,y=0;p<c?u<l?h=u-c:(f=u-c,y=l-p,h=f<y?f:-y):u>l?h=p-l:(f=u-c,y=l-p,h=f<y?f:-y);var d=Math.abs(h);d<i.mtd&&(i.mtd=d,i.olAxis.SetV(r),h<0&&i.olAxis.Invert())}return!1};e.PolygonvsPolygon.Relative.Collide=function(t,e,o){var r=t.shape,n=e.shape,s=r.normals,a=n.normals,h=0,p=s.length,u=a.length;for(h;h<p;++h)if(!0===i(t,e,s[h],o))return!1;for(h=0;h<u;++h)if(!0===i(t,e,a[h],o))return!1;return void 0!=o&&(o.mtv.SetV(o.olAxis),o.mtv.Multiply(o.mtd,o.mtd),o.occured=!0),!0},e.CirclevsLine.Result=function(){this.mtv=t.Vector2D(0,0),this.cp=t.Vector2D(0,0)},e.CirclevsLine.Result.prototype.occured=!1,e.CirclevsLine.Result.prototype.sore=0,e.CirclevsLine.Result.prototype.Reset=function(){this.mtv.Set(0,0),this.cp.Set(0,0),this.occured=!1,this.sore=0},e.CirclevsLine.Relative.Collide=function(t,e,o){var i=e.shape,n=t.shape,s=e.relative,a=t.relative,h=i.s.AddVC(s),p=i.e.AddVC(s),u=r(h,p,a),c=a.SubtractVC(u),l=c.GetMagnitudeSquared();if(l<n.radiusSquared){if(o){var f=c,y=n.radius-Math.sqrt(l);f.Normalize(),f.Multiply(y,y),o.mtv.SetV(f),o.cp.SetV(u),o.occured=!0,u===h?o.sore=1:u===p&&(o.sore=2)}return!0}return!1},e.CirclevsLine.Relative.ReflectingResponse=function(t,e,o){var r,i,n=e.shape,s=t.velocity,a=t.relative,h=o.cp;0!==o.sore?(r=h.SubtractVC(a),r.Normalize()):r=n.GetNormalA(),i=s.GetReflectionV(r),s.SetV(i),a.AddV(o.mtv)},t.Math.Collision2D=e}},function(t,e){t.exports=function(t){"use strict";t.Math.Ease=Object.create(null),t.Math.Ease.Linear=function(t,e,o,r){return o*t/r+e},t.Math.Ease.QuadIn=function(t,e,o,r){return t/=r,o*t*t+e},t.Math.Ease.QuadOut=function(t,e,o,r){return t/=r,-o*t*(t-2)+e},t.Math.Ease.QuadInOut=function(t,e,o,r){return(t/=.5*r)<1?.5*o*t*t+e:(t--,.5*-o*(t*(t-2)-1)+e)},t.Math.Ease.SineIn=function(t,e,o,r){return-o*Math.cos(t/r*(.5*Math.PI))+o+e},t.Math.Ease.SineOut=function(t,e,o,r){return o*Math.sin(t/r*(.5*Math.PI))+e},t.Math.Ease.SineInOut=function(t,e,o,r){return.5*-o*(Math.cos(Math.PI*t/r)-1)+e}}},function(t,e){t.exports=function(t){"use strict";function e(o,r,i,n,s,a){if(!(this instanceof e))return new e(o,r,i,n,s,a);this.id=o,this.target=r,this.propertyString=i,void 0!==n&&(this.value=n),void 0!==s&&(this.duration=s),this.easing=t.Math.Ease[void 0===a?e.DEFAULT_EASING:a],this.onStart=t.Event.LocalEvent(),this.onEnd=t.Event.LocalEvent(),this.onStop=t.Event.LocalEvent(),this.onReconfigure=t.Event.LocalEvent(),this.onReset=t.Event.LocalEvent()}e.prototype=Object.create(null),e.prototype.constructor=e,e.DEFAULT_EASING="Linear",e.prototype.id=null,e.prototype.target=null,e.prototype.easing=null,e.prototype.duration=1e3,e.prototype.time=0,e.prototype.value=1,e.prototype.startValue=0,e.prototype.propertyString=null,e.prototype.change=0,e.prototype.property=null,e.prototype.propertyObject=null,e.prototype.running=!1,e.prototype.Start=function(){var e=this.propertyString.split(".");this.property=e[e.length-1],this.propertyObject=t.Utils.Nested(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)},e.prototype.Stop=function(){delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onStop.Dispatch(this,null)},e.prototype.Process=function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))},e.prototype.Reconfigure=function(o,r,i,n){void 0!==o&&(this.propertyString=o),this.value=r,this.duration=i,this.easing=t.Math.Ease[void 0===n?e.DEFAULT_EASING:n],this.onReconfigure.Dispatch(this,null)},e.prototype.Reset=function(){if(null===this.propertyObject||null===this.property)return!1;this.propertyObject[this.property]=this.startValue,delete this.property,delete this.propertyObject,delete this.startValue,delete this.change,delete this.time,delete this.running,this.onReset.Dispatch(this,null)},t.Motion=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.motions=[],this.target=t}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.target=null,e.prototype.motions=null,e.prototype.Create=function(e,o,r,i,n){if(null===this.GetMotion(e)){var s=t.Motion(e,this.target,o,r,i,n);return this.motions.push(s),s}return null},e.prototype.Add=function(t){null===this.GetMotion(t.id)&&this.motions.push(t)},e.prototype.Start=function(t){var e=this.GetMotion(t);return null!==e&&e.Start(),e},e.prototype.StartMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Start(t[e])},e.prototype.Stop=function(t){var e=this.GetMotion(t);return null!==e&&e.Stop(),e},e.prototype.StopMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Stop(t[e])},e.prototype.Reset=function(t){var e=this.GetMotion(t);return null!==e&&e.Reset(),e},e.prototype.ResetMultiple=function(t){t=t.split(" ");for(var e=0,o=t.length;e<o;++e)this.Reset(t[e])},e.prototype.Process=function(){for(var t,e=0,o=this.motions,r=o.length;e<r;++e)t=o[e],t.Process()},e.prototype.GetMotion=function(t){for(var e,o=0,r=this.motions,i=r.length;o<i;++o)if(e=r[o],e.id===t)return e;return null},t.MotionManager=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i){if(!(this instanceof e))return new e(t,o,r,i);this.Set(t,o,r,i),this.nodes={},this.objects=[],this.convergence=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.TOP_LEFT="TL",e.TOP_RIGHT="TR",e.BOTTOM_LEFT="BL",e.BOTTOM_RIGHT="BR",e.Pool=t.Utils.Pool(e),e.Pool.Retrieve=function(t,e,o,r){0===this.objects.length&&this.Flood();var i=this.objects.pop();return i.Set(t,e,o,r),i},e.USE_POOL=!0,e.prototype.objectCap=0,e.prototype.levelCap=0,e.prototype.level=0,e.prototype.nodes=null,e.prototype.objects=null,e.prototype.convergence=null,e.prototype.aabb=null,e.prototype.hasSplit=!1,e.prototype.Set=function(t,e,o,r){this.aabb=t,this.level=e,this.objectCap=o,this.levelCap=r},e.prototype.FromStore=function(t,o,r,i){return!0===e.USE_POOL?e.Pool.Retrieve(t,o,r,i):e(t,o,r,i)},e.prototype.Add=function(t){var e="",o=this.objects,r=this.nodes,i=0;if(!0===this.hasSplit&&null!==(e=this.Marking(t)))return void r[e].Add(t);if(o.push(t),this.level<this.levelCap&&o.length>this.objectCap)for(!1===this.hasSplit&&this.Split();i<o.length;)e=this.Marking(o[i]),null!==e?r[e].Add(o.fickleSplice(i)):++i},e.prototype.Converge=function(t){var o=this.convergence;o.length=0,o.push.apply(o,this.objects);var r=null,i=this.nodes;return!0===this.hasSplit&&(r=this.Marking(t),null!==r?o.push.apply(o,i[r].Converge(t)):(o.push.apply(o,i[e.TOP_LEFT].Converge(t)),o.push.apply(o,i[e.TOP_RIGHT].Converge(t)),o.push.apply(o,i[e.BOTTOM_LEFT].Converge(t)),o.push.apply(o,i[e.BOTTOM_RIGHT].Converge(t)))),o},e.prototype.Split=function(){var t=this.level+1,o=this.objectCap,r=this.levelCap,i=this.nodes,n=this.aabb;i[e.TOP_LEFT]=this.FromStore(n.GetQuadrant(e.TOP_LEFT),t,o,r),i[e.TOP_RIGHT]=this.FromStore(n.GetQuadrant(e.TOP_RIGHT),t,o,r),i[e.BOTTOM_LEFT]=this.FromStore(n.GetQuadrant(e.BOTTOM_LEFT),t,o,r),i[e.BOTTOM_RIGHT]=this.FromStore(n.GetQuadrant(e.BOTTOM_RIGHT),t,o,r),this.hasSplit=!0},e.prototype.Dump=function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[e.TOP_LEFT].Dump(),t[e.TOP_RIGHT].Dump(),t[e.BOTTOM_LEFT].Dump(),t[e.BOTTOM_RIGHT].Dump(),!0===e.USE_POOL&&(t[e.TOP_LEFT].Store(),t[e.TOP_RIGHT].Store(),t[e.BOTTOM_LEFT].Store(),t[e.BOTTOM_RIGHT].Store())),this.nodes={},this.hasSplit=!1},e.prototype.Marking=function(t){var o=this.nodes;return!0===o[e.TOP_LEFT].aabb.ContainsAABB2D(t)?e.TOP_LEFT:!0===o[e.TOP_RIGHT].aabb.ContainsAABB2D(t)?e.TOP_RIGHT:!0===o[e.BOTTOM_LEFT].aabb.ContainsAABB2D(t)?e.BOTTOM_LEFT:!0===o[e.BOTTOM_RIGHT].aabb.ContainsAABB2D(t)?e.BOTTOM_RIGHT:null},e.prototype.ConcatNodes=function(t){void 0===t&&(t=[]),t.push(this);var o=this.nodes;return!1===this.hasSplit?t:(o[e.TOP_LEFT].ConcatNodes(t),o[e.TOP_RIGHT].ConcatNodes(t),o[e.BOTTOM_LEFT].ConcatNodes(t),o[e.BOTTOM_RIGHT].ConcatNodes(t),t)},e.prototype.Store=function(){e.Pool.Store(this)},t.Utils.QuadtreeNode=e,t.QuadtreeNode=e,e.Pool.Flood(function(){},1e3)}},function(t,e){t.exports=function(t){"use strict";function e(o,r){if(!(this instanceof e))return new e(o,r);this.transform=t.Math.Transform2D(o,r),this.data=Object.create(null)}e.prototype=Object.create(null),e.prototype.constructor=e,e.NULL_TRANSFORM=t.Math.Transform2D(),e.prototype.parent=null,e.prototype.transform=null,e.prototype.data=null,e.prototype.w=0,e.prototype.h=0,e.prototype.bounds=null,e.prototype.boundsDirty=!0,e.prototype.UpdateTransform=function(){this.parent?this.transform.UpdateWorld(this.parent.transform.worldTransform):this.transform.UpdateWorld(e.NULL_TRANSFORM.worldTransform)},e.prototype.GetWorldPosition=function(){var e=this.transform.worldTransform;return t.Vector2D(e.e,e.f)},e.prototype.ComputeBounds=function(e){var o=e&&e.x?e.x:0,r=e&&e.y?e.y:0;return null===this.bounds?(this.bounds=t.Geom.AABB2D(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.bounds.belongsTo=this):this.bounds.Set(this.x-this.width*o,this.y-this.height*r,this.x+this.width,this.y+this.height),this.boundsDirty=!1,this.bounds},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale}}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position}}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot}}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w*this.scale.x},set:function(t){this.w=t}}),Object.defineProperty(e.prototype,"height",{get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}),t.Entity.CoreEntity2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);o.call(this,t,r),this.children=[]}var o=t.Entity.CoreEntity2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.children=null,e.prototype.render=!0,e.prototype.display=!0,e.prototype.transformShouldUpdate=!0,e.prototype.transformAutomaticUpdate=!0,e.prototype.isBatchParent=!1,e.prototype.childDataBuffer=null,e.prototype.bufferData=null,e.prototype.programController=null,e.prototype.bufferStartIndex=0,e.prototype.bufferEndIndex=0,e.prototype.PreDraw=function(){},e.prototype.GLPreDraw=function(){},e.prototype.Draw=function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t))},e.prototype.GLDraw=function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t)))},e.prototype.RequestTransformUpdate=function(){this.transformShouldUpdate=!0},e.prototype.DrawChildren=function(t){for(var e,o=0,r=this.children,i=r.length;o<i;++o)e=r[o],e.Draw&&e.Draw(t)},e.prototype.GLDrawChildren=function(t){for(var e,o=0,r=this.children,i=r.length;o<i;++o)e=r[o],e.GLDraw&&e.GLDraw(t)},e.prototype.GLBatchDrawChildren=function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)},e.prototype.ComputeBatchBuffer=function(t){for(var e,o,r=[],i=0,n=this.children,s=n.length;i<s;++i)e=n[i],o=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=r.length,e.bufferEndIndex=r.length+o.length,r.push.apply(r,o);this.childDataBuffer=new Float32Array(r)},e.prototype.UpdateInBuffer=function(){throw new Error("Cannot update buffer data directly on Container2D object!")},e.prototype.GetBufferData=function(){throw new Error("Cannot access buffer data directly on Container2D object!")},e.prototype.AddChild=function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t},e.prototype.AddChildren=function(){var t=arguments;Array.isArray(t[0])&&(t=t[0]);for(var e=0,o=t.length;e<o;++e)this.AddChild(t[e])},e.prototype.Mount=function(){this.AddChildren.apply(this,arguments)},e.prototype.AddSibling=function(t){var e=this.parent;return null!==e&&e.AddChild(t),t},e.prototype.RemoveChild=function(t){var e=this.children,o=e.indexOf(t);if(-1!==o)return t.parent=null,e.fickleSplice(o)},e.prototype.RemoveChildren=function(){for(var t,e,o=this.children,r=arguments[0].length?arguments[0]:arguments,i=[],n=0,s=r.length;n<s;++n)t=r[n],-1!==(e=o.indexOf(t))&&(i.push(o.fickleSplice(e)),t.parent=null);return i},e.prototype.SendToFront=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.push(t.fickleSplice(e))}},e.prototype.SendToBack=function(){if(null!==this.parent){var t=this.parent.children,e=t.indexOf(this);-1!==e&&t.unshift(t.fickleSplice(e))}},e.prototype.Dump=function(){this.children.length=0},e.prototype.Destroy=function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)},e.prototype.AttachTo=function(t){t.AddChild(this)},e.prototype.Detach=function(){return null!==this.parent?this.parent.RemoveChild(this):null},e.prototype.GetChildClosestTo=function(t,e){var o=this.children,r=null;if(0!==o.length){for(var i,n,s=0,a=o.length,h=1/0;s<a;++s)i=o[s],void 0!==e&&!1===e(i)||(n=Math.abs(i.position.GetDistanceSquared(t.x,t.y)))<h&&(h=n,r=i);return r}return null},e.prototype.GetChildFurthestFrom=function(t,e){var o=this.children,r=null;if(0!==o.length){for(var i,n,s=0,a=o.length,h=0;s<a;++s)i=o[s],void 0!==e&&!1===e(i)||(n=Math.abs(i.position.GetDistanceSquared(t.x,t.y)))>h&&(h=n,r=i);return r}return null},e.prototype.UseAsBatchParent=function(t){this.isBatchParent=!0,this.programController=t},t.Entity.Container2D=e,t.Container2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);o.call(this,t,r)}var o=t.Entity.Container2D;e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.Render=function(){!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&this.RenderChildren())},e.prototype.RenderChildren=function(){for(var t,e=0,o=this.children,r=o.length;e<r;++e)t=o[e],t.Render&&t.Render()},t.Entity.Case2D=e,t.Case2D=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i,n){if(!(this instanceof e))return new e(t,o,r,i,n);this.id=t.split(" "),this.handle=o,this.info=r,void 0!==i&&(this.priority=i),void 0!==n&&(this.breakIfExecuted=n),this.data={}}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.command=null,e.prototype.priority=0,e.prototype.breakIfExecuted=!1,e.prototype.Execute=function(t,e,o){return this.handle(t,e,o),this.breakIfExecuted},t.CP.Option=e}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r,i,n){if(!(this instanceof e))return new e(t,o,r,i,n);this.id=t.split(" "),this.handle=o,this.info=r,this.data={},this.optionPrefix=void 0===n?e.OPTION_PREFIX:n,this.dsCopy=[],void 0!==i&&(this.continueToPrime=i)}e.prototype=Object.create(null),e.prototype.constructor=e,e.OPTION_PREFIX="",e.prototype.dataSeparator="=",e.prototype.options=null,e.prototype.allOptionIds=null,e.prototype.fullInfo=null,e.prototype.optionPrefix=null,e.prototype.continueToPrime=!0,e.prototype.dsCopy=null,e.prototype.register=null,e.prototype.Execute=function(t,e,o){this.HandleData(t,e),!0===this.HandleOptions(t,e,o)&&this.handle(t,e,o)},e.prototype.AddOption=function(e,o,r,i,n,s){s=void 0===s?this.optionPrefix:s,null!==s&&(e=e.replace(/\S+/g,s+"$&")),null===this.options&&(this.options=[]),i=void 0===i?0:i;var a=t.CP.Option(e,o,r,i,n);a.command=this;for(var h,p=0,u=this.options,c=u.length;p<c;++p)if(h=u[p],h.priority<=i)return u.splice(p,0,a),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(a),this.allOptionIds=this.GetAllOptionIds(),this},e.prototype.HandleData=function(t,e){var o=this.dsCopy;o.push.apply(o,t);for(var r,i,n=0,s=o.length,a=this.dataSeparator;n<s;++n)r=o[n],i=r.split(a),2===i.length&&(t.fickleSplice(n),e[i[0]]=i[1]);o.length=0},e.prototype.HandleOptions=function(t,e,o){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null===r)return this.continueToPrime;for(var i,n=0,s=r.length;n<s;++n)if(i=this.GetOptionById(r[n]),!0===i.Execute(t,e,o))return!1;return this.continueToPrime},e.prototype.GetOptionById=function(t){for(var e,o=0,r=this.options,i=r.length;o<i;++o)if(e=r[o],-1!==e.id.indexOf(t))return e;return null},e.prototype.GetAllOptionIds=function(){for(var t=[],e=0,o=this.options,r=o.length;e<r;++e)t.push.apply(t,o[e].id);return t},e.prototype.GetAndRemoveMatchingOptionIds=function(t){var e=this.allOptionIds;if(null===e)return null;for(var o=[],r=0,i=e.length;r<i;++r){var n=t.indexOf(e[r]);-1!==n&&o.push(t.fickleSplice(n))}return o},e.prototype.GenerateInfoString=function(){for(var t,e="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",o=0,r=this.options,i=r.length;o<i;++o)t=r[o],e+="OPTION: "+t.id.join(", ")+" -> "+t.info+"\n";return e},t.CP.Command=e}},function(t,e){t.exports=function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.commands=[]}e.prototype=Object.create(null),e.prototype.constructor=e,e.prototype.splitter=" ",e.prototype.AddCommand=function(t){if(null===t.register)return this.commands.push(t),t.register=this,t},e.prototype.RemoveCommand=function(t){var e=this.commands,o=e.indexOf(t);if(-1!==o)return t.register=null,e.fickleSplice(o)},e.prototype.GetCommand=function(t){for(var e,o=0,r=this.commands,i=r.length;o<i;++o)if(e=this.commands[o])for(var n=0,s=e.id.length;n<s;++n)if(e.id[n]===t)return e;return null},e.prototype.Parse=function(t,e){var o=String(t).split(this.splitter),r=o.shift(),i=this.GetCommand(r);return i?(i.Execute(o,{},e),null):r},t.CP.Register=e}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,o){t.exports=o(85)},function(t,e,o){var r=Object.create(null);o(0)(),o(86)(r),o(1)(r),o(2)(r),o(4)(r),o(5)(r),o(6)(r),o(7)(r),o(8)(r),o(9)(r),o(10)(r),o(11)(r),o(87)(r),o(12)(r),o(13)(r),o(14)(r),o(15)(r),o(21)(r),o(22)(r),o(23)(r),o(16)(r),o(17)(r),o(18)(r),o(19)(r),o(20)(r),o(24)(r),o(25)(r),o(26)(r),o(27)(r),o(28)(r),o(29)(r),o(30)(r),t.exports=r},function(t,e){t.exports=function(t){t.Geom=Object.create(null),t.Math=Object.create(null),t.Utils=Object.create(null),t.Entity=Object.create(null),t.Event=Object.create(null),t.Time=Object.create(null),t.CP=Object.create(null),t.VERSION="0.7.5 (Beta)",t.PRINT_VERSION=function(){console.log("nenkraft-behind version "+t.VERSION)}}},function(t,e){t.exports=function(t){"use strict";function e(t,o,r){if(!(this instanceof e))return new e(t,o,r);if("function"!=typeof t)throw new Error("ServerTicker: An onProcess function is required!");this.SetDesiredRate(o),this.onProcess=t,void 0!=r&&!1!==r||this.Start()}e.prototype=Object.create(null),e.prototype.constructor=e,e.LOG=!0,e.Log=function(){!1!==e.LOG&&console.log.apply(null,arguments)},e.prototype.intervalId=null,e.prototype.timeoutId=null,e.prototype.immediateId=null,e.prototype.delta=0,e.prototype.then=0,e.prototype.now=0,e.prototype.desiredRate=0,e.prototype.supplyDelta=!0,e.prototype.Process=function(){this.onProcess(this.ComputeDelta())},e.prototype.ComputeDelta=function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta},e.prototype.GetTPS=function(){return t.Math.PR(1/this.delta*1e3,2)},e.prototype.SetDesiredRate=function(t){this.desiredRate=void 0===t?16.66:1e3/t},e.prototype.Start=function(t){null!==this.intervalId?!0===t&&(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate)):this.intervalId=setInterval(this.Process.bind(this),this.desiredRate)},e.prototype.Stop=function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},t.Time.ServerTicker=e,t.ServerTicker=e}}]);
//# sourceMappingURL=nkb.min.js.map